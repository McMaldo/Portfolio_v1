var Js=Object.defineProperty;var Rr=d=>{throw TypeError(d)};var Zs=(d,b,Et)=>b in d?Js(d,b,{enumerable:!0,configurable:!0,writable:!0,value:Et}):d[b]=Et;var Xe=(d,b,Et)=>Zs(d,typeof b!="symbol"?b+"":b,Et),Mi=(d,b,Et)=>b.has(d)||Rr("Cannot "+Et);var t=(d,b,Et)=>(Mi(d,b,"read from private field"),Et?Et.call(d):b.get(d)),gt=(d,b,Et)=>b.has(d)?Rr("Cannot add the same private member more than once"):b instanceof WeakSet?b.add(d):b.set(d,Et),mt=(d,b,Et,g)=>(Mi(d,b,"write to private field"),g?g.call(d,Et):b.set(d,Et),Et),tt=(d,b,Et)=>(Mi(d,b,"access private method"),Et);var Wn=(d,b,Et,g)=>({set _(k){mt(d,b,k,Et)},get _(){return t(d,b,g)}});import{z as getAugmentedNamespace,v as requireReact,k as useOverlay,j as jsxRuntimeExports,F as FontAwesomeIcon,l as faUpRightFromSquare,A as faDownload,B as faXmark}from"./index-DdXHFGPt.js";const overlay="_overlay_c6sed_1",pdfBox="_pdfBox_c6sed_31",options="_options_c6sed_51",s={overlay,pdfBox,options};var lib={exports:{}},core_min={};function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(b,Et){module.exports=b.pdfjsLib=Et()})(globalThis,()=>(()=>{var __webpack_modules__=[,(d,b)=>{var Ie;Object.defineProperty(b,"__esModule",{value:!0}),b.VerbosityLevel=b.Util=b.UnknownErrorException=b.UnexpectedResponseException=b.TextRenderingMode=b.RenderingIntentFlag=b.PromiseCapability=b.PermissionFlag=b.PasswordResponses=b.PasswordException=b.PageActionEventType=b.OPS=b.MissingPDFException=b.MAX_IMAGE_SIZE_TO_CACHE=b.LINE_FACTOR=b.LINE_DESCENT_FACTOR=b.InvalidPDFException=b.ImageKind=b.IDENTITY_MATRIX=b.FormatError=b.FeatureTest=b.FONT_IDENTITY_MATRIX=b.DocumentActionEventType=b.CMapCompressionType=b.BaseException=b.BASELINE_FACTOR=b.AnnotationType=b.AnnotationReplyType=b.AnnotationPrefix=b.AnnotationMode=b.AnnotationFlag=b.AnnotationFieldFlag=b.AnnotationEditorType=b.AnnotationEditorPrefix=b.AnnotationEditorParamsType=b.AnnotationBorderStyleType=b.AnnotationActionEventType=b.AbortException=void 0,b.assert=x,b.bytesToString=St,b.createValidAbsoluteUrl=ct,b.getModificationDate=Ht,b.getUuid=re,b.getVerbosityLevel=K,b.info=rt,b.isArrayBuffer=et,b.isArrayEqual=zt,b.isNodeJS=void 0,b.normalizeUnicode=Yt,b.objectFromMap=Lt,b.objectSize=Ft,b.setVerbosityLevel=bt,b.shadow=T,b.string32=Tt,b.stringToBytes=wt,b.stringToPDFString=Ct,b.stringToUTF8String=Dt,b.unreachable=_t,b.utf8StringToString=Rt,b.warn=X;const Et=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");b.isNodeJS=Et;const g=[1,0,0,1,0,0];b.IDENTITY_MATRIX=g;const k=[.001,0,0,.001,0,0];b.FONT_IDENTITY_MATRIX=k;const e=1e7;b.MAX_IMAGE_SIZE_TO_CACHE=e;const it=1.35;b.LINE_FACTOR=it;const Mt=.35;b.LINE_DESCENT_FACTOR=Mt;const G=Mt/it;b.BASELINE_FACTOR=G;const N={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};b.RenderingIntentFlag=N;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};b.AnnotationMode=f;const z="pdfjs_internal_editor_";b.AnnotationEditorPrefix=z;const W={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};b.AnnotationEditorType=W;const A={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};b.AnnotationEditorParamsType=A;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};b.PermissionFlag=_;const R={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};b.TextRenderingMode=R;const y={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};b.ImageKind=y;const m={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};b.AnnotationType=m;const E={GROUP:"Group",REPLY:"R"};b.AnnotationReplyType=E;const H={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};b.AnnotationFlag=H;const C={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};b.AnnotationFieldFlag=C;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};b.AnnotationBorderStyleType=a;const u={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};b.AnnotationActionEventType=u;const o={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};b.DocumentActionEventType=o;const c={O:"PageOpen",C:"PageClose"};b.PageActionEventType=c;const h={ERRORS:0,WARNINGS:1,INFOS:5};b.VerbosityLevel=h;const B={NONE:0,BINARY:1};b.CMapCompressionType=B;const l={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};b.OPS=l;const w={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};b.PasswordResponses=w;let I=h.WARNINGS;function bt(kt){Number.isInteger(kt)&&(I=kt)}function K(){return I}function rt(kt){I>=h.INFOS&&console.log(`Info: ${kt}`)}function X(kt){I>=h.WARNINGS&&console.log(`Warning: ${kt}`)}function _t(kt){throw new Error(kt)}function x(kt,st){kt||_t(st)}function $(kt){switch(kt==null?void 0:kt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ct(kt,st=null,ot=null){if(!kt)return null;try{if(ot&&typeof kt=="string"){if(ot.addDefaultProtocol&&kt.startsWith("www.")){const Zt=kt.match(/\./g);(Zt==null?void 0:Zt.length)>=2&&(kt=`http://${kt}`)}if(ot.tryConvertEncoding)try{kt=Dt(kt)}catch{}}const $t=st?new URL(kt,st):new URL(kt);if($($t))return $t}catch{}return null}function T(kt,st,ot,$t=!1){return Object.defineProperty(kt,st,{value:ot,enumerable:!$t,configurable:!0,writable:!1}),ot}const i=function(){function st(ot,$t){this.constructor===st&&_t("Cannot initialize BaseException."),this.message=ot,this.name=$t}return st.prototype=new Error,st.constructor=st,st}();b.BaseException=i;class r extends i{constructor(st,ot){super(st,"PasswordException"),this.code=ot}}b.PasswordException=r;class v extends i{constructor(st,ot){super(st,"UnknownErrorException"),this.details=ot}}b.UnknownErrorException=v;class L extends i{constructor(st){super(st,"InvalidPDFException")}}b.InvalidPDFException=L;class D extends i{constructor(st){super(st,"MissingPDFException")}}b.MissingPDFException=D;class F extends i{constructor(st,ot){super(st,"UnexpectedResponseException"),this.status=ot}}b.UnexpectedResponseException=F;class Q extends i{constructor(st){super(st,"FormatError")}}b.FormatError=Q;class vt extends i{constructor(st){super(st,"AbortException")}}b.AbortException=vt;function St(kt){(typeof kt!="object"||(kt==null?void 0:kt.length)===void 0)&&_t("Invalid argument for bytesToString");const st=kt.length,ot=8192;if(st<ot)return String.fromCharCode.apply(null,kt);const $t=[];for(let Zt=0;Zt<st;Zt+=ot){const le=Math.min(Zt+ot,st),U=kt.subarray(Zt,le);$t.push(String.fromCharCode.apply(null,U))}return $t.join("")}function wt(kt){typeof kt!="string"&&_t("Invalid argument for stringToBytes");const st=kt.length,ot=new Uint8Array(st);for(let $t=0;$t<st;++$t)ot[$t]=kt.charCodeAt($t)&255;return ot}function Tt(kt){return String.fromCharCode(kt>>24&255,kt>>16&255,kt>>8&255,kt&255)}function Ft(kt){return Object.keys(kt).length}function Lt(kt){const st=Object.create(null);for(const[ot,$t]of kt)st[ot]=$t;return st}function ht(){const kt=new Uint8Array(4);return kt[0]=1,new Uint32Array(kt.buffer,0,1)[0]===1}function dt(){try{return new Function(""),!0}catch{return!1}}class S{static get isLittleEndian(){return T(this,"isLittleEndian",ht())}static get isEvalSupported(){return T(this,"isEvalSupported",dt())}static get isOffscreenCanvasSupported(){return T(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?T(this,"platform",{isWin:!1,isMac:!1}):T(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var st,ot;return T(this,"isCSSRoundSupported",(ot=(st=globalThis.CSS)==null?void 0:st.supports)==null?void 0:ot.call(st,"width: round(1.5px, 1px)"))}}b.FeatureTest=S;const O=[...Array(256).keys()].map(kt=>kt.toString(16).padStart(2,"0"));class nt{static makeHexColor(st,ot,$t){return`#${O[st]}${O[ot]}${O[$t]}`}static scaleMinMax(st,ot){let $t;st[0]?(st[0]<0&&($t=ot[0],ot[0]=ot[1],ot[1]=$t),ot[0]*=st[0],ot[1]*=st[0],st[3]<0&&($t=ot[2],ot[2]=ot[3],ot[3]=$t),ot[2]*=st[3],ot[3]*=st[3]):($t=ot[0],ot[0]=ot[2],ot[2]=$t,$t=ot[1],ot[1]=ot[3],ot[3]=$t,st[1]<0&&($t=ot[2],ot[2]=ot[3],ot[3]=$t),ot[2]*=st[1],ot[3]*=st[1],st[2]<0&&($t=ot[0],ot[0]=ot[1],ot[1]=$t),ot[0]*=st[2],ot[1]*=st[2]),ot[0]+=st[4],ot[1]+=st[4],ot[2]+=st[5],ot[3]+=st[5]}static transform(st,ot){return[st[0]*ot[0]+st[2]*ot[1],st[1]*ot[0]+st[3]*ot[1],st[0]*ot[2]+st[2]*ot[3],st[1]*ot[2]+st[3]*ot[3],st[0]*ot[4]+st[2]*ot[5]+st[4],st[1]*ot[4]+st[3]*ot[5]+st[5]]}static applyTransform(st,ot){const $t=st[0]*ot[0]+st[1]*ot[2]+ot[4],Zt=st[0]*ot[1]+st[1]*ot[3]+ot[5];return[$t,Zt]}static applyInverseTransform(st,ot){const $t=ot[0]*ot[3]-ot[1]*ot[2],Zt=(st[0]*ot[3]-st[1]*ot[2]+ot[2]*ot[5]-ot[4]*ot[3])/$t,le=(-st[0]*ot[1]+st[1]*ot[0]+ot[4]*ot[1]-ot[5]*ot[0])/$t;return[Zt,le]}static getAxialAlignedBoundingBox(st,ot){const $t=this.applyTransform(st,ot),Zt=this.applyTransform(st.slice(2,4),ot),le=this.applyTransform([st[0],st[3]],ot),U=this.applyTransform([st[2],st[1]],ot);return[Math.min($t[0],Zt[0],le[0],U[0]),Math.min($t[1],Zt[1],le[1],U[1]),Math.max($t[0],Zt[0],le[0],U[0]),Math.max($t[1],Zt[1],le[1],U[1])]}static inverseTransform(st){const ot=st[0]*st[3]-st[1]*st[2];return[st[3]/ot,-st[1]/ot,-st[2]/ot,st[0]/ot,(st[2]*st[5]-st[4]*st[3])/ot,(st[4]*st[1]-st[5]*st[0])/ot]}static singularValueDecompose2dScale(st){const ot=[st[0],st[2],st[1],st[3]],$t=st[0]*ot[0]+st[1]*ot[2],Zt=st[0]*ot[1]+st[1]*ot[3],le=st[2]*ot[0]+st[3]*ot[2],U=st[2]*ot[1]+st[3]*ot[3],Pt=($t+U)/2,Wt=Math.sqrt(($t+U)**2-4*($t*U-le*Zt))/2,Qt=Pt+Wt||1,ne=Pt-Wt||1;return[Math.sqrt(Qt),Math.sqrt(ne)]}static normalizeRect(st){const ot=st.slice(0);return st[0]>st[2]&&(ot[0]=st[2],ot[2]=st[0]),st[1]>st[3]&&(ot[1]=st[3],ot[3]=st[1]),ot}static intersect(st,ot){const $t=Math.max(Math.min(st[0],st[2]),Math.min(ot[0],ot[2])),Zt=Math.min(Math.max(st[0],st[2]),Math.max(ot[0],ot[2]));if($t>Zt)return null;const le=Math.max(Math.min(st[1],st[3]),Math.min(ot[1],ot[3])),U=Math.min(Math.max(st[1],st[3]),Math.max(ot[1],ot[3]));return le>U?null:[$t,le,Zt,U]}static bezierBoundingBox(st,ot,$t,Zt,le,U,Pt,Wt){const Qt=[],ne=[[],[]];let Xt,M,P,J,yt,At,xt,Bt;for(let _e=0;_e<2;++_e){if(_e===0?(M=6*st-12*$t+6*le,Xt=-3*st+9*$t-9*le+3*Pt,P=3*$t-3*st):(M=6*ot-12*Zt+6*U,Xt=-3*ot+9*Zt-9*U+3*Wt,P=3*Zt-3*ot),Math.abs(Xt)<1e-12){if(Math.abs(M)<1e-12)continue;J=-P/M,0<J&&J<1&&Qt.push(J);continue}xt=M*M-4*P*Xt,Bt=Math.sqrt(xt),!(xt<0)&&(yt=(-M+Bt)/(2*Xt),0<yt&&yt<1&&Qt.push(yt),At=(-M-Bt)/(2*Xt),0<At&&At<1&&Qt.push(At))}let te=Qt.length,Kt;const qt=te;for(;te--;)J=Qt[te],Kt=1-J,ne[0][te]=Kt*Kt*Kt*st+3*Kt*Kt*J*$t+3*Kt*J*J*le+J*J*J*Pt,ne[1][te]=Kt*Kt*Kt*ot+3*Kt*Kt*J*Zt+3*Kt*J*J*U+J*J*J*Wt;return ne[0][qt]=st,ne[1][qt]=ot,ne[0][qt+1]=Pt,ne[1][qt+1]=Wt,ne[0].length=ne[1].length=qt+2,[Math.min(...ne[0]),Math.min(...ne[1]),Math.max(...ne[0]),Math.max(...ne[1])]}}b.Util=nt;const ft=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ct(kt){if(kt[0]>="ï"){let ot;if(kt[0]==="þ"&&kt[1]==="ÿ"?ot="utf-16be":kt[0]==="ÿ"&&kt[1]==="þ"?ot="utf-16le":kt[0]==="ï"&&kt[1]==="»"&&kt[2]==="¿"&&(ot="utf-8"),ot)try{const $t=new TextDecoder(ot,{fatal:!0}),Zt=wt(kt);return $t.decode(Zt)}catch($t){X(`stringToPDFString: "${$t}".`)}}const st=[];for(let ot=0,$t=kt.length;ot<$t;ot++){const Zt=ft[kt.charCodeAt(ot)];st.push(Zt?String.fromCharCode(Zt):kt.charAt(ot))}return st.join("")}function Dt(kt){return decodeURIComponent(escape(kt))}function Rt(kt){return unescape(encodeURIComponent(kt))}function et(kt){return typeof kt=="object"&&(kt==null?void 0:kt.byteLength)!==void 0}function zt(kt,st){if(kt.length!==st.length)return!1;for(let ot=0,$t=kt.length;ot<$t;ot++)if(kt[ot]!==st[ot])return!1;return!0}function Ht(kt=new Date){return[kt.getUTCFullYear().toString(),(kt.getUTCMonth()+1).toString().padStart(2,"0"),kt.getUTCDate().toString().padStart(2,"0"),kt.getUTCHours().toString().padStart(2,"0"),kt.getUTCMinutes().toString().padStart(2,"0"),kt.getUTCSeconds().toString().padStart(2,"0")].join("")}class me{constructor(){gt(this,Ie,!1);this.promise=new Promise((st,ot)=>{this.resolve=$t=>{mt(this,Ie,!0),st($t)},this.reject=$t=>{mt(this,Ie,!0),ot($t)}})}get settled(){return t(this,Ie)}}Ie=new WeakMap,b.PromiseCapability=me;let ce=null,Te=null;function Yt(kt){return ce||(ce=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Te=new Map([["ﬅ","ſt"]])),kt.replaceAll(ce,(st,ot,$t)=>ot?ot.normalize("NFKC"):Te.get($t))}function re(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const kt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(kt);else for(let st=0;st<32;st++)kt[st]=Math.floor(Math.random()*255);return St(kt)}const Ae="pdfjs_internal_id_";b.AnnotationPrefix=Ae},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var d,Et,g,k,In,ri,Mt,G,N,f,z,W,A,_,R,si,m,E,xi,C,a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:h}=c,B=o.url?getUrlProp(o.url):null,l=o.data?getDataProp(o.data):null,w=o.httpHeaders||null,I=o.withCredentials===!0,bt=o.password??null,K=o.range instanceof PDFDataRangeTransport?o.range:null,rt=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let X=o.worker instanceof PDFWorker?o.worker:null;const _t=o.verbosity,x=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,$=typeof o.cMapUrl=="string"?o.cMapUrl:null,ct=o.cMapPacked!==!1,T=o.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,r=o.StandardFontDataFactory||DefaultStandardFontDataFactory,v=o.stopAtErrors!==!0,L=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,D=o.isEvalSupported!==!1,F=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_util.isNodeJS,Q=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,vt=typeof o.disableFontFace=="boolean"?o.disableFontFace:_util.isNodeJS,St=o.fontExtraProperties===!0,wt=o.enableXfa===!0,Tt=o.ownerDocument||globalThis.document,Ft=o.disableRange===!0,Lt=o.disableStream===!0,ht=o.disableAutoFetch===!0,dt=o.pdfBug===!0,S=K?K.length:o.length??NaN,O=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_util.isNodeJS&&!vt,nt=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:T===_display_utils.DOMCMapReaderFactory&&r===_display_utils.DOMStandardFontDataFactory&&$&&i&&(0,_display_utils.isValidFetchUrl)($,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),ft=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:Tt}),Ct=o.filterFactory||new DefaultFilterFactory({docId:h,ownerDocument:Tt}),Dt=null;(0,_util.setVerbosityLevel)(_t);const Rt={canvasFactory:ft,filterFactory:Ct};if(nt||(Rt.cMapReaderFactory=new T({baseUrl:$,isCompressed:ct}),Rt.standardFontDataFactory=new r({baseUrl:i})),!X){const Ht={verbosity:_t,port:_worker_options.GlobalWorkerOptions.workerPort};X=Ht.port?PDFWorker.fromPort(Ht):new PDFWorker(Ht),c._worker=X}const et={docId:h,apiVersion:"3.11.174",data:l,password:bt,disableAutoFetch:ht,rangeChunkSize:rt,length:S,docBaseUrl:x,enableXfa:wt,evaluatorOptions:{maxImageSize:L,disableFontFace:vt,ignoreErrors:v,isEvalSupported:D,isOffscreenCanvasSupported:F,canvasMaxAreaInBytes:Q,fontExtraProperties:St,useSystemFonts:O,cMapUrl:nt?$:null,standardFontDataUrl:nt?i:null}},zt={ignoreErrors:v,isEvalSupported:D,disableFontFace:vt,fontExtraProperties:St,enableXfa:wt,ownerDocument:Tt,disableAutoFetch:ht,pdfBug:dt,styleElement:Dt};return X.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Ht=_fetchDocument(X,et),me=new Promise(function(ce){let Te;K?Te=new _transport_stream.PDFDataTransportStream({length:S,initialData:K.initialData,progressiveDone:K.progressiveDone,contentDispositionFilename:K.contentDispositionFilename,disableRange:Ft,disableStream:Lt},K):l||(Te=(re=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(re):(0,_display_utils.isValidFetchUrl)(re.url)?new _displayFetch_stream.PDFFetchStream(re):new _displayNetwork.PDFNetworkStream(re))({url:B,length:S,httpHeaders:w,withCredentials:I,rangeChunkSize:rt,disableRange:Ft,disableStream:Lt})),ce(Te)});return Promise.all([Ht,me]).then(function([ce,Te]){if(c.destroyed)throw new Error("Loading aborted");const Yt=new _message_handler.MessageHandler(h,ce,X.port),re=new WorkerTransport(Yt,c,Te,zt,Rt);c._transport=re,Yt.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(o,c){if(o.destroyed)throw new Error("Worker was destroyed");const h=await o.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return h}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_util.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_util.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const b=class b{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Wn(b,d)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,h,B;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((h=this._transport)==null?void 0:h.destroy())}catch(l){throw(B=this._worker)!=null&&B.port&&delete this._worker._pendingDestroy,l}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};d=new WeakMap,gt(b,d,0);let PDFDocumentLoadingTask=b;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,h,B=!1,l=null){this.length=c,this.initialData=h,this.progressiveDone=B,this.contentDispositionFilename=l,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,h){for(const B of this._rangeListeners)B(c,h)}onDataProgress(c,h){this._readyCapability.promise.then(()=>{for(const B of this._progressListeners)B(c,h)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const h of this._progressiveReadListeners)h(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,h){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,h){this._pdfInfo=c,this._transport=h,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(B=>{if(!B)return B;const l=[];for(const w in B)l.push(...B[w]);return l}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,h,B,l=!1){gt(this,k);gt(this,Et,null);gt(this,g,!1);this._pageIndex=c,this._pageInfo=h,this._transport=B,this._stats=l?new _display_utils.StatTimer:null,this._pdfBug=l,this.commonObjs=B.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:h=this.rotate,offsetX:B=0,offsetY:l=0,dontFlip:w=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:h,offsetX:B,offsetY:l,dontFlip:w})}getAnnotations({intent:c="display"}={}){const h=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,h.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:h,intent:B="display",annotationMode:l=_util.AnnotationMode.ENABLE,transform:w=null,background:I=null,optionalContentConfigPromise:bt=null,annotationCanvasMap:K=null,pageColors:rt=null,printAnnotationStorage:X=null}){var r,v;(r=this._stats)==null||r.time("Overall");const _t=this._transport.getRenderingIntent(B,l,X);mt(this,g,!1),tt(this,k,ri).call(this),bt||(bt=this._transport.getOptionalContentConfig());let x=this._intentStates.get(_t.cacheKey);x||(x=Object.create(null),this._intentStates.set(_t.cacheKey,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const $=!!(_t.renderingIntent&_util.RenderingIntentFlag.PRINT);x.displayReadyCapability||(x.displayReadyCapability=new _util.PromiseCapability,x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(v=this._stats)==null||v.time("Page Request"),this._pumpOperatorList(_t));const ct=L=>{var D,F;x.renderTasks.delete(T),(this._maybeCleanupAfterRender||$)&&mt(this,g,!0),tt(this,k,In).call(this,!$),L?(T.capability.reject(L),this._abortOperatorList({intentState:x,reason:L instanceof Error?L:new Error(L)})):T.capability.resolve(),(D=this._stats)==null||D.timeEnd("Rendering"),(F=this._stats)==null||F.timeEnd("Overall")},T=new InternalRenderTask({callback:ct,params:{canvasContext:c,viewport:h,transform:w,background:I},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:K,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!$,pdfBug:this._pdfBug,pageColors:rt});(x.renderTasks||(x.renderTasks=new Set)).add(T);const i=T.task;return Promise.all([x.displayReadyCapability.promise,bt]).then(([L,D])=>{var F;if(this.destroyed){ct();return}(F=this._stats)==null||F.time("Rendering"),T.initializeGraphics({transparency:L,optionalContentConfig:D}),T.operatorListChanged()}).catch(ct),i}getOperatorList({intent:c="display",annotationMode:h=_util.AnnotationMode.ENABLE,printAnnotationStorage:B=null}={}){var K;function l(){I.operatorList.lastChunk&&(I.opListReadCapability.resolve(I.operatorList),I.renderTasks.delete(bt))}const w=this._transport.getRenderingIntent(c,h,B,!0);let I=this._intentStates.get(w.cacheKey);I||(I=Object.create(null),this._intentStates.set(w.cacheKey,I));let bt;return I.opListReadCapability||(bt=Object.create(null),bt.operatorListChanged=l,I.opListReadCapability=new _util.PromiseCapability,(I.renderTasks||(I.renderTasks=new Set)).add(bt),I.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(K=this._stats)==null||K.time("Page Request"),this._pumpOperatorList(w)),I.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:h=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:h===!0},{highWaterMark:100,size(l){return l.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(B=>_xfa_text.XfaText.textContent(B));const h=this.streamTextContent(c);return new Promise(function(B,l){function w(){I.read().then(function({value:K,done:rt}){if(rt){B(bt);return}Object.assign(bt.styles,K.styles),bt.items.push(...K.items),w()},l)}const I=h.getReader(),bt={items:[],styles:Object.create(null)};w()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const h of this._intentStates.values())if(this._abortOperatorList({intentState:h,reason:new Error("Page was destroyed."),force:!0}),!h.opListReadCapability)for(const B of h.renderTasks)c.push(B.completed),B.cancel();return this.objs.clear(),mt(this,g,!1),tt(this,k,ri).call(this),Promise.all(c)}cleanup(c=!1){mt(this,g,!0);const h=tt(this,k,In).call(this,!1);return c&&h&&this._stats&&(this._stats=new _display_utils.StatTimer),h}_startRenderPage(c,h){var l,w;const B=this._intentStates.get(h);B&&((l=this._stats)==null||l.timeEnd("Page Request"),(w=B.displayReadyCapability)==null||w.resolve(c))}_renderPageChunk(c,h){for(let B=0,l=c.length;B<l;B++)h.operatorList.fnArray.push(c.fnArray[B]),h.operatorList.argsArray.push(c.argsArray[B]);h.operatorList.lastChunk=c.lastChunk,h.operatorList.separateAnnots=c.separateAnnots;for(const B of h.renderTasks)B.operatorListChanged();c.lastChunk&&tt(this,k,In).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:h,annotationStorageSerializable:B}){const{map:l,transfers:w}=B,bt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:h,annotationStorage:l},w).getReader(),K=this._intentStates.get(h);K.streamReader=bt;const rt=()=>{bt.read().then(({value:X,done:_t})=>{if(_t){K.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(X,K),rt())},X=>{if(K.streamReader=null,!this._transport.destroyed){if(K.operatorList){K.operatorList.lastChunk=!0;for(const _t of K.renderTasks)_t.operatorListChanged();tt(this,k,In).call(this,!0)}if(K.displayReadyCapability)K.displayReadyCapability.reject(X);else if(K.opListReadCapability)K.opListReadCapability.reject(X);else throw X}})};rt()}_abortOperatorList({intentState:c,reason:h,force:B=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!B){if(c.renderTasks.size>0)return;if(h instanceof _display_utils.RenderingCancelledException){let l=RENDERING_CANCELLED_TIMEOUT;h.extraDelay>0&&h.extraDelay<1e3&&(l+=h.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:h,force:!0})},l);return}}if(c.streamReader.cancel(new _util.AbortException(h.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[l,w]of this._intentStates)if(w===c){this._intentStates.delete(l);break}this.cleanup()}}}get stats(){return this._stats}}Et=new WeakMap,g=new WeakMap,k=new WeakSet,In=function(c=!1){if(tt(this,k,ri).call(this),!t(this,g)||this.destroyed)return!1;if(c)return mt(this,Et,setTimeout(()=>{mt(this,Et,null),tt(this,k,In).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:h,operatorList:B}of this._intentStates.values())if(h.size>0||!B.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),mt(this,g,!1),!0},ri=function(){t(this,Et)&&(clearTimeout(t(this,Et)),mt(this,Et,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){gt(this,Mt,new Set);gt(this,G,Promise.resolve())}postMessage(c,h){const B={data:structuredClone(c,h?{transfer:h}:null)};t(this,G).then(()=>{for(const l of t(this,Mt))l.call(this,B)})}addEventListener(c,h){t(this,Mt).add(h)}removeEventListener(c,h){t(this,Mt).delete(h)}terminate(){t(this,Mt).clear()}}Mt=new WeakMap,G=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(N=document==null?void 0:document.currentScript)==null?void 0:N.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,c){let h;try{if(h=new URL(o),!h.origin||h.origin==="null")return!1}catch{return!1}const B=new URL(c,h);return h.origin===B.origin},PDFWorkerUtil.createCDNWrapper=function(o){const c=`importScripts("${o}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:o=null,port:c=null,verbosity:h=(0,_util.getVerbosityLevel)()}={}){var B;if(this.name=o,this.destroyed=!1,this.verbosity=h,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((B=t(_PDFWorker,f))!=null&&B.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,f)||mt(_PDFWorker,f,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const c=new Worker(o),h=new _message_handler.MessageHandler("main","worker",c),B=()=>{c.removeEventListener("error",l),h.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},l=()=>{this._webWorker||B()};c.addEventListener("error",l),h.on("test",I=>{if(c.removeEventListener("error",l),this.destroyed){B();return}I?(this._messageHandler=h,this._port=c,this._webWorker=c,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),h.destroy(),c.terminate())}),h.on("ready",I=>{if(c.removeEventListener("error",l),this.destroyed){B();return}try{w()}catch{this._setupFakeWorker()}});const w=()=>{const I=new Uint8Array;h.send("test",I,[I.buffer])};w();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const h=`fake${PDFWorkerUtil.fakeWorkerId++}`,B=new _message_handler.MessageHandler(h+"_worker",h,c);o.setup(B,c);const l=new _message_handler.MessageHandler(h,h+"_worker",c);this._messageHandler=l,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){var o;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(o=t(_PDFWorker,f))==null||o.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){var h;if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(h=t(this,f))==null?void 0:h.get(o.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};f=new WeakMap,gt(_PDFWorker,f);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,h,B,l,w){gt(this,R);gt(this,z,new Map);gt(this,W,new Map);gt(this,A,new Map);gt(this,_,null);this.messageHandler=c,this.loadingTask=h,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:l.ownerDocument,styleElement:l.styleElement}),this._params=l,this.canvasFactory=w.canvasFactory,this.filterFactory=w.filterFactory,this.cMapReaderFactory=w.cMapReaderFactory,this.standardFontDataFactory=w.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=B,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,h=_util.AnnotationMode.ENABLE,B=null,l=!1){let w=_util.RenderingIntentFlag.DISPLAY,I=_annotation_storage.SerializableEmpty;switch(c){case"any":w=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":w=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(h){case _util.AnnotationMode.DISABLE:w+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:w+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:w+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,I=(w&_util.RenderingIntentFlag.PRINT&&B instanceof _annotation_storage.PrintAnnotationStorage?B:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${h}`)}return l&&(w+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:w,cacheKey:`${w}_${I.hash}`,annotationStorageSerializable:I}}destroy(){var B;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(B=t(this,_))==null||B.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const l of t(this,W).values())c.push(l._destroy());t(this,W).clear(),t(this,A).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const h=this.messageHandler.sendWithPromise("Terminate",null);return c.push(h),Promise.all(c).then(()=>{var l;this.commonObjs.clear(),this.fontLoader.clear(),t(this,z).clear(),this.filterFactory.destroy(),(l=this._networkStream)==null||l.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:h}=this;c.on("GetReader",(B,l)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=w=>{this._lastProgress={loaded:w.loaded,total:w.total}},l.onPull=()=>{this._fullReader.read().then(function({value:w,done:I}){if(I){l.close();return}(0,_util.assert)(w instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(w),1,[w])}).catch(w=>{l.error(w)})},l.onCancel=w=>{this._fullReader.cancel(w),l.ready.catch(I=>{if(!this.destroyed)throw I})}}),c.on("ReaderHeadersReady",B=>{const l=new _util.PromiseCapability,w=this._fullReader;return w.headersReady.then(()=>{var I;(!w.isStreamingSupported||!w.isRangeSupported)&&(this._lastProgress&&((I=h.onProgress)==null||I.call(h,this._lastProgress)),w.onProgress=bt=>{var K;(K=h.onProgress)==null||K.call(h,{loaded:bt.loaded,total:bt.total})}),l.resolve({isStreamingSupported:w.isStreamingSupported,isRangeSupported:w.isRangeSupported,contentLength:w.contentLength})},l.reject),l.promise}),c.on("GetRangeReader",(B,l)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const w=this._networkStream.getRangeReader(B.begin,B.end);if(!w){l.close();return}l.onPull=()=>{w.read().then(function({value:I,done:bt}){if(bt){l.close();return}(0,_util.assert)(I instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(I),1,[I])}).catch(I=>{l.error(I)})},l.onCancel=I=>{w.cancel(I),l.ready.catch(bt=>{if(!this.destroyed)throw bt})}}),c.on("GetDoc",({pdfInfo:B})=>{this._numPages=B.numPages,this._htmlForXfa=B.htmlForXfa,delete B.htmlForXfa,h._capability.resolve(new PDFDocumentProxy(B,this))}),c.on("DocException",function(B){let l;switch(B.name){case"PasswordException":l=new _util.PasswordException(B.message,B.code);break;case"InvalidPDFException":l=new _util.InvalidPDFException(B.message);break;case"MissingPDFException":l=new _util.MissingPDFException(B.message);break;case"UnexpectedResponseException":l=new _util.UnexpectedResponseException(B.message,B.status);break;case"UnknownErrorException":l=new _util.UnknownErrorException(B.message,B.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}h._capability.reject(l)}),c.on("PasswordRequest",B=>{if(mt(this,_,new _util.PromiseCapability),h.onPassword){const l=w=>{w instanceof Error?t(this,_).reject(w):t(this,_).resolve({password:w})};try{h.onPassword(l,B.code)}catch(w){t(this,_).reject(w)}}else t(this,_).reject(new _util.PasswordException(B.message,B.code));return t(this,_).promise}),c.on("DataLoaded",B=>{var l;(l=h.onProgress)==null||l.call(h,{loaded:B.length,total:B.length}),this.downloadInfoCapability.resolve(B)}),c.on("StartRenderPage",B=>{if(this.destroyed)return;t(this,W).get(B.pageIndex)._startRenderPage(B.transparency,B.cacheKey)}),c.on("commonobj",([B,l,w])=>{var I;if(!this.destroyed&&!this.commonObjs.has(B))switch(l){case"Font":const bt=this._params;if("error"in w){const X=w.error;(0,_util.warn)(`Error during font loading: ${X}`),this.commonObjs.resolve(B,X);break}const K=bt.pdfBug&&((I=globalThis.FontInspector)!=null&&I.enabled)?(X,_t)=>globalThis.FontInspector.fontAdded(X,_t):null,rt=new _font_loader.FontFaceObject(w,{isEvalSupported:bt.isEvalSupported,disableFontFace:bt.disableFontFace,ignoreErrors:bt.ignoreErrors,inspectFont:K});this.fontLoader.bind(rt).catch(X=>c.sendWithPromise("FontFallback",{id:B})).finally(()=>{!bt.fontExtraProperties&&rt.data&&(rt.data=null),this.commonObjs.resolve(B,rt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(B,w);break;default:throw new Error(`Got unknown common object type ${l}`)}}),c.on("obj",([B,l,w,I])=>{var K;if(this.destroyed)return;const bt=t(this,W).get(l);if(!bt.objs.has(B))switch(w){case"Image":if(bt.objs.resolve(B,I),I){let rt;if(I.bitmap){const{width:X,height:_t}=I;rt=X*_t*4}else rt=((K=I.data)==null?void 0:K.length)||0;rt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(bt._maybeCleanupAfterRender=!0)}break;case"Pattern":bt.objs.resolve(B,I);break;default:throw new Error(`Got unknown object type ${w}`)}}),c.on("DocProgress",B=>{var l;this.destroyed||(l=h.onProgress)==null||l.call(h,{loaded:B.loaded,total:B.total})}),c.on("FetchBuiltInCMap",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(B):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(B):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var B;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:h}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((B=this._fullReader)==null?void 0:B.filename)??null},h).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const h=c-1,B=t(this,A).get(h);if(B)return B;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:h}).then(w=>{if(this.destroyed)throw new Error("Transport destroyed");const I=new PDFPageProxy(h,w,this,this._params.pdfBug);return t(this,W).set(h,I),I});return t(this,A).set(h,l),l}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,h){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:h})}getFieldObjects(){return tt(this,R,si).call(this,"GetFieldObjects")}hasJSActions(){return tt(this,R,si).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return tt(this,R,si).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",h=t(this,z).get(c);if(h)return h;const B=this.messageHandler.sendWithPromise(c,null).then(l=>{var w,I;return{info:l[0],metadata:l[1]?new _metadata.Metadata(l[1]):null,contentDispositionFilename:((w=this._fullReader)==null?void 0:w.filename)??null,contentLength:((I=this._fullReader)==null?void 0:I.contentLength)??null}});return t(this,z).set(c,B),B}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const h of t(this,W).values())if(!h.cleanup())throw new Error(`startCleanup: Page ${h.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,z).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:h}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:h})}}z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakSet,si=function(c,h=null){const B=t(this,z).get(c);if(B)return B;const l=this.messageHandler.sendWithPromise(c,h);return t(this,z).set(c,l),l};class PDFObjects{constructor(){gt(this,E);gt(this,m,Object.create(null))}get(c,h=null){if(h){const l=tt(this,E,xi).call(this,c);return l.capability.promise.then(()=>h(l.data)),null}const B=t(this,m)[c];if(!(B!=null&&B.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return B.data}has(c){const h=t(this,m)[c];return(h==null?void 0:h.capability.settled)||!1}resolve(c,h=null){const B=tt(this,E,xi).call(this,c);B.data=h,B.capability.resolve()}clear(){var c;for(const h in t(this,m)){const{data:B}=t(this,m)[h];(c=B==null?void 0:B.bitmap)==null||c.close()}mt(this,m,Object.create(null))}}m=new WeakMap,E=new WeakSet,xi=function(c){var h;return(h=t(this,m))[c]||(h[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){gt(this,C,null);mt(this,C,c),this.onContinue=null}get promise(){return t(this,C).capability.promise}cancel(c=0){t(this,C).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,C).operatorList;if(!c)return!1;const{annotationCanvasMap:h}=t(this,C);return c.form||c.canvas&&(h==null?void 0:h.size)>0}}C=new WeakMap,exports.RenderTask=RenderTask;const u=class u{constructor({callback:c,params:h,objs:B,commonObjs:l,annotationCanvasMap:w,operatorList:I,pageIndex:bt,canvasFactory:K,filterFactory:rt,useRequestAnimationFrame:X=!1,pdfBug:_t=!1,pageColors:x=null}){this.callback=c,this.params=h,this.objs=B,this.commonObjs=l,this.annotationCanvasMap=w,this.operatorListIdx=null,this.operatorList=I,this._pageIndex=bt,this.canvasFactory=K,this.filterFactory=rt,this._pdfBug=_t,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=X===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=h.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:h}){var bt,K;if(this.cancelled)return;if(this._canvas){if(t(u,a).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(u,a).add(this._canvas)}this._pdfBug&&((bt=globalThis.StepperManager)!=null&&bt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:B,viewport:l,transform:w,background:I}=this.params;this.gfx=new _canvas.CanvasGraphics(B,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:h},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:w,viewport:l,transparency:c,background:I}),this.operatorListIdx=0,this.graphicsReady=!0,(K=this.graphicsReadyCallback)==null||K.call(this)}cancel(c=null,h=0){var B;this.running=!1,this.cancelled=!0,(B=this.gfx)==null||B.endDrawing(),t(u,a).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,h))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(u,a).delete(this._canvas),this.callback())))}};a=new WeakMap,gt(u,a,new WeakSet);let InternalRenderTask=u;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(d,b,Et)=>{var N,f,z,Mr,A;Object.defineProperty(b,"__esModule",{value:!0}),b.SerializableEmpty=b.PrintAnnotationStorage=b.AnnotationStorage=void 0;var g=Et(1),k=Et(4),e=Et(8);const it=Object.freeze({map:null,hash:"",transfers:void 0});b.SerializableEmpty=it;class Mt{constructor(){gt(this,z);gt(this,N,!1);gt(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(R,y){const m=t(this,f).get(R);return m===void 0?y:Object.assign(y,m)}getRawValue(R){return t(this,f).get(R)}remove(R){if(t(this,f).delete(R),t(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const y of t(this,f).values())if(y instanceof k.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(R,y){const m=t(this,f).get(R);let E=!1;if(m!==void 0)for(const[H,C]of Object.entries(y))m[H]!==C&&(E=!0,m[H]=C);else E=!0,t(this,f).set(R,y);E&&tt(this,z,Mr).call(this),y instanceof k.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(y.constructor._type)}has(R){return t(this,f).has(R)}getAll(){return t(this,f).size>0?(0,g.objectFromMap)(t(this,f)):null}setAll(R){for(const[y,m]of Object.entries(R))this.setValue(y,m)}get size(){return t(this,f).size}resetModified(){t(this,N)&&(mt(this,N,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new G(this)}get serializable(){if(t(this,f).size===0)return it;const R=new Map,y=new e.MurmurHash3_64,m=[],E=Object.create(null);let H=!1;for(const[C,a]of t(this,f)){const u=a instanceof k.AnnotationEditor?a.serialize(!1,E):a;u&&(R.set(C,u),y.update(`${C}:${JSON.stringify(u)}`),H||(H=!!u.bitmap))}if(H)for(const C of R.values())C.bitmap&&m.push(C.bitmap);return R.size>0?{map:R,hash:y.hexdigest(),transfers:m}:it}}N=new WeakMap,f=new WeakMap,z=new WeakSet,Mr=function(){t(this,N)||(mt(this,N,!0),typeof this.onSetModified=="function"&&this.onSetModified())},b.AnnotationStorage=Mt;class G extends Mt{constructor(y){super();gt(this,A);const{map:m,hash:E,transfers:H}=y.serializable,C=structuredClone(m,H?{transfer:H}:null);mt(this,A,{map:C,hash:E,transfers:H})}get print(){(0,g.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,A)}}A=new WeakMap,b.PrintAnnotationStorage=G},(d,b,Et)=>{var G,N,f,z,W,A,_,R,y,m,E,H,C,a,u,Fi,Li,h,Di,Ii,xr,Fr,Lr,Oi,Dr;Object.defineProperty(b,"__esModule",{value:!0}),b.AnnotationEditor=void 0;var g=Et(5),k=Et(1),e=Et(6);const X=class X{constructor(x){gt(this,u);gt(this,G,"");gt(this,N,!1);gt(this,f,null);gt(this,z,null);gt(this,W,null);gt(this,A,!1);gt(this,_,null);gt(this,R,this.focusin.bind(this));gt(this,y,this.focusout.bind(this));gt(this,m,!1);gt(this,E,!1);gt(this,H,!1);Xe(this,"_initialOptions",Object.create(null));Xe(this,"_uiManager",null);Xe(this,"_focusEventsAllowed",!0);Xe(this,"_l10nPromise",null);gt(this,C,!1);gt(this,a,X._zIndex++);this.constructor===X&&(0,k.unreachable)("Cannot initialize AnnotationEditor."),this.parent=x.parent,this.id=x.id,this.width=this.height=null,this.pageIndex=x.parent.pageIndex,this.name=x.name,this.div=null,this._uiManager=x.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=x.isCentered,this._structTreeParentId=null;const{rotation:$,rawDims:{pageWidth:ct,pageHeight:T,pageX:i,pageY:r}}=this.parent.viewport;this.rotation=$,this.pageRotation=(360+$-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[ct,T],this.pageTranslation=[i,r];const[v,L]=this.parentDimensions;this.x=x.x/v,this.y=x.y/L,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,k.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(x){const $=new Mt({id:x.parent.getNextId(),parent:x.parent,uiManager:x._uiManager});$.annotationElementId=x.annotationElementId,$.deleted=!0,$._uiManager.addToAnnotationStorage($)}static initialize(x,$=null){if(X._l10nPromise||(X._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(T=>[T,x.get(T)]))),$!=null&&$.strings)for(const T of $.strings)X._l10nPromise.set(T,x.get(T));if(X._borderLineWidth!==-1)return;const ct=getComputedStyle(document.documentElement);X._borderLineWidth=parseFloat(ct.getPropertyValue("--outline-width"))||0}static updateDefaultParams(x,$){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(x){return!1}static paste(x,$){(0,k.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,C)}set _isDraggable(x){var $;mt(this,C,x),($=this.div)==null||$.classList.toggle("draggable",x)}center(){const[x,$]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*$/(x*2),this.y+=this.width*x/($*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*$/(x*2),this.y-=this.width*x/($*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(x){this._uiManager.addCommands(x)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,a)}setParent(x){x!==null&&(this.pageIndex=x.pageIndex,this.pageDimensions=x.pageDimensions),this.parent=x}focusin(x){this._focusEventsAllowed&&(t(this,m)?mt(this,m,!1):this.parent.setSelected(this))}focusout(x){var ct;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const $=x.relatedTarget;$!=null&&$.closest(`#${this.id}`)||(x.preventDefault(),(ct=this.parent)!=null&&ct.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(x,$,ct,T){const[i,r]=this.parentDimensions;[ct,T]=this.screenToPageTranslation(ct,T),this.x=(x+ct)/i,this.y=($+T)/r,this.fixAndSetPosition()}translate(x,$){tt(this,u,Fi).call(this,this.parentDimensions,x,$)}translateInPage(x,$){tt(this,u,Fi).call(this,this.pageDimensions,x,$),this.div.scrollIntoView({block:"nearest"})}drag(x,$){const[ct,T]=this.parentDimensions;if(this.x+=x/ct,this.y+=$/T,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:D,y:F}=this.div.getBoundingClientRect();this.parent.findNewParent(this,D,F)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:i,y:r}=this;const[v,L]=tt(this,u,Li).call(this);i+=v,r+=L,this.div.style.left=`${(100*i).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[x,$]=this.pageDimensions;let{x:ct,y:T,width:i,height:r}=this;switch(i*=x,r*=$,ct*=x,T*=$,this.rotation){case 0:ct=Math.max(0,Math.min(x-i,ct)),T=Math.max(0,Math.min($-r,T));break;case 90:ct=Math.max(0,Math.min(x-r,ct)),T=Math.min($,Math.max(i,T));break;case 180:ct=Math.min(x,Math.max(i,ct)),T=Math.min($,Math.max(r,T));break;case 270:ct=Math.min(x,Math.max(r,ct)),T=Math.max(0,Math.min($-i,T));break}this.x=ct/=x,this.y=T/=$;const[v,L]=tt(this,u,Li).call(this);ct+=v,T+=L;const{style:D}=this.div;D.left=`${(100*ct).toFixed(2)}%`,D.top=`${(100*T).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(x,$){var ct;return tt(ct=X,h,Di).call(ct,x,$,this.parentRotation)}pageTranslationToScreen(x,$){var ct;return tt(ct=X,h,Di).call(ct,x,$,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:x,pageDimensions:[$,ct]}=this,T=$*x,i=ct*x;return k.FeatureTest.isCSSRoundSupported?[Math.round(T),Math.round(i)]:[T,i]}setDims(x,$){var i;const[ct,T]=this.parentDimensions;this.div.style.width=`${(100*x/ct).toFixed(2)}%`,t(this,A)||(this.div.style.height=`${(100*$/T).toFixed(2)}%`),(i=t(this,f))==null||i.classList.toggle("small",x<X.SMALL_EDITOR_SIZE||$<X.SMALL_EDITOR_SIZE)}fixDims(){const{style:x}=this.div,{height:$,width:ct}=x,T=ct.endsWith("%"),i=!t(this,A)&&$.endsWith("%");if(T&&i)return;const[r,v]=this.parentDimensions;T||(x.width=`${(100*parseFloat(ct)/r).toFixed(2)}%`),!t(this,A)&&!i&&(x.height=`${(100*parseFloat($)/v).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,f))return;const x=mt(this,f,document.createElement("button"));x.className="altText";const $=await X._l10nPromise.get("editor_alt_text_button_label");x.textContent=$,x.setAttribute("aria-label",$),x.tabIndex="0",x.addEventListener("contextmenu",e.noContextMenu),x.addEventListener("pointerdown",ct=>ct.stopPropagation()),x.addEventListener("click",ct=>{ct.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),x.addEventListener("keydown",ct=>{ct.target===x&&ct.key==="Enter"&&(ct.preventDefault(),this._uiManager.editAltText(this))}),tt(this,u,Oi).call(this),this.div.append(x),X.SMALL_EDITOR_SIZE||(X.SMALL_EDITOR_SIZE=Math.min(128,Math.round(x.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,G),decorative:t(this,N)}}set altTextData({altText:x,decorative:$}){t(this,G)===x&&t(this,N)===$||(mt(this,G,x),mt(this,N,$),tt(this,u,Oi).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,R)),this.div.addEventListener("focusout",t(this,y));const[x,$]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*$/x).toFixed(2)}%`,this.div.style.maxHeight=`${(100*x/$).toFixed(2)}%`);const[ct,T]=this.getInitialTranslation();return this.translate(ct,T),(0,g.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(x){const{isMac:$}=k.FeatureTest.platform;if(x.button!==0||x.ctrlKey&&$){x.preventDefault();return}mt(this,m,!0),tt(this,u,Dr).call(this,x)}moveInDOM(){var x;(x=this.parent)==null||x.moveEditorInDOM(this)}_setParentAndPosition(x,$,ct){x.changeParent(this),this.x=$,this.y=ct,this.fixAndSetPosition()}getRect(x,$){const ct=this.parentScale,[T,i]=this.pageDimensions,[r,v]=this.pageTranslation,L=x/ct,D=$/ct,F=this.x*T,Q=this.y*i,vt=this.width*T,St=this.height*i;switch(this.rotation){case 0:return[F+L+r,i-Q-D-St+v,F+L+vt+r,i-Q-D+v];case 90:return[F+D+r,i-Q+L+v,F+D+St+r,i-Q+L+vt+v];case 180:return[F-L-vt+r,i-Q+D+v,F-L+r,i-Q+D+St+v];case 270:return[F-D-St+r,i-Q-L-vt+v,F-D+r,i-Q-L+v];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(x,$){const[ct,T,i,r]=x,v=i-ct,L=r-T;switch(this.rotation){case 0:return[ct,$-r,v,L];case 90:return[ct,$-T,L,v];case 180:return[i,$-T,v,L];case 270:return[i,$-r,L,v];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){mt(this,H,!0)}disableEditMode(){mt(this,H,!1)}isInEditMode(){return t(this,H)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var x,$;(x=this.div)==null||x.addEventListener("focusin",t(this,R)),($=this.div)==null||$.addEventListener("focusout",t(this,y))}serialize(x=!1,$=null){(0,k.unreachable)("An editor must be serializable")}static deserialize(x,$,ct){const T=new this.prototype.constructor({parent:$,id:$.getNextId(),uiManager:ct});T.rotation=x.rotation;const[i,r]=T.pageDimensions,[v,L,D,F]=T.getRectInCurrentCoords(x.rect,r);return T.x=v/i,T.y=L/r,T.width=D/i,T.height=F/r,T}remove(){var x;this.div.removeEventListener("focusin",t(this,R)),this.div.removeEventListener("focusout",t(this,y)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(x=t(this,f))==null||x.remove(),mt(this,f,null),mt(this,z,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(tt(this,u,xr).call(this),t(this,_).classList.remove("hidden"))}select(){var x;this.makeResizable(),(x=this.div)==null||x.classList.add("selectedEditor")}unselect(){var x,$,ct;(x=t(this,_))==null||x.classList.add("hidden"),($=this.div)==null||$.classList.remove("selectedEditor"),(ct=this.div)!=null&&ct.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(x,$){}disableEditing(){t(this,f)&&(t(this,f).hidden=!0)}enableEditing(){t(this,f)&&(t(this,f).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,E)}set isEditing(x){mt(this,E,x),this.parent&&(x?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(x,$){mt(this,A,!0);const ct=x/$,{style:T}=this.div;T.aspectRatio=ct,T.height="auto"}static get MIN_SIZE(){return 16}};G=new WeakMap,N=new WeakMap,f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakMap,E=new WeakMap,H=new WeakMap,C=new WeakMap,a=new WeakMap,u=new WeakSet,Fi=function([x,$],ct,T){[ct,T]=this.screenToPageTranslation(ct,T),this.x+=ct/x,this.y+=T/$,this.fixAndSetPosition()},Li=function(){const[x,$]=this.parentDimensions,{_borderLineWidth:ct}=X,T=ct/x,i=ct/$;switch(this.rotation){case 90:return[-T,i];case 180:return[T,i];case 270:return[T,-i];default:return[-T,-i]}},h=new WeakSet,Di=function(x,$,ct){switch(ct){case 90:return[$,-x];case 180:return[-x,-$];case 270:return[-$,x];default:return[x,$]}},Ii=function(x){switch(x){case 90:{const[$,ct]=this.pageDimensions;return[0,-$/ct,ct/$,0]}case 180:return[-1,0,0,-1];case 270:{const[$,ct]=this.pageDimensions;return[0,$/ct,-ct/$,0]}default:return[1,0,0,1]}},xr=function(){if(t(this,_))return;mt(this,_,document.createElement("div")),t(this,_).classList.add("resizers");const x=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||x.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const $ of x){const ct=document.createElement("div");t(this,_).append(ct),ct.classList.add("resizer",$),ct.addEventListener("pointerdown",tt(this,u,Fr).bind(this,$)),ct.addEventListener("contextmenu",e.noContextMenu)}this.div.prepend(t(this,_))},Fr=function(x,$){$.preventDefault();const{isMac:ct}=k.FeatureTest.platform;if($.button!==0||$.ctrlKey&&ct)return;const T=tt(this,u,Lr).bind(this,x),i=this._isDraggable;this._isDraggable=!1;const r={passive:!0,capture:!0};window.addEventListener("pointermove",T,r);const v=this.x,L=this.y,D=this.width,F=this.height,Q=this.parent.div.style.cursor,vt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle($.target).cursor;const St=()=>{this._isDraggable=i,window.removeEventListener("pointerup",St),window.removeEventListener("blur",St),window.removeEventListener("pointermove",T,r),this.parent.div.style.cursor=Q,this.div.style.cursor=vt;const wt=this.x,Tt=this.y,Ft=this.width,Lt=this.height;wt===v&&Tt===L&&Ft===D&&Lt===F||this.addCommands({cmd:()=>{this.width=Ft,this.height=Lt,this.x=wt,this.y=Tt;const[ht,dt]=this.parentDimensions;this.setDims(ht*Ft,dt*Lt),this.fixAndSetPosition()},undo:()=>{this.width=D,this.height=F,this.x=v,this.y=L;const[ht,dt]=this.parentDimensions;this.setDims(ht*D,dt*F),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",St),window.addEventListener("blur",St)},Lr=function(x,$){const[ct,T]=this.parentDimensions,i=this.x,r=this.y,v=this.width,L=this.height,D=X.MIN_SIZE/ct,F=X.MIN_SIZE/T,Q=Yt=>Math.round(Yt*1e4)/1e4,vt=tt(this,u,Ii).call(this,this.rotation),St=(Yt,re)=>[vt[0]*Yt+vt[2]*re,vt[1]*Yt+vt[3]*re],wt=tt(this,u,Ii).call(this,360-this.rotation),Tt=(Yt,re)=>[wt[0]*Yt+wt[2]*re,wt[1]*Yt+wt[3]*re];let Ft,Lt,ht=!1,dt=!1;switch(x){case"topLeft":ht=!0,Ft=(Yt,re)=>[0,0],Lt=(Yt,re)=>[Yt,re];break;case"topMiddle":Ft=(Yt,re)=>[Yt/2,0],Lt=(Yt,re)=>[Yt/2,re];break;case"topRight":ht=!0,Ft=(Yt,re)=>[Yt,0],Lt=(Yt,re)=>[0,re];break;case"middleRight":dt=!0,Ft=(Yt,re)=>[Yt,re/2],Lt=(Yt,re)=>[0,re/2];break;case"bottomRight":ht=!0,Ft=(Yt,re)=>[Yt,re],Lt=(Yt,re)=>[0,0];break;case"bottomMiddle":Ft=(Yt,re)=>[Yt/2,re],Lt=(Yt,re)=>[Yt/2,0];break;case"bottomLeft":ht=!0,Ft=(Yt,re)=>[0,re],Lt=(Yt,re)=>[Yt,0];break;case"middleLeft":dt=!0,Ft=(Yt,re)=>[0,re/2],Lt=(Yt,re)=>[Yt,re/2];break}const S=Ft(v,L),O=Lt(v,L);let nt=St(...O);const ft=Q(i+nt[0]),Ct=Q(r+nt[1]);let Dt=1,Rt=1,[et,zt]=this.screenToPageTranslation($.movementX,$.movementY);if([et,zt]=Tt(et/ct,zt/T),ht){const Yt=Math.hypot(v,L);Dt=Rt=Math.max(Math.min(Math.hypot(O[0]-S[0]-et,O[1]-S[1]-zt)/Yt,1/v,1/L),D/v,F/L)}else dt?Dt=Math.max(D,Math.min(1,Math.abs(O[0]-S[0]-et)))/v:Rt=Math.max(F,Math.min(1,Math.abs(O[1]-S[1]-zt)))/L;const Ht=Q(v*Dt),me=Q(L*Rt);nt=St(...Lt(Ht,me));const ce=ft-nt[0],Te=Ct-nt[1];this.width=Ht,this.height=me,this.x=ce,this.y=Te,this.setDims(ct*Ht,T*me),this.fixAndSetPosition()},Oi=async function(){var ct;const x=t(this,f);if(!x)return;if(!t(this,G)&&!t(this,N)){x.classList.remove("done"),(ct=t(this,z))==null||ct.remove();return}X._l10nPromise.get("editor_alt_text_edit_button_label").then(T=>{x.setAttribute("aria-label",T)});let $=t(this,z);if(!$){mt(this,z,$=document.createElement("span")),$.className="tooltip",$.setAttribute("role","tooltip");const T=$.id=`alt-text-tooltip-${this.id}`;x.setAttribute("aria-describedby",T);const i=100;x.addEventListener("mouseenter",()=>{mt(this,W,setTimeout(()=>{mt(this,W,null),t(this,z).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},i))}),x.addEventListener("mouseleave",()=>{var r;clearTimeout(t(this,W)),mt(this,W,null),(r=t(this,z))==null||r.classList.remove("show")})}x.classList.add("done"),$.innerText=t(this,N)?await X._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,G),$.parentNode||x.append($)},Dr=function(x){if(!this._isDraggable)return;const $=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let ct,T;$&&(ct={passive:!0,capture:!0},T=r=>{const[v,L]=this.screenToPageTranslation(r.movementX,r.movementY);this._uiManager.dragSelectedEditors(v,L)},window.addEventListener("pointermove",T,ct));const i=()=>{if(window.removeEventListener("pointerup",i),window.removeEventListener("blur",i),$&&window.removeEventListener("pointermove",T,ct),mt(this,m,!1),!this._uiManager.endDragSession()){const{isMac:r}=k.FeatureTest.platform;x.ctrlKey&&!r||x.shiftKey||x.metaKey&&r?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",i),window.addEventListener("blur",i)},gt(X,h),Xe(X,"_borderLineWidth",-1),Xe(X,"_colorManager",new g.ColorManager),Xe(X,"_zIndex",1),Xe(X,"SMALL_EDITOR_SIZE",0);let it=X;b.AnnotationEditor=it;class Mt extends it{constructor(x){super(x),this.annotationElementId=x.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(d,b,Et)=>{var A,_,R,y,m,Ni,C,a,u,o,c,Ir,l,w,I,bt,K,rt,X,_t,x,$,ct,T,i,r,v,L,D,F,Q,vt,St,wt,Tt,Ft,Lt,ht,dt,S,O,nt,ft,Ct,Dt,Rt,et,Or,Bi,Hi,ai,Ui,ji,mn,zn,Nr,Br,Wi,Vn,zi;Object.defineProperty(b,"__esModule",{value:!0}),b.KeyboardManager=b.CommandManager=b.ColorManager=b.AnnotationEditorUIManager=void 0,b.bindEvents=e,b.opacityToHex=it;var g=Et(1),k=Et(6);function e(le,U,Pt){for(const Wt of Pt)U.addEventListener(Wt,le[Wt].bind(le))}function it(le){return Math.round(Math.min(255,Math.max(1,255*le))).toString(16).padStart(2,"0")}class Mt{constructor(){gt(this,A,0)}getId(){return`${g.AnnotationEditorPrefix}${Wn(this,A)._++}`}}A=new WeakMap;const H=class H{constructor(){gt(this,m);gt(this,_,(0,g.getUuid)());gt(this,R,0);gt(this,y,null)}static get _isSVGFittingCanvas(){const U='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Wt=new OffscreenCanvas(1,3).getContext("2d"),Qt=new Image;Qt.src=U;const ne=Qt.decode().then(()=>(Wt.drawImage(Qt,0,0,1,1,0,0,1,3),new Uint32Array(Wt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,g.shadow)(this,"_isSVGFittingCanvas",ne)}async getFromFile(U){const{lastModified:Pt,name:Wt,size:Qt,type:ne}=U;return tt(this,m,Ni).call(this,`${Pt}_${Wt}_${Qt}_${ne}`,U)}async getFromUrl(U){return tt(this,m,Ni).call(this,U,U)}async getFromId(U){t(this,y)||mt(this,y,new Map);const Pt=t(this,y).get(U);return Pt?Pt.bitmap?(Pt.refCounter+=1,Pt):Pt.file?this.getFromFile(Pt.file):this.getFromUrl(Pt.url):null}getSvgUrl(U){const Pt=t(this,y).get(U);return Pt!=null&&Pt.isSvg?Pt.svgUrl:null}deleteId(U){t(this,y)||mt(this,y,new Map);const Pt=t(this,y).get(U);Pt&&(Pt.refCounter-=1,Pt.refCounter===0&&(Pt.bitmap=null))}isValidId(U){return U.startsWith(`image_${t(this,_)}_`)}};_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakSet,Ni=async function(U,Pt){t(this,y)||mt(this,y,new Map);let Wt=t(this,y).get(U);if(Wt===null)return null;if(Wt!=null&&Wt.bitmap)return Wt.refCounter+=1,Wt;try{Wt||(Wt={bitmap:null,id:`image_${t(this,_)}_${Wn(this,R)._++}`,refCounter:0,isSvg:!1});let Qt;if(typeof Pt=="string"){Wt.url=Pt;const ne=await fetch(Pt);if(!ne.ok)throw new Error(ne.statusText);Qt=await ne.blob()}else Qt=Wt.file=Pt;if(Qt.type==="image/svg+xml"){const ne=H._isSVGFittingCanvas,Xt=new FileReader,M=new Image,P=new Promise((J,yt)=>{M.onload=()=>{Wt.bitmap=M,Wt.isSvg=!0,J()},Xt.onload=async()=>{const At=Wt.svgUrl=Xt.result;M.src=await ne?`${At}#svgView(preserveAspectRatio(none))`:At},M.onerror=Xt.onerror=yt});Xt.readAsDataURL(Qt),await P}else Wt.bitmap=await createImageBitmap(Qt);Wt.refCounter=1}catch(Qt){console.error(Qt),Wt=null}return t(this,y).set(U,Wt),Wt&&t(this,y).set(Wt.id,Wt),Wt};let G=H;class N{constructor(U=128){gt(this,C,[]);gt(this,a,!1);gt(this,u);gt(this,o,-1);mt(this,u,U)}add({cmd:U,undo:Pt,mustExec:Wt,type:Qt=NaN,overwriteIfSameType:ne=!1,keepUndo:Xt=!1}){if(Wt&&U(),t(this,a))return;const M={cmd:U,undo:Pt,type:Qt};if(t(this,o)===-1){t(this,C).length>0&&(t(this,C).length=0),mt(this,o,0),t(this,C).push(M);return}if(ne&&t(this,C)[t(this,o)].type===Qt){Xt&&(M.undo=t(this,C)[t(this,o)].undo),t(this,C)[t(this,o)]=M;return}const P=t(this,o)+1;P===t(this,u)?t(this,C).splice(0,1):(mt(this,o,P),P<t(this,C).length&&t(this,C).splice(P)),t(this,C).push(M)}undo(){t(this,o)!==-1&&(mt(this,a,!0),t(this,C)[t(this,o)].undo(),mt(this,a,!1),mt(this,o,t(this,o)-1))}redo(){t(this,o)<t(this,C).length-1&&(mt(this,o,t(this,o)+1),mt(this,a,!0),t(this,C)[t(this,o)].cmd(),mt(this,a,!1))}hasSomethingToUndo(){return t(this,o)!==-1}hasSomethingToRedo(){return t(this,o)<t(this,C).length-1}destroy(){mt(this,C,null)}}C=new WeakMap,a=new WeakMap,u=new WeakMap,o=new WeakMap,b.CommandManager=N;class f{constructor(U){gt(this,c);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Pt}=g.FeatureTest.platform;for(const[Wt,Qt,ne={}]of U)for(const Xt of Wt){const M=Xt.startsWith("mac+");Pt&&M?(this.callbacks.set(Xt.slice(4),{callback:Qt,options:ne}),this.allKeys.add(Xt.split("+").at(-1))):!Pt&&!M&&(this.callbacks.set(Xt,{callback:Qt,options:ne}),this.allKeys.add(Xt.split("+").at(-1)))}}exec(U,Pt){if(!this.allKeys.has(Pt.key))return;const Wt=this.callbacks.get(tt(this,c,Ir).call(this,Pt));if(!Wt)return;const{callback:Qt,options:{bubbles:ne=!1,args:Xt=[],checker:M=null}}=Wt;M&&!M(U,Pt)||(Qt.bind(U,...Xt)(),ne||(Pt.stopPropagation(),Pt.preventDefault()))}}c=new WeakSet,Ir=function(U){U.altKey&&this.buffer.push("alt"),U.ctrlKey&&this.buffer.push("ctrl"),U.metaKey&&this.buffer.push("meta"),U.shiftKey&&this.buffer.push("shift"),this.buffer.push(U.key);const Pt=this.buffer.join("+");return this.buffer.length=0,Pt},b.KeyboardManager=f;const B=class B{get _colors(){const U=new Map([["CanvasText",null],["Canvas",null]]);return(0,k.getColorValues)(U),(0,g.shadow)(this,"_colors",U)}convert(U){const Pt=(0,k.getRGB)(U);if(!window.matchMedia("(forced-colors: active)").matches)return Pt;for(const[Wt,Qt]of this._colors)if(Qt.every((ne,Xt)=>ne===Pt[Xt]))return B._colorsMapping.get(Wt);return Pt}getHexCode(U){const Pt=this._colors.get(U);return Pt?g.Util.makeHexColor(...Pt):U}};Xe(B,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let z=B;b.ColorManager=z;const Zt=class Zt{constructor(U,Pt,Wt,Qt,ne,Xt){gt(this,et);gt(this,l,null);gt(this,w,new Map);gt(this,I,new Map);gt(this,bt,null);gt(this,K,null);gt(this,rt,new N);gt(this,X,0);gt(this,_t,new Set);gt(this,x,null);gt(this,$,null);gt(this,ct,new Set);gt(this,T,null);gt(this,i,new Mt);gt(this,r,!1);gt(this,v,!1);gt(this,L,null);gt(this,D,g.AnnotationEditorType.NONE);gt(this,F,new Set);gt(this,Q,null);gt(this,vt,this.blur.bind(this));gt(this,St,this.focus.bind(this));gt(this,wt,this.copy.bind(this));gt(this,Tt,this.cut.bind(this));gt(this,Ft,this.paste.bind(this));gt(this,Lt,this.keydown.bind(this));gt(this,ht,this.onEditingAction.bind(this));gt(this,dt,this.onPageChanging.bind(this));gt(this,S,this.onScaleChanging.bind(this));gt(this,O,this.onRotationChanging.bind(this));gt(this,nt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});gt(this,ft,[0,0]);gt(this,Ct,null);gt(this,Dt,null);gt(this,Rt,null);mt(this,Dt,U),mt(this,Rt,Pt),mt(this,bt,Wt),this._eventBus=Qt,this._eventBus._on("editingaction",t(this,ht)),this._eventBus._on("pagechanging",t(this,dt)),this._eventBus._on("scalechanging",t(this,S)),this._eventBus._on("rotationchanging",t(this,O)),mt(this,K,ne.annotationStorage),mt(this,T,ne.filterFactory),mt(this,Q,Xt),this.viewParameters={realScale:k.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const U=Zt.prototype,Pt=ne=>{const{activeElement:Xt}=document;return Xt&&t(ne,Dt).contains(Xt)&&ne.hasSomethingToControl()},Wt=this.TRANSLATE_SMALL,Qt=this.TRANSLATE_BIG;return(0,g.shadow)(this,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],U.selectAll],[["ctrl+z","mac+meta+z"],U.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],U.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],U.delete],[["Escape","mac+Escape"],U.unselectAll],[["ArrowLeft","mac+ArrowLeft"],U.translateSelectedEditors,{args:[-Wt,0],checker:Pt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],U.translateSelectedEditors,{args:[-Qt,0],checker:Pt}],[["ArrowRight","mac+ArrowRight"],U.translateSelectedEditors,{args:[Wt,0],checker:Pt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],U.translateSelectedEditors,{args:[Qt,0],checker:Pt}],[["ArrowUp","mac+ArrowUp"],U.translateSelectedEditors,{args:[0,-Wt],checker:Pt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],U.translateSelectedEditors,{args:[0,-Qt],checker:Pt}],[["ArrowDown","mac+ArrowDown"],U.translateSelectedEditors,{args:[0,Wt],checker:Pt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],U.translateSelectedEditors,{args:[0,Qt],checker:Pt}]]))}destroy(){tt(this,et,ai).call(this),tt(this,et,Bi).call(this),this._eventBus._off("editingaction",t(this,ht)),this._eventBus._off("pagechanging",t(this,dt)),this._eventBus._off("scalechanging",t(this,S)),this._eventBus._off("rotationchanging",t(this,O));for(const U of t(this,I).values())U.destroy();t(this,I).clear(),t(this,w).clear(),t(this,ct).clear(),mt(this,l,null),t(this,F).clear(),t(this,rt).destroy(),t(this,bt).destroy()}get hcmFilter(){return(0,g.shadow)(this,"hcmFilter",t(this,Q)?t(this,T).addHCMFilter(t(this,Q).foreground,t(this,Q).background):"none")}get direction(){return(0,g.shadow)(this,"direction",getComputedStyle(t(this,Dt)).direction)}editAltText(U){var Pt;(Pt=t(this,bt))==null||Pt.editAltText(this,U)}onPageChanging({pageNumber:U}){mt(this,X,U-1)}focusMainContainer(){t(this,Dt).focus()}findParent(U,Pt){for(const Wt of t(this,I).values()){const{x:Qt,y:ne,width:Xt,height:M}=Wt.div.getBoundingClientRect();if(U>=Qt&&U<=Qt+Xt&&Pt>=ne&&Pt<=ne+M)return Wt}return null}disableUserSelect(U=!1){t(this,Rt).classList.toggle("noUserSelect",U)}addShouldRescale(U){t(this,ct).add(U)}removeShouldRescale(U){t(this,ct).delete(U)}onScaleChanging({scale:U}){this.commitOrRemove(),this.viewParameters.realScale=U*k.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Pt of t(this,ct))Pt.onScaleChanging()}onRotationChanging({pagesRotation:U}){this.commitOrRemove(),this.viewParameters.rotation=U}addToAnnotationStorage(U){!U.isEmpty()&&t(this,K)&&!t(this,K).has(U.id)&&t(this,K).setValue(U.id,U)}blur(){if(!this.hasSelection)return;const{activeElement:U}=document;for(const Pt of t(this,F))if(Pt.div.contains(U)){mt(this,L,[Pt,U]),Pt._focusEventsAllowed=!1;break}}focus(){if(!t(this,L))return;const[U,Pt]=t(this,L);mt(this,L,null),Pt.addEventListener("focusin",()=>{U._focusEventsAllowed=!0},{once:!0}),Pt.focus()}addEditListeners(){tt(this,et,Hi).call(this),tt(this,et,Ui).call(this)}removeEditListeners(){tt(this,et,ai).call(this),tt(this,et,ji).call(this)}copy(U){var Wt;if(U.preventDefault(),(Wt=t(this,l))==null||Wt.commitOrRemove(),!this.hasSelection)return;const Pt=[];for(const Qt of t(this,F)){const ne=Qt.serialize(!0);ne&&Pt.push(ne)}Pt.length!==0&&U.clipboardData.setData("application/pdfjs",JSON.stringify(Pt))}cut(U){this.copy(U),this.delete()}paste(U){U.preventDefault();const{clipboardData:Pt}=U;for(const ne of Pt.items)for(const Xt of t(this,$))if(Xt.isHandlingMimeForPasting(ne.type)){Xt.paste(ne,this.currentLayer);return}let Wt=Pt.getData("application/pdfjs");if(!Wt)return;try{Wt=JSON.parse(Wt)}catch(ne){(0,g.warn)(`paste: "${ne.message}".`);return}if(!Array.isArray(Wt))return;this.unselectAll();const Qt=this.currentLayer;try{const ne=[];for(const P of Wt){const J=Qt.deserialize(P);if(!J)return;ne.push(J)}const Xt=()=>{for(const P of ne)tt(this,et,Wi).call(this,P);tt(this,et,zi).call(this,ne)},M=()=>{for(const P of ne)P.remove()};this.addCommands({cmd:Xt,undo:M,mustExec:!0})}catch(ne){(0,g.warn)(`paste: "${ne.message}".`)}}keydown(U){var Pt;(Pt=this.getActive())!=null&&Pt.shouldGetKeyboardEvents()||Zt._keyboardManager.exec(this,U)}onEditingAction(U){["undo","redo","delete","selectAll"].includes(U.name)&&this[U.name]()}setEditingState(U){U?(tt(this,et,Or).call(this),tt(this,et,Hi).call(this),tt(this,et,Ui).call(this),tt(this,et,mn).call(this,{isEditing:t(this,D)!==g.AnnotationEditorType.NONE,isEmpty:tt(this,et,Vn).call(this),hasSomethingToUndo:t(this,rt).hasSomethingToUndo(),hasSomethingToRedo:t(this,rt).hasSomethingToRedo(),hasSelectedEditor:!1})):(tt(this,et,Bi).call(this),tt(this,et,ai).call(this),tt(this,et,ji).call(this),tt(this,et,mn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(U){if(!t(this,$)){mt(this,$,U);for(const Pt of t(this,$))tt(this,et,zn).call(this,Pt.defaultPropertiesToUpdate)}}getId(){return t(this,i).getId()}get currentLayer(){return t(this,I).get(t(this,X))}getLayer(U){return t(this,I).get(U)}get currentPageIndex(){return t(this,X)}addLayer(U){t(this,I).set(U.pageIndex,U),t(this,r)?U.enable():U.disable()}removeLayer(U){t(this,I).delete(U.pageIndex)}updateMode(U,Pt=null){if(t(this,D)!==U){if(mt(this,D,U),U===g.AnnotationEditorType.NONE){this.setEditingState(!1),tt(this,et,Br).call(this);return}this.setEditingState(!0),tt(this,et,Nr).call(this),this.unselectAll();for(const Wt of t(this,I).values())Wt.updateMode(U);if(Pt){for(const Wt of t(this,w).values())if(Wt.annotationElementId===Pt){this.setSelected(Wt),Wt.enterInEditMode();break}}}}updateToolbar(U){U!==t(this,D)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:U})}updateParams(U,Pt){if(t(this,$)){if(U===g.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(U);return}for(const Wt of t(this,F))Wt.updateParams(U,Pt);for(const Wt of t(this,$))Wt.updateDefaultParams(U,Pt)}}enableWaiting(U=!1){if(t(this,v)!==U){mt(this,v,U);for(const Pt of t(this,I).values())U?Pt.disableClick():Pt.enableClick(),Pt.div.classList.toggle("waiting",U)}}getEditors(U){const Pt=[];for(const Wt of t(this,w).values())Wt.pageIndex===U&&Pt.push(Wt);return Pt}getEditor(U){return t(this,w).get(U)}addEditor(U){t(this,w).set(U.id,U)}removeEditor(U){var Pt;t(this,w).delete(U.id),this.unselect(U),(!U.annotationElementId||!t(this,_t).has(U.annotationElementId))&&((Pt=t(this,K))==null||Pt.remove(U.id))}addDeletedAnnotationElement(U){t(this,_t).add(U.annotationElementId),U.deleted=!0}isDeletedAnnotationElement(U){return t(this,_t).has(U)}removeDeletedAnnotationElement(U){t(this,_t).delete(U.annotationElementId),U.deleted=!1}setActiveEditor(U){t(this,l)!==U&&(mt(this,l,U),U&&tt(this,et,zn).call(this,U.propertiesToUpdate))}toggleSelected(U){if(t(this,F).has(U)){t(this,F).delete(U),U.unselect(),tt(this,et,mn).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,F).add(U),U.select(),tt(this,et,zn).call(this,U.propertiesToUpdate),tt(this,et,mn).call(this,{hasSelectedEditor:!0})}setSelected(U){for(const Pt of t(this,F))Pt!==U&&Pt.unselect();t(this,F).clear(),t(this,F).add(U),U.select(),tt(this,et,zn).call(this,U.propertiesToUpdate),tt(this,et,mn).call(this,{hasSelectedEditor:!0})}isSelected(U){return t(this,F).has(U)}unselect(U){U.unselect(),t(this,F).delete(U),tt(this,et,mn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,F).size!==0}undo(){t(this,rt).undo(),tt(this,et,mn).call(this,{hasSomethingToUndo:t(this,rt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:tt(this,et,Vn).call(this)})}redo(){t(this,rt).redo(),tt(this,et,mn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,rt).hasSomethingToRedo(),isEmpty:tt(this,et,Vn).call(this)})}addCommands(U){t(this,rt).add(U),tt(this,et,mn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:tt(this,et,Vn).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const U=[...t(this,F)],Pt=()=>{for(const Qt of U)Qt.remove()},Wt=()=>{for(const Qt of U)tt(this,et,Wi).call(this,Qt)};this.addCommands({cmd:Pt,undo:Wt,mustExec:!0})}commitOrRemove(){var U;(U=t(this,l))==null||U.commitOrRemove()}hasSomethingToControl(){return t(this,l)||this.hasSelection}selectAll(){for(const U of t(this,F))U.commit();tt(this,et,zi).call(this,t(this,w).values())}unselectAll(){if(t(this,l)){t(this,l).commitOrRemove();return}if(this.hasSelection){for(const U of t(this,F))U.unselect();t(this,F).clear(),tt(this,et,mn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(U,Pt,Wt=!1){if(Wt||this.commitOrRemove(),!this.hasSelection)return;t(this,ft)[0]+=U,t(this,ft)[1]+=Pt;const[Qt,ne]=t(this,ft),Xt=[...t(this,F)],M=1e3;t(this,Ct)&&clearTimeout(t(this,Ct)),mt(this,Ct,setTimeout(()=>{mt(this,Ct,null),t(this,ft)[0]=t(this,ft)[1]=0,this.addCommands({cmd:()=>{for(const P of Xt)t(this,w).has(P.id)&&P.translateInPage(Qt,ne)},undo:()=>{for(const P of Xt)t(this,w).has(P.id)&&P.translateInPage(-Qt,-ne)},mustExec:!1})},M));for(const P of Xt)P.translateInPage(U,Pt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),mt(this,x,new Map);for(const U of t(this,F))t(this,x).set(U,{savedX:U.x,savedY:U.y,savedPageIndex:U.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,x))return!1;this.disableUserSelect(!1);const U=t(this,x);mt(this,x,null);let Pt=!1;for(const[{x:Qt,y:ne,pageIndex:Xt},M]of U)M.newX=Qt,M.newY=ne,M.newPageIndex=Xt,Pt||(Pt=Qt!==M.savedX||ne!==M.savedY||Xt!==M.savedPageIndex);if(!Pt)return!1;const Wt=(Qt,ne,Xt,M)=>{if(t(this,w).has(Qt.id)){const P=t(this,I).get(M);P?Qt._setParentAndPosition(P,ne,Xt):(Qt.pageIndex=M,Qt.x=ne,Qt.y=Xt)}};return this.addCommands({cmd:()=>{for(const[Qt,{newX:ne,newY:Xt,newPageIndex:M}]of U)Wt(Qt,ne,Xt,M)},undo:()=>{for(const[Qt,{savedX:ne,savedY:Xt,savedPageIndex:M}]of U)Wt(Qt,ne,Xt,M)},mustExec:!0}),!0}dragSelectedEditors(U,Pt){if(t(this,x))for(const Wt of t(this,x).keys())Wt.drag(U,Pt)}rebuild(U){if(U.parent===null){const Pt=this.getLayer(U.pageIndex);Pt?(Pt.changeParent(U),Pt.addOrRebuild(U)):(this.addEditor(U),this.addToAnnotationStorage(U),U.rebuild())}else U.parent.addOrRebuild(U)}isActive(U){return t(this,l)===U}getActive(){return t(this,l)}getMode(){return t(this,D)}get imageManager(){return(0,g.shadow)(this,"imageManager",new G)}};l=new WeakMap,w=new WeakMap,I=new WeakMap,bt=new WeakMap,K=new WeakMap,rt=new WeakMap,X=new WeakMap,_t=new WeakMap,x=new WeakMap,$=new WeakMap,ct=new WeakMap,T=new WeakMap,i=new WeakMap,r=new WeakMap,v=new WeakMap,L=new WeakMap,D=new WeakMap,F=new WeakMap,Q=new WeakMap,vt=new WeakMap,St=new WeakMap,wt=new WeakMap,Tt=new WeakMap,Ft=new WeakMap,Lt=new WeakMap,ht=new WeakMap,dt=new WeakMap,S=new WeakMap,O=new WeakMap,nt=new WeakMap,ft=new WeakMap,Ct=new WeakMap,Dt=new WeakMap,Rt=new WeakMap,et=new WeakSet,Or=function(){window.addEventListener("focus",t(this,St)),window.addEventListener("blur",t(this,vt))},Bi=function(){window.removeEventListener("focus",t(this,St)),window.removeEventListener("blur",t(this,vt))},Hi=function(){window.addEventListener("keydown",t(this,Lt),{capture:!0})},ai=function(){window.removeEventListener("keydown",t(this,Lt),{capture:!0})},Ui=function(){document.addEventListener("copy",t(this,wt)),document.addEventListener("cut",t(this,Tt)),document.addEventListener("paste",t(this,Ft))},ji=function(){document.removeEventListener("copy",t(this,wt)),document.removeEventListener("cut",t(this,Tt)),document.removeEventListener("paste",t(this,Ft))},mn=function(U){Object.entries(U).some(([Wt,Qt])=>t(this,nt)[Wt]!==Qt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,nt),U)})},zn=function(U){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:U})},Nr=function(){if(!t(this,r)){mt(this,r,!0);for(const U of t(this,I).values())U.enable()}},Br=function(){if(this.unselectAll(),t(this,r)){mt(this,r,!1);for(const U of t(this,I).values())U.disable()}},Wi=function(U){const Pt=t(this,I).get(U.pageIndex);Pt?Pt.addOrRebuild(U):this.addEditor(U)},Vn=function(){if(t(this,w).size===0)return!0;if(t(this,w).size===1)for(const U of t(this,w).values())return U.isEmpty();return!1},zi=function(U){t(this,F).clear();for(const Pt of U)Pt.isEmpty()||(t(this,F).add(Pt),Pt.select());tt(this,et,mn).call(this,{hasSelectedEditor:!0})},Xe(Zt,"TRANSLATE_SMALL",1),Xe(Zt,"TRANSLATE_BIG",10);let W=Zt;b.AnnotationEditorUIManager=W},(d,b,Et)=>{var X,_t,x,$,ct,T,i,r,v,L,D,F,On,Nn,Vi,oi,li,qn,Gn;Object.defineProperty(b,"__esModule",{value:!0}),b.StatTimer=b.RenderingCancelledException=b.PixelsPerInch=b.PageViewport=b.PDFDateString=b.DOMStandardFontDataFactory=b.DOMSVGFactory=b.DOMFilterFactory=b.DOMCanvasFactory=b.DOMCMapReaderFactory=void 0,b.deprecated=o,b.getColorValues=w,b.getCurrentTransform=I,b.getCurrentTransformInverse=bt,b.getFilenameFromUrl=m,b.getPdfFilenameFromUrl=E,b.getRGB=l,b.getXfaPageViewport=B,b.isDataScheme=R,b.isPdfFile=y,b.isValidFetchUrl=C,b.loadScript=u,b.noContextMenu=a,b.setLayerDimensions=K;var g=Et(7),k=Et(1);const e="http://www.w3.org/2000/svg",rt=class rt{};Xe(rt,"CSS",96),Xe(rt,"PDF",72),Xe(rt,"PDF_TO_CSS_UNITS",rt.CSS/rt.PDF);let it=rt;b.PixelsPerInch=it;class Mt extends g.BaseFilterFactory{constructor({docId:S,ownerDocument:O=globalThis.document}={}){super();gt(this,F);gt(this,X);gt(this,_t);gt(this,x);gt(this,$);gt(this,ct);gt(this,T);gt(this,i);gt(this,r);gt(this,v);gt(this,L);gt(this,D,0);mt(this,x,S),mt(this,$,O)}addFilter(S){if(!S)return"none";let O=t(this,F,On).get(S);if(O)return O;let nt,ft,Ct,Dt;if(S.length===1){const Ht=S[0],me=new Array(256);for(let ce=0;ce<256;ce++)me[ce]=Ht[ce]/255;Dt=nt=ft=Ct=me.join(",")}else{const[Ht,me,ce]=S,Te=new Array(256),Yt=new Array(256),re=new Array(256);for(let Ae=0;Ae<256;Ae++)Te[Ae]=Ht[Ae]/255,Yt[Ae]=me[Ae]/255,re[Ae]=ce[Ae]/255;nt=Te.join(","),ft=Yt.join(","),Ct=re.join(","),Dt=`${nt}${ft}${Ct}`}if(O=t(this,F,On).get(Dt),O)return t(this,F,On).set(S,O),O;const Rt=`g_${t(this,x)}_transfer_map_${Wn(this,D)._++}`,et=`url(#${Rt})`;t(this,F,On).set(S,et),t(this,F,On).set(Dt,et);const zt=tt(this,F,oi).call(this,Rt);return tt(this,F,qn).call(this,nt,ft,Ct,zt),et}addHCMFilter(S,O){var me;const nt=`${S}-${O}`;if(t(this,T)===nt)return t(this,i);if(mt(this,T,nt),mt(this,i,"none"),(me=t(this,ct))==null||me.remove(),!S||!O)return t(this,i);const ft=tt(this,F,Gn).call(this,S);S=k.Util.makeHexColor(...ft);const Ct=tt(this,F,Gn).call(this,O);if(O=k.Util.makeHexColor(...Ct),t(this,F,Nn).style.color="",S==="#000000"&&O==="#ffffff"||S===O)return t(this,i);const Dt=new Array(256);for(let ce=0;ce<=255;ce++){const Te=ce/255;Dt[ce]=Te<=.03928?Te/12.92:((Te+.055)/1.055)**2.4}const Rt=Dt.join(","),et=`g_${t(this,x)}_hcm_filter`,zt=mt(this,r,tt(this,F,oi).call(this,et));tt(this,F,qn).call(this,Rt,Rt,Rt,zt),tt(this,F,Vi).call(this,zt);const Ht=(ce,Te)=>{const Yt=ft[ce]/255,re=Ct[ce]/255,Ae=new Array(Te+1);for(let Ie=0;Ie<=Te;Ie++)Ae[Ie]=Yt+Ie/Te*(re-Yt);return Ae.join(",")};return tt(this,F,qn).call(this,Ht(0,5),Ht(1,5),Ht(2,5),zt),mt(this,i,`url(#${et})`),t(this,i)}addHighlightHCMFilter(S,O,nt,ft){var re;const Ct=`${S}-${O}-${nt}-${ft}`;if(t(this,v)===Ct)return t(this,L);if(mt(this,v,Ct),mt(this,L,"none"),(re=t(this,r))==null||re.remove(),!S||!O)return t(this,L);const[Dt,Rt]=[S,O].map(tt(this,F,Gn).bind(this));let et=Math.round(.2126*Dt[0]+.7152*Dt[1]+.0722*Dt[2]),zt=Math.round(.2126*Rt[0]+.7152*Rt[1]+.0722*Rt[2]),[Ht,me]=[nt,ft].map(tt(this,F,Gn).bind(this));zt<et&&([et,zt,Ht,me]=[zt,et,me,Ht]),t(this,F,Nn).style.color="";const ce=(Ae,Ie,kt)=>{const st=new Array(256),ot=(zt-et)/kt,$t=Ae/255,Zt=(Ie-Ae)/(255*kt);let le=0;for(let U=0;U<=kt;U++){const Pt=Math.round(et+U*ot),Wt=$t+U*Zt;for(let Qt=le;Qt<=Pt;Qt++)st[Qt]=Wt;le=Pt+1}for(let U=le;U<256;U++)st[U]=st[le-1];return st.join(",")},Te=`g_${t(this,x)}_hcm_highlight_filter`,Yt=mt(this,r,tt(this,F,oi).call(this,Te));return tt(this,F,Vi).call(this,Yt),tt(this,F,qn).call(this,ce(Ht[0],me[0],5),ce(Ht[1],me[1],5),ce(Ht[2],me[2],5),Yt),mt(this,L,`url(#${Te})`),t(this,L)}destroy(S=!1){S&&(t(this,i)||t(this,L))||(t(this,_t)&&(t(this,_t).parentNode.parentNode.remove(),mt(this,_t,null)),t(this,X)&&(t(this,X).clear(),mt(this,X,null)),mt(this,D,0))}}X=new WeakMap,_t=new WeakMap,x=new WeakMap,$=new WeakMap,ct=new WeakMap,T=new WeakMap,i=new WeakMap,r=new WeakMap,v=new WeakMap,L=new WeakMap,D=new WeakMap,F=new WeakSet,On=function(){return t(this,X)||mt(this,X,new Map)},Nn=function(){if(!t(this,_t)){const S=t(this,$).createElement("div"),{style:O}=S;O.visibility="hidden",O.contain="strict",O.width=O.height=0,O.position="absolute",O.top=O.left=0,O.zIndex=-1;const nt=t(this,$).createElementNS(e,"svg");nt.setAttribute("width",0),nt.setAttribute("height",0),mt(this,_t,t(this,$).createElementNS(e,"defs")),S.append(nt),nt.append(t(this,_t)),t(this,$).body.append(S)}return t(this,_t)},Vi=function(S){const O=t(this,$).createElementNS(e,"feColorMatrix");O.setAttribute("type","matrix"),O.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),S.append(O)},oi=function(S){const O=t(this,$).createElementNS(e,"filter");return O.setAttribute("color-interpolation-filters","sRGB"),O.setAttribute("id",S),t(this,F,Nn).append(O),O},li=function(S,O,nt){const ft=t(this,$).createElementNS(e,O);ft.setAttribute("type","discrete"),ft.setAttribute("tableValues",nt),S.append(ft)},qn=function(S,O,nt,ft){const Ct=t(this,$).createElementNS(e,"feComponentTransfer");ft.append(Ct),tt(this,F,li).call(this,Ct,"feFuncR",S),tt(this,F,li).call(this,Ct,"feFuncG",O),tt(this,F,li).call(this,Ct,"feFuncB",nt)},Gn=function(S){return t(this,F,Nn).style.color=S,l(getComputedStyle(t(this,F,Nn)).getPropertyValue("color"))},b.DOMFilterFactory=Mt;class G extends g.BaseCanvasFactory{constructor({ownerDocument:dt=globalThis.document}={}){super(),this._document=dt}_createCanvas(dt,S){const O=this._document.createElement("canvas");return O.width=dt,O.height=S,O}}b.DOMCanvasFactory=G;async function N(ht,dt=!1){if(C(ht,document.baseURI)){const S=await fetch(ht);if(!S.ok)throw new Error(S.statusText);return dt?new Uint8Array(await S.arrayBuffer()):(0,k.stringToBytes)(await S.text())}return new Promise((S,O)=>{const nt=new XMLHttpRequest;nt.open("GET",ht,!0),dt&&(nt.responseType="arraybuffer"),nt.onreadystatechange=()=>{if(nt.readyState===XMLHttpRequest.DONE){if(nt.status===200||nt.status===0){let ft;if(dt&&nt.response?ft=new Uint8Array(nt.response):!dt&&nt.responseText&&(ft=(0,k.stringToBytes)(nt.responseText)),ft){S(ft);return}}O(new Error(nt.statusText))}},nt.send(null)})}class f extends g.BaseCMapReaderFactory{_fetchData(dt,S){return N(dt,this.isCompressed).then(O=>({cMapData:O,compressionType:S}))}}b.DOMCMapReaderFactory=f;class z extends g.BaseStandardFontDataFactory{_fetchData(dt){return N(dt,!0)}}b.DOMStandardFontDataFactory=z;class W extends g.BaseSVGFactory{_createSVG(dt){return document.createElementNS(e,dt)}}b.DOMSVGFactory=W;class A{constructor({viewBox:dt,scale:S,rotation:O,offsetX:nt=0,offsetY:ft=0,dontFlip:Ct=!1}){this.viewBox=dt,this.scale=S,this.rotation=O,this.offsetX=nt,this.offsetY=ft;const Dt=(dt[2]+dt[0])/2,Rt=(dt[3]+dt[1])/2;let et,zt,Ht,me;switch(O%=360,O<0&&(O+=360),O){case 180:et=-1,zt=0,Ht=0,me=1;break;case 90:et=0,zt=1,Ht=1,me=0;break;case 270:et=0,zt=-1,Ht=-1,me=0;break;case 0:et=1,zt=0,Ht=0,me=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ct&&(Ht=-Ht,me=-me);let ce,Te,Yt,re;et===0?(ce=Math.abs(Rt-dt[1])*S+nt,Te=Math.abs(Dt-dt[0])*S+ft,Yt=(dt[3]-dt[1])*S,re=(dt[2]-dt[0])*S):(ce=Math.abs(Dt-dt[0])*S+nt,Te=Math.abs(Rt-dt[1])*S+ft,Yt=(dt[2]-dt[0])*S,re=(dt[3]-dt[1])*S),this.transform=[et*S,zt*S,Ht*S,me*S,ce-et*S*Dt-Ht*S*Rt,Te-zt*S*Dt-me*S*Rt],this.width=Yt,this.height=re}get rawDims(){const{viewBox:dt}=this;return(0,k.shadow)(this,"rawDims",{pageWidth:dt[2]-dt[0],pageHeight:dt[3]-dt[1],pageX:dt[0],pageY:dt[1]})}clone({scale:dt=this.scale,rotation:S=this.rotation,offsetX:O=this.offsetX,offsetY:nt=this.offsetY,dontFlip:ft=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:dt,rotation:S,offsetX:O,offsetY:nt,dontFlip:ft})}convertToViewportPoint(dt,S){return k.Util.applyTransform([dt,S],this.transform)}convertToViewportRectangle(dt){const S=k.Util.applyTransform([dt[0],dt[1]],this.transform),O=k.Util.applyTransform([dt[2],dt[3]],this.transform);return[S[0],S[1],O[0],O[1]]}convertToPdfPoint(dt,S){return k.Util.applyInverseTransform([dt,S],this.transform)}}b.PageViewport=A;class _ extends k.BaseException{constructor(dt,S=0){super(dt,"RenderingCancelledException"),this.extraDelay=S}}b.RenderingCancelledException=_;function R(ht){const dt=ht.length;let S=0;for(;S<dt&&ht[S].trim()==="";)S++;return ht.substring(S,S+5).toLowerCase()==="data:"}function y(ht){return typeof ht=="string"&&/\.pdf$/i.test(ht)}function m(ht,dt=!1){return dt||([ht]=ht.split(/[#?]/,1)),ht.substring(ht.lastIndexOf("/")+1)}function E(ht,dt="document.pdf"){if(typeof ht!="string")return dt;if(R(ht))return(0,k.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),dt;const S=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,O=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,nt=S.exec(ht);let ft=O.exec(nt[1])||O.exec(nt[2])||O.exec(nt[3]);if(ft&&(ft=ft[0],ft.includes("%")))try{ft=O.exec(decodeURIComponent(ft))[0]}catch{}return ft||dt}class H{constructor(){Xe(this,"started",Object.create(null));Xe(this,"times",[])}time(dt){dt in this.started&&(0,k.warn)(`Timer is already running for ${dt}`),this.started[dt]=Date.now()}timeEnd(dt){dt in this.started||(0,k.warn)(`Timer has not been started for ${dt}`),this.times.push({name:dt,start:this.started[dt],end:Date.now()}),delete this.started[dt]}toString(){const dt=[];let S=0;for(const{name:O}of this.times)S=Math.max(O.length,S);for(const{name:O,start:nt,end:ft}of this.times)dt.push(`${O.padEnd(S)} ${ft-nt}ms
`);return dt.join("")}}b.StatTimer=H;function C(ht,dt){try{const{protocol:S}=dt?new URL(ht,dt):new URL(ht);return S==="http:"||S==="https:"}catch{return!1}}function a(ht){ht.preventDefault()}function u(ht,dt=!1){return new Promise((S,O)=>{const nt=document.createElement("script");nt.src=ht,nt.onload=function(ft){dt&&nt.remove(),S(ft)},nt.onerror=function(){O(new Error(`Cannot load script at: ${nt.src}`))},(document.head||document.documentElement).append(nt)})}function o(ht){console.log("Deprecated API usage: "+ht)}let c;class h{static toDateObject(dt){if(!dt||typeof dt!="string")return null;c||(c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const S=c.exec(dt);if(!S)return null;const O=parseInt(S[1],10);let nt=parseInt(S[2],10);nt=nt>=1&&nt<=12?nt-1:0;let ft=parseInt(S[3],10);ft=ft>=1&&ft<=31?ft:1;let Ct=parseInt(S[4],10);Ct=Ct>=0&&Ct<=23?Ct:0;let Dt=parseInt(S[5],10);Dt=Dt>=0&&Dt<=59?Dt:0;let Rt=parseInt(S[6],10);Rt=Rt>=0&&Rt<=59?Rt:0;const et=S[7]||"Z";let zt=parseInt(S[8],10);zt=zt>=0&&zt<=23?zt:0;let Ht=parseInt(S[9],10)||0;return Ht=Ht>=0&&Ht<=59?Ht:0,et==="-"?(Ct+=zt,Dt+=Ht):et==="+"&&(Ct-=zt,Dt-=Ht),new Date(Date.UTC(O,nt,ft,Ct,Dt,Rt))}}b.PDFDateString=h;function B(ht,{scale:dt=1,rotation:S=0}){const{width:O,height:nt}=ht.attributes.style,ft=[0,0,parseInt(O),parseInt(nt)];return new A({viewBox:ft,scale:dt,rotation:S})}function l(ht){if(ht.startsWith("#")){const dt=parseInt(ht.slice(1),16);return[(dt&16711680)>>16,(dt&65280)>>8,dt&255]}return ht.startsWith("rgb(")?ht.slice(4,-1).split(",").map(dt=>parseInt(dt)):ht.startsWith("rgba(")?ht.slice(5,-1).split(",").map(dt=>parseInt(dt)).slice(0,3):((0,k.warn)(`Not a valid color format: "${ht}"`),[0,0,0])}function w(ht){const dt=document.createElement("span");dt.style.visibility="hidden",document.body.append(dt);for(const S of ht.keys()){dt.style.color=S;const O=window.getComputedStyle(dt).color;ht.set(S,l(O))}dt.remove()}function I(ht){const{a:dt,b:S,c:O,d:nt,e:ft,f:Ct}=ht.getTransform();return[dt,S,O,nt,ft,Ct]}function bt(ht){const{a:dt,b:S,c:O,d:nt,e:ft,f:Ct}=ht.getTransform().invertSelf();return[dt,S,O,nt,ft,Ct]}function K(ht,dt,S=!1,O=!0){if(dt instanceof A){const{pageWidth:nt,pageHeight:ft}=dt.rawDims,{style:Ct}=ht,Dt=k.FeatureTest.isCSSRoundSupported,Rt=`var(--scale-factor) * ${nt}px`,et=`var(--scale-factor) * ${ft}px`,zt=Dt?`round(${Rt}, 1px)`:`calc(${Rt})`,Ht=Dt?`round(${et}, 1px)`:`calc(${et})`;!S||dt.rotation%180===0?(Ct.width=zt,Ct.height=Ht):(Ct.width=Ht,Ct.height=zt)}O&&ht.setAttribute("data-main-rotation",dt.rotation)}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BaseStandardFontDataFactory=b.BaseSVGFactory=b.BaseFilterFactory=b.BaseCanvasFactory=b.BaseCMapReaderFactory=void 0;var g=Et(1);class k{constructor(){this.constructor===k&&(0,g.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,z){return"none"}addHighlightHCMFilter(f,z,W,A){return"none"}destroy(f=!1){}}b.BaseFilterFactory=k;class e{constructor(){this.constructor===e&&(0,g.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,z){if(f<=0||z<=0)throw new Error("Invalid canvas size");const W=this._createCanvas(f,z);return{canvas:W,context:W.getContext("2d")}}reset(f,z,W){if(!f.canvas)throw new Error("Canvas is not specified");if(z<=0||W<=0)throw new Error("Invalid canvas size");f.canvas.width=z,f.canvas.height=W}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,z){(0,g.unreachable)("Abstract method `_createCanvas` called.")}}b.BaseCanvasFactory=e;class it{constructor({baseUrl:f=null,isCompressed:z=!0}){this.constructor===it&&(0,g.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=z}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const z=this.baseUrl+f+(this.isCompressed?".bcmap":""),W=this.isCompressed?g.CMapCompressionType.BINARY:g.CMapCompressionType.NONE;return this._fetchData(z,W).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${z}`)})}_fetchData(f,z){(0,g.unreachable)("Abstract method `_fetchData` called.")}}b.BaseCMapReaderFactory=it;class Mt{constructor({baseUrl:f=null}){this.constructor===Mt&&(0,g.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const z=`${this.baseUrl}${f}`;return this._fetchData(z).catch(W=>{throw new Error(`Unable to load font data at: ${z}`)})}_fetchData(f){(0,g.unreachable)("Abstract method `_fetchData` called.")}}b.BaseStandardFontDataFactory=Mt;class G{constructor(){this.constructor===G&&(0,g.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,z,W=!1){if(f<=0||z<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),W||(A.setAttribute("width",`${f}px`),A.setAttribute("height",`${z}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${f} ${z}`),A}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,g.unreachable)("Abstract method `_createSVG` called.")}}b.BaseSVGFactory=G},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MurmurHash3_64=void 0;var g=Et(1);const k=3285377520,e=4294901760,it=65535;class Mt{constructor(N){this.h1=N?N&4294967295:k,this.h2=N?N&4294967295:k}update(N){let f,z;if(typeof N=="string"){f=new Uint8Array(N.length*2),z=0;for(let o=0,c=N.length;o<c;o++){const h=N.charCodeAt(o);h<=255?f[z++]=h:(f[z++]=h>>>8,f[z++]=h&255)}}else if((0,g.isArrayBuffer)(N))f=N.slice(),z=f.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const W=z>>2,A=z-W*4,_=new Uint32Array(f.buffer,0,W);let R=0,y=0,m=this.h1,E=this.h2;const H=3432918353,C=461845907,a=H&it,u=C&it;for(let o=0;o<W;o++)o&1?(R=_[o],R=R*H&e|R*a&it,R=R<<15|R>>>17,R=R*C&e|R*u&it,m^=R,m=m<<13|m>>>19,m=m*5+3864292196):(y=_[o],y=y*H&e|y*a&it,y=y<<15|y>>>17,y=y*C&e|y*u&it,E^=y,E=E<<13|E>>>19,E=E*5+3864292196);switch(R=0,A){case 3:R^=f[W*4+2]<<16;case 2:R^=f[W*4+1]<<8;case 1:R^=f[W*4],R=R*H&e|R*a&it,R=R<<15|R>>>17,R=R*C&e|R*u&it,W&1?m^=R:E^=R}this.h1=m,this.h2=E}hexdigest(){let N=this.h1,f=this.h2;return N^=f>>>1,N=N*3981806797&e|N*36045&it,f=f*4283543511&e|((f<<16|N>>>16)*2950163797&e)>>>16,N^=f>>>1,N=N*444984403&e|N*60499&it,f=f*3301882366&e|((f<<16|N>>>16)*3120437893&e)>>>16,N^=f>>>1,(N>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}b.MurmurHash3_64=Mt},(d,b,Et)=>{var it;Object.defineProperty(b,"__esModule",{value:!0}),b.FontLoader=b.FontFaceObject=void 0;var g=Et(1);class k{constructor({ownerDocument:G=globalThis.document,styleElement:N=null}){gt(this,it,new Set);this._document=G,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(G){this.nativeFontFaces.add(G),this._document.fonts.add(G)}removeNativeFontFace(G){this.nativeFontFaces.delete(G),this._document.fonts.delete(G)}insertRule(G){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const N=this.styleElement.sheet;N.insertRule(G,N.cssRules.length)}clear(){for(const G of this.nativeFontFaces)this._document.fonts.delete(G);this.nativeFontFaces.clear(),t(this,it).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(G){if(!(!G||t(this,it).has(G.loadedName))){if((0,g.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:N,src:f,style:z}=G,W=new FontFace(N,f,z);this.addNativeFontFace(W);try{await W.load(),t(this,it).add(N)}catch{(0,g.warn)(`Cannot load system font: ${G.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(W)}return}(0,g.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(G){if(G.attached||G.missingFile&&!G.systemFontInfo)return;if(G.attached=!0,G.systemFontInfo){await this.loadSystemFont(G.systemFontInfo);return}if(this.isFontLoadingAPISupported){const f=G.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(z){throw(0,g.warn)(`Failed to load font '${f.family}': '${z}'.`),G.disableFontFace=!0,z}}return}const N=G.createFontFaceRule();if(N){if(this.insertRule(N),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const z=this._queueLoadingCallback(f);this._prepareFontLoadEvent(G,z)})}}get isFontLoadingAPISupported(){var N;const G=!!((N=this._document)!=null&&N.fonts);return(0,g.shadow)(this,"isFontLoadingAPISupported",G)}get isSyncFontLoadingSupported(){let G=!1;return(g.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(G=!0),(0,g.shadow)(this,"isSyncFontLoadingSupported",G)}_queueLoadingCallback(G){function N(){for((0,g.assert)(!z.done,"completeRequest() cannot be called twice."),z.done=!0;f.length>0&&f[0].done;){const W=f.shift();setTimeout(W.callback,0)}}const{loadingRequests:f}=this,z={done:!1,complete:N,callback:G};return f.push(z),z}get _loadTestFont(){const G=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,g.shadow)(this,"_loadTestFont",G)}_prepareFontLoadEvent(G,N){function f(l,w){return l.charCodeAt(w)<<24|l.charCodeAt(w+1)<<16|l.charCodeAt(w+2)<<8|l.charCodeAt(w+3)&255}function z(l,w,I,bt){const K=l.substring(0,w),rt=l.substring(w+I);return K+bt+rt}let W,A;const _=this._document.createElement("canvas");_.width=1,_.height=1;const R=_.getContext("2d");let y=0;function m(l,w){if(++y>30){(0,g.warn)("Load test font never loaded."),w();return}if(R.font="30px "+l,R.fillText(".",0,20),R.getImageData(0,0,1,1).data[3]>0){w();return}setTimeout(m.bind(null,l,w))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let H=this._loadTestFont;H=z(H,976,E.length,E);const a=16,u=1482184792;let o=f(H,a);for(W=0,A=E.length-3;W<A;W+=4)o=o-u+f(E,W)|0;W<E.length&&(o=o-u+f(E+"XXX",W)|0),H=z(H,a,4,(0,g.string32)(o));const c=`url(data:font/opentype;base64,${btoa(H)});`,h=`@font-face {font-family:"${E}";src:${c}}`;this.insertRule(h);const B=this._document.createElement("div");B.style.visibility="hidden",B.style.width=B.style.height="10px",B.style.position="absolute",B.style.top=B.style.left="0px";for(const l of[G.loadedName,E]){const w=this._document.createElement("span");w.textContent="Hi",w.style.fontFamily=l,B.append(w)}this._document.body.append(B),m(E,()=>{B.remove(),N.complete()})}}it=new WeakMap,b.FontLoader=k;class e{constructor(G,{isEvalSupported:N=!0,disableFontFace:f=!1,ignoreErrors:z=!1,inspectFont:W=null}){this.compiledGlyphs=Object.create(null);for(const A in G)this[A]=G[A];this.isEvalSupported=N!==!1,this.disableFontFace=f===!0,this.ignoreErrors=z===!0,this._inspectFont=W}createNativeFontFace(){var N;if(!this.data||this.disableFontFace)return null;let G;if(!this.cssFontInfo)G=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),G=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return(N=this._inspectFont)==null||N.call(this,this),G}createFontFaceRule(){var z;if(!this.data||this.disableFontFace)return null;const G=(0,g.bytesToString)(this.data),N=`url(data:${this.mimetype};base64,${btoa(G)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${N}}`;else{let W=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(W+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${W}src:${N}}`}return(z=this._inspectFont)==null||z.call(this,this,N),f}getPathGenerator(G,N){if(this.compiledGlyphs[N]!==void 0)return this.compiledGlyphs[N];let f;try{f=G.get(this.loadedName+"_path_"+N)}catch(z){if(!this.ignoreErrors)throw z;return(0,g.warn)(`getPathGenerator - ignoring character: "${z}".`),this.compiledGlyphs[N]=function(W,A){}}if(this.isEvalSupported&&g.FeatureTest.isEvalSupported){const z=[];for(const W of f){const A=W.args!==void 0?W.args.join(","):"";z.push("c.",W.cmd,"(",A,`);
`)}return this.compiledGlyphs[N]=new Function("c","size",z.join(""))}return this.compiledGlyphs[N]=function(z,W){for(const A of f)A.cmd==="scale"&&(A.args=[W,-W]),z[A.cmd].apply(z,A.args)}}}b.FontFaceObject=e},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NodeStandardFontDataFactory=b.NodeFilterFactory=b.NodeCanvasFactory=b.NodeCMapReaderFactory=void 0;var g=Et(7);Et(1);const k=function(N){return new Promise((f,z)=>{require$$5.readFile(N,(A,_)=>{if(A||!_){z(new Error(A));return}f(new Uint8Array(_))})})};class e extends g.BaseFilterFactory{}b.NodeFilterFactory=e;class it extends g.BaseCanvasFactory{_createCanvas(f,z){return require$$5.createCanvas(f,z)}}b.NodeCanvasFactory=it;class Mt extends g.BaseCMapReaderFactory{_fetchData(f,z){return k(f).then(W=>({cMapData:W,compressionType:z}))}}b.NodeCMapReaderFactory=Mt;class G extends g.BaseStandardFontDataFactory{_fetchData(f){return k(f)}}b.NodeStandardFontDataFactory=G},(d,b,Et)=>{var _t,qi,Gi;Object.defineProperty(b,"__esModule",{value:!0}),b.CanvasGraphics=void 0;var g=Et(1),k=Et(6),e=Et(12),it=Et(13);const Mt=16,G=100,N=4096,f=15,z=10,W=1e3,A=16;function _(T,i){if(T._removeMirroring)throw new Error("Context is already forwarding operations.");T.__originalSave=T.save,T.__originalRestore=T.restore,T.__originalRotate=T.rotate,T.__originalScale=T.scale,T.__originalTranslate=T.translate,T.__originalTransform=T.transform,T.__originalSetTransform=T.setTransform,T.__originalResetTransform=T.resetTransform,T.__originalClip=T.clip,T.__originalMoveTo=T.moveTo,T.__originalLineTo=T.lineTo,T.__originalBezierCurveTo=T.bezierCurveTo,T.__originalRect=T.rect,T.__originalClosePath=T.closePath,T.__originalBeginPath=T.beginPath,T._removeMirroring=()=>{T.save=T.__originalSave,T.restore=T.__originalRestore,T.rotate=T.__originalRotate,T.scale=T.__originalScale,T.translate=T.__originalTranslate,T.transform=T.__originalTransform,T.setTransform=T.__originalSetTransform,T.resetTransform=T.__originalResetTransform,T.clip=T.__originalClip,T.moveTo=T.__originalMoveTo,T.lineTo=T.__originalLineTo,T.bezierCurveTo=T.__originalBezierCurveTo,T.rect=T.__originalRect,T.closePath=T.__originalClosePath,T.beginPath=T.__originalBeginPath,delete T._removeMirroring},T.save=function(){i.save(),this.__originalSave()},T.restore=function(){i.restore(),this.__originalRestore()},T.translate=function(v,L){i.translate(v,L),this.__originalTranslate(v,L)},T.scale=function(v,L){i.scale(v,L),this.__originalScale(v,L)},T.transform=function(v,L,D,F,Q,vt){i.transform(v,L,D,F,Q,vt),this.__originalTransform(v,L,D,F,Q,vt)},T.setTransform=function(v,L,D,F,Q,vt){i.setTransform(v,L,D,F,Q,vt),this.__originalSetTransform(v,L,D,F,Q,vt)},T.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},T.rotate=function(v){i.rotate(v),this.__originalRotate(v)},T.clip=function(v){i.clip(v),this.__originalClip(v)},T.moveTo=function(r,v){i.moveTo(r,v),this.__originalMoveTo(r,v)},T.lineTo=function(r,v){i.lineTo(r,v),this.__originalLineTo(r,v)},T.bezierCurveTo=function(r,v,L,D,F,Q){i.bezierCurveTo(r,v,L,D,F,Q),this.__originalBezierCurveTo(r,v,L,D,F,Q)},T.rect=function(r,v,L,D){i.rect(r,v,L,D),this.__originalRect(r,v,L,D)},T.closePath=function(){i.closePath(),this.__originalClosePath()},T.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class R{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,r,v){let L;return this.cache[i]!==void 0?(L=this.cache[i],this.canvasFactory.reset(L,r,v)):(L=this.canvasFactory.create(r,v),this.cache[i]=L),L}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const r=this.cache[i];this.canvasFactory.destroy(r),delete this.cache[i]}}}function y(T,i,r,v,L,D,F,Q,vt,St){const[wt,Tt,Ft,Lt,ht,dt]=(0,k.getCurrentTransform)(T);if(Tt===0&&Ft===0){const nt=F*wt+ht,ft=Math.round(nt),Ct=Q*Lt+dt,Dt=Math.round(Ct),Rt=(F+vt)*wt+ht,et=Math.abs(Math.round(Rt)-ft)||1,zt=(Q+St)*Lt+dt,Ht=Math.abs(Math.round(zt)-Dt)||1;return T.setTransform(Math.sign(wt),0,0,Math.sign(Lt),ft,Dt),T.drawImage(i,r,v,L,D,0,0,et,Ht),T.setTransform(wt,Tt,Ft,Lt,ht,dt),[et,Ht]}if(wt===0&&Lt===0){const nt=Q*Ft+ht,ft=Math.round(nt),Ct=F*Tt+dt,Dt=Math.round(Ct),Rt=(Q+St)*Ft+ht,et=Math.abs(Math.round(Rt)-ft)||1,zt=(F+vt)*Tt+dt,Ht=Math.abs(Math.round(zt)-Dt)||1;return T.setTransform(0,Math.sign(Tt),Math.sign(Ft),0,ft,Dt),T.drawImage(i,r,v,L,D,0,0,Ht,et),T.setTransform(wt,Tt,Ft,Lt,ht,dt),[Ht,et]}T.drawImage(i,r,v,L,D,F,Q,vt,St);const S=Math.hypot(wt,Tt),O=Math.hypot(Ft,Lt);return[S*vt,O*St]}function m(T){const{width:i,height:r}=T;if(i>W||r>W)return null;const v=1e3,L=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=i+1;let F=new Uint8Array(D*(r+1)),Q,vt,St;const wt=i+7&-8;let Tt=new Uint8Array(wt*r),Ft=0;for(const O of T.data){let nt=128;for(;nt>0;)Tt[Ft++]=O&nt?0:255,nt>>=1}let Lt=0;for(Ft=0,Tt[Ft]!==0&&(F[0]=1,++Lt),vt=1;vt<i;vt++)Tt[Ft]!==Tt[Ft+1]&&(F[vt]=Tt[Ft]?2:1,++Lt),Ft++;for(Tt[Ft]!==0&&(F[vt]=2,++Lt),Q=1;Q<r;Q++){Ft=Q*wt,St=Q*D,Tt[Ft-wt]!==Tt[Ft]&&(F[St]=Tt[Ft]?1:8,++Lt);let O=(Tt[Ft]?4:0)+(Tt[Ft-wt]?8:0);for(vt=1;vt<i;vt++)O=(O>>2)+(Tt[Ft+1]?4:0)+(Tt[Ft-wt+1]?8:0),L[O]&&(F[St+vt]=L[O],++Lt),Ft++;if(Tt[Ft-wt]!==Tt[Ft]&&(F[St+vt]=Tt[Ft]?2:4,++Lt),Lt>v)return null}for(Ft=wt*(r-1),St=Q*D,Tt[Ft]!==0&&(F[St]=8,++Lt),vt=1;vt<i;vt++)Tt[Ft]!==Tt[Ft+1]&&(F[St+vt]=Tt[Ft]?4:8,++Lt),Ft++;if(Tt[Ft]!==0&&(F[St+vt]=4,++Lt),Lt>v)return null;const ht=new Int32Array([0,D,-1,0,-D,0,0,0,1]),dt=new Path2D;for(Q=0;Lt&&Q<=r;Q++){let O=Q*D;const nt=O+i;for(;O<nt&&!F[O];)O++;if(O===nt)continue;dt.moveTo(O%D,Q);const ft=O;let Ct=F[O];do{const Dt=ht[Ct];do O+=Dt;while(!F[O]);const Rt=F[O];Rt!==5&&Rt!==10?(Ct=Rt,F[O]=0):(Ct=Rt&51*Ct>>4,F[O]&=Ct>>2|Ct<<2),dt.lineTo(O%D,O/D|0),F[O]||--Lt}while(ft!==O);--Q}return Tt=null,F=null,function(O){O.save(),O.scale(1/i,-1/r),O.translate(0,-r),O.fill(dt),O.beginPath(),O.restore()}}class E{constructor(i,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=g.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=g.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=g.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,r])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,r){this.x=i,this.y=r}updatePathMinMax(i,r,v){[r,v]=g.Util.applyTransform([r,v],i),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,v),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,v)}updateRectMinMax(i,r){const v=g.Util.applyTransform(r,i),L=g.Util.applyTransform(r.slice(2),i);this.minX=Math.min(this.minX,v[0],L[0]),this.minY=Math.min(this.minY,v[1],L[1]),this.maxX=Math.max(this.maxX,v[0],L[0]),this.maxY=Math.max(this.maxY,v[1],L[1])}updateScalingPathMinMax(i,r){g.Util.scaleMinMax(i,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(i,r,v,L,D,F,Q,vt,St,wt){const Tt=g.Util.bezierBoundingBox(r,v,L,D,F,Q,vt,St);if(wt){wt[0]=Math.min(wt[0],Tt[0],Tt[2]),wt[1]=Math.max(wt[1],Tt[0],Tt[2]),wt[2]=Math.min(wt[2],Tt[1],Tt[3]),wt[3]=Math.max(wt[3],Tt[1],Tt[3]);return}this.updateRectMinMax(i,Tt)}getPathBoundingBox(i=e.PathType.FILL,r=null){const v=[this.minX,this.minY,this.maxX,this.maxY];if(i===e.PathType.STROKE){r||(0,g.unreachable)("Stroke bounding box must include transform.");const L=g.Util.singularValueDecompose2dScale(r),D=L[0]*this.lineWidth/2,F=L[1]*this.lineWidth/2;v[0]-=D,v[1]-=F,v[2]+=D,v[3]+=F}return v}updateClipFromPath(){const i=g.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=e.PathType.FILL,r=null){return g.Util.intersect(this.clipBox,this.getPathBoundingBox(i,r))}}function H(T,i){if(typeof ImageData<"u"&&i instanceof ImageData){T.putImageData(i,0,0);return}const r=i.height,v=i.width,L=r%A,D=(r-L)/A,F=L===0?D:D+1,Q=T.createImageData(v,A);let vt=0,St;const wt=i.data,Tt=Q.data;let Ft,Lt,ht,dt;if(i.kind===g.ImageKind.GRAYSCALE_1BPP){const S=wt.byteLength,O=new Uint32Array(Tt.buffer,0,Tt.byteLength>>2),nt=O.length,ft=v+7>>3,Ct=4294967295,Dt=g.FeatureTest.isLittleEndian?4278190080:255;for(Ft=0;Ft<F;Ft++){for(ht=Ft<D?A:L,St=0,Lt=0;Lt<ht;Lt++){const Rt=S-vt;let et=0;const zt=Rt>ft?v:Rt*8-7,Ht=zt&-8;let me=0,ce=0;for(;et<Ht;et+=8)ce=wt[vt++],O[St++]=ce&128?Ct:Dt,O[St++]=ce&64?Ct:Dt,O[St++]=ce&32?Ct:Dt,O[St++]=ce&16?Ct:Dt,O[St++]=ce&8?Ct:Dt,O[St++]=ce&4?Ct:Dt,O[St++]=ce&2?Ct:Dt,O[St++]=ce&1?Ct:Dt;for(;et<zt;et++)me===0&&(ce=wt[vt++],me=128),O[St++]=ce&me?Ct:Dt,me>>=1}for(;St<nt;)O[St++]=0;T.putImageData(Q,0,Ft*A)}}else if(i.kind===g.ImageKind.RGBA_32BPP){for(Lt=0,dt=v*A*4,Ft=0;Ft<D;Ft++)Tt.set(wt.subarray(vt,vt+dt)),vt+=dt,T.putImageData(Q,0,Lt),Lt+=A;Ft<F&&(dt=v*L*4,Tt.set(wt.subarray(vt,vt+dt)),T.putImageData(Q,0,Lt))}else if(i.kind===g.ImageKind.RGB_24BPP)for(ht=A,dt=v*ht,Ft=0;Ft<F;Ft++){for(Ft>=D&&(ht=L,dt=v*ht),St=0,Lt=dt;Lt--;)Tt[St++]=wt[vt++],Tt[St++]=wt[vt++],Tt[St++]=wt[vt++],Tt[St++]=255;T.putImageData(Q,0,Ft*A)}else throw new Error(`bad image kind: ${i.kind}`)}function C(T,i){if(i.bitmap){T.drawImage(i.bitmap,0,0);return}const r=i.height,v=i.width,L=r%A,D=(r-L)/A,F=L===0?D:D+1,Q=T.createImageData(v,A);let vt=0;const St=i.data,wt=Q.data;for(let Tt=0;Tt<F;Tt++){const Ft=Tt<D?A:L;({srcPos:vt}=(0,it.convertBlackAndWhiteToRGBA)({src:St,srcPos:vt,dest:wt,width:v,height:Ft,nonBlackColor:0})),T.putImageData(Q,0,Tt*A)}}function a(T,i){const r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const v of r)T[v]!==void 0&&(i[v]=T[v]);T.setLineDash!==void 0&&(i.setLineDash(T.getLineDash()),i.lineDashOffset=T.lineDashOffset)}function u(T){if(T.strokeStyle=T.fillStyle="#000000",T.fillRule="nonzero",T.globalAlpha=1,T.lineWidth=1,T.lineCap="butt",T.lineJoin="miter",T.miterLimit=10,T.globalCompositeOperation="source-over",T.font="10px sans-serif",T.setLineDash!==void 0&&(T.setLineDash([]),T.lineDashOffset=0),!g.isNodeJS){const{filter:i}=T;i!=="none"&&i!==""&&(T.filter="none")}}function o(T,i,r,v){const L=T.length;for(let D=3;D<L;D+=4){const F=T[D];if(F===0)T[D-3]=i,T[D-2]=r,T[D-1]=v;else if(F<255){const Q=255-F;T[D-3]=T[D-3]*F+i*Q>>8,T[D-2]=T[D-2]*F+r*Q>>8,T[D-1]=T[D-1]*F+v*Q>>8}}}function c(T,i,r){const v=T.length,L=1/255;for(let D=3;D<v;D+=4){const F=r?r[T[D]]:T[D];i[D]=i[D]*F*L|0}}function h(T,i,r){const v=T.length;for(let L=3;L<v;L+=4){const D=T[L-3]*77+T[L-2]*152+T[L-1]*28;i[L]=r?i[L]*r[D>>8]>>8:i[L]*D>>16}}function B(T,i,r,v,L,D,F,Q,vt,St,wt){const Tt=!!D,Ft=Tt?D[0]:0,Lt=Tt?D[1]:0,ht=Tt?D[2]:0,dt=L==="Luminosity"?h:c,O=Math.min(v,Math.ceil(1048576/r));for(let nt=0;nt<v;nt+=O){const ft=Math.min(O,v-nt),Ct=T.getImageData(Q-St,nt+(vt-wt),r,ft),Dt=i.getImageData(Q,nt+vt,r,ft);Tt&&o(Ct.data,Ft,Lt,ht),dt(Ct.data,Dt.data,F),i.putImageData(Dt,Q,nt+vt)}}function l(T,i,r,v){const L=v[0],D=v[1],F=v[2]-L,Q=v[3]-D;F===0||Q===0||(B(i.context,r,F,Q,i.subtype,i.backdrop,i.transferMap,L,D,i.offsetX,i.offsetY),T.save(),T.globalAlpha=1,T.globalCompositeOperation="source-over",T.setTransform(1,0,0,1,0,0),T.drawImage(r.canvas,0,0),T.restore())}function w(T,i){const r=g.Util.singularValueDecompose2dScale(T);r[0]=Math.fround(r[0]),r[1]=Math.fround(r[1]);const v=Math.fround((globalThis.devicePixelRatio||1)*k.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:r[0]<=v||r[1]<=v}const I=["butt","round","square"],bt=["miter","round","bevel"],K={},rt={},ct=class ct{constructor(i,r,v,L,D,{optionalContentConfig:F,markedContentStack:Q=null},vt,St){gt(this,_t);this.ctx=i,this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=v,this.canvasFactory=L,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Q||[],this.optionalContentConfig=F,this.cachedCanvases=new R(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=vt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=St,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,r=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):r}beginDrawing({transform:i,viewport:r,transparency:v=!1,background:L=null}){const D=this.ctx.canvas.width,F=this.ctx.canvas.height,Q=this.ctx.fillStyle;if(this.ctx.fillStyle=L||"#ffffff",this.ctx.fillRect(0,0,D,F),this.ctx.fillStyle=Q,v){const vt=this.cachedCanvases.getCanvas("transparent",D,F);this.compositeCtx=this.ctx,this.transparentCanvas=vt.canvas,this.ctx=vt.context,this.ctx.save(),this.ctx.transform(...(0,k.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),u(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...r.transform),this.viewportScale=r.scale,this.baseTransform=(0,k.getCurrentTransform)(this.ctx)}executeOperatorList(i,r,v,L){const D=i.argsArray,F=i.fnArray;let Q=r||0;const vt=D.length;if(vt===Q)return Q;const St=vt-Q>z&&typeof v=="function",wt=St?Date.now()+f:0;let Tt=0;const Ft=this.commonObjs,Lt=this.objs;let ht;for(;;){if(L!==void 0&&Q===L.nextBreakPoint)return L.breakIt(Q,v),Q;if(ht=F[Q],ht!==g.OPS.dependency)this[ht].apply(this,D[Q]);else for(const dt of D[Q]){const S=dt.startsWith("g_")?Ft:Lt;if(!S.has(dt))return S.get(dt,v),Q}if(Q++,Q===vt)return Q;if(St&&++Tt>z){if(Date.now()>wt)return v(),Q;Tt=0}}}endDrawing(){tt(this,_t,qi).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const r of i.values())typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);i.clear()}this._cachedBitmapsMap.clear(),tt(this,_t,Gi).call(this)}_scaleImage(i,r){const v=i.width,L=i.height;let D=Math.max(Math.hypot(r[0],r[1]),1),F=Math.max(Math.hypot(r[2],r[3]),1),Q=v,vt=L,St="prescale1",wt,Tt;for(;D>2&&Q>1||F>2&&vt>1;){let Ft=Q,Lt=vt;D>2&&Q>1&&(Ft=Q>=16384?Math.floor(Q/2)-1||1:Math.ceil(Q/2),D/=Q/Ft),F>2&&vt>1&&(Lt=vt>=16384?Math.floor(vt/2)-1||1:Math.ceil(vt)/2,F/=vt/Lt),wt=this.cachedCanvases.getCanvas(St,Ft,Lt),Tt=wt.context,Tt.clearRect(0,0,Ft,Lt),Tt.drawImage(i,0,0,Q,vt,0,0,Ft,Lt),i=wt.canvas,Q=Ft,vt=Lt,St=St==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:Q,paintHeight:vt}}_createMaskCanvas(i){const r=this.ctx,{width:v,height:L}=i,D=this.current.fillColor,F=this.current.patternFill,Q=(0,k.getCurrentTransform)(r);let vt,St,wt,Tt;if((i.bitmap||i.data)&&i.count>1){const et=i.bitmap||i.data.buffer;St=JSON.stringify(F?Q:[Q.slice(0,4),D]),vt=this._cachedBitmapsMap.get(et),vt||(vt=new Map,this._cachedBitmapsMap.set(et,vt));const zt=vt.get(St);if(zt&&!F){const Ht=Math.round(Math.min(Q[0],Q[2])+Q[4]),me=Math.round(Math.min(Q[1],Q[3])+Q[5]);return{canvas:zt,offsetX:Ht,offsetY:me}}wt=zt}wt||(Tt=this.cachedCanvases.getCanvas("maskCanvas",v,L),C(Tt.context,i));let Ft=g.Util.transform(Q,[1/v,0,0,-1/L,0,0]);Ft=g.Util.transform(Ft,[1,0,0,1,0,-L]);const Lt=g.Util.applyTransform([0,0],Ft),ht=g.Util.applyTransform([v,L],Ft),dt=g.Util.normalizeRect([Lt[0],Lt[1],ht[0],ht[1]]),S=Math.round(dt[2]-dt[0])||1,O=Math.round(dt[3]-dt[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",S,O),ft=nt.context,Ct=Math.min(Lt[0],ht[0]),Dt=Math.min(Lt[1],ht[1]);ft.translate(-Ct,-Dt),ft.transform(...Ft),wt||(wt=this._scaleImage(Tt.canvas,(0,k.getCurrentTransformInverse)(ft)),wt=wt.img,vt&&F&&vt.set(St,wt)),ft.imageSmoothingEnabled=w((0,k.getCurrentTransform)(ft),i.interpolate),y(ft,wt,0,0,wt.width,wt.height,0,0,v,L),ft.globalCompositeOperation="source-in";const Rt=g.Util.transform((0,k.getCurrentTransformInverse)(ft),[1,0,0,1,-Ct,-Dt]);return ft.fillStyle=F?D.getPattern(r,this,Rt,e.PathType.FILL):D,ft.fillRect(0,0,v,L),vt&&!F&&(this.cachedCanvases.delete("fillCanvas"),vt.set(St,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(Ct),offsetY:Math.round(Dt)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=I[i]}setLineJoin(i){this.ctx.lineJoin=bt[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,r){const v=this.ctx;v.setLineDash!==void 0&&(v.setLineDash(i),v.lineDashOffset=r)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[r,v]of i)switch(r){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v[0],v[1]);break;case"CA":this.current.strokeAlpha=v;break;case"ca":this.current.fillAlpha=v,this.ctx.globalAlpha=v;break;case"BM":this.ctx.globalCompositeOperation=v;break;case"SMask":this.current.activeSMask=v?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(v);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,r=this.ctx.canvas.height,v="smaskGroupAt"+this.groupLevel,L=this.cachedCanvases.getCanvas(v,i,r);this.suspendedCtx=this.ctx,this.ctx=L.context;const D=this.ctx;D.setTransform(...(0,k.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,D),_(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask,v=this.suspendedCtx;l(v,r,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,r,v,L,D,F){this.ctx.transform(i,r,v,L,D,F),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,r,v){const L=this.ctx,D=this.current;let F=D.x,Q=D.y,vt,St;const wt=(0,k.getCurrentTransform)(L),Tt=wt[0]===0&&wt[3]===0||wt[1]===0&&wt[2]===0,Ft=Tt?v.slice(0):null;for(let Lt=0,ht=0,dt=i.length;Lt<dt;Lt++)switch(i[Lt]|0){case g.OPS.rectangle:F=r[ht++],Q=r[ht++];const S=r[ht++],O=r[ht++],nt=F+S,ft=Q+O;L.moveTo(F,Q),S===0||O===0?L.lineTo(nt,ft):(L.lineTo(nt,Q),L.lineTo(nt,ft),L.lineTo(F,ft)),Tt||D.updateRectMinMax(wt,[F,Q,nt,ft]),L.closePath();break;case g.OPS.moveTo:F=r[ht++],Q=r[ht++],L.moveTo(F,Q),Tt||D.updatePathMinMax(wt,F,Q);break;case g.OPS.lineTo:F=r[ht++],Q=r[ht++],L.lineTo(F,Q),Tt||D.updatePathMinMax(wt,F,Q);break;case g.OPS.curveTo:vt=F,St=Q,F=r[ht+4],Q=r[ht+5],L.bezierCurveTo(r[ht],r[ht+1],r[ht+2],r[ht+3],F,Q),D.updateCurvePathMinMax(wt,vt,St,r[ht],r[ht+1],r[ht+2],r[ht+3],F,Q,Ft),ht+=6;break;case g.OPS.curveTo2:vt=F,St=Q,L.bezierCurveTo(F,Q,r[ht],r[ht+1],r[ht+2],r[ht+3]),D.updateCurvePathMinMax(wt,vt,St,F,Q,r[ht],r[ht+1],r[ht+2],r[ht+3],Ft),F=r[ht+2],Q=r[ht+3],ht+=4;break;case g.OPS.curveTo3:vt=F,St=Q,F=r[ht+2],Q=r[ht+3],L.bezierCurveTo(r[ht],r[ht+1],F,Q,F,Q),D.updateCurvePathMinMax(wt,vt,St,r[ht],r[ht+1],F,Q,F,Q,Ft),ht+=4;break;case g.OPS.closePath:L.closePath();break}Tt&&D.updateScalingPathMinMax(wt,Ft),D.setCurrentPoint(F,Q)}closePath(){this.ctx.closePath()}stroke(i=!0){const r=this.ctx,v=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof v=="object"&&(v!=null&&v.getPattern)?(r.save(),r.strokeStyle=v.getPattern(r,this,(0,k.getCurrentTransformInverse)(r),e.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const r=this.ctx,v=this.current.fillColor,L=this.current.patternFill;let D=!1;L&&(r.save(),r.fillStyle=v.getPattern(r,this,(0,k.getCurrentTransformInverse)(r),e.PathType.FILL),D=!0);const F=this.current.getClippedPathBoundingBox();this.contentVisible&&F!==null&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),D&&r.restore(),i&&this.consumePath(F)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=K}eoClip(){this.pendingClip=rt}beginText(){this.current.textMatrix=g.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,r=this.ctx;if(i===void 0){r.beginPath();return}r.save(),r.beginPath();for(const v of i)r.setTransform(...v.transform),r.translate(v.x,v.y),v.addToPath(r,v.fontSize);r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,r){var wt;const v=this.commonObjs.get(i),L=this.current;if(!v)throw new Error(`Can't find font for ${i}`);if(L.fontMatrix=v.fontMatrix||g.FONT_IDENTITY_MATRIX,(L.fontMatrix[0]===0||L.fontMatrix[3]===0)&&(0,g.warn)("Invalid font matrix for font "+i),r<0?(r=-r,L.fontDirection=-1):L.fontDirection=1,this.current.font=v,this.current.fontSize=r,v.isType3Font)return;const D=v.loadedName||"sans-serif",F=((wt=v.systemFontInfo)==null?void 0:wt.css)||`"${D}", ${v.fallbackName}`;let Q="normal";v.black?Q="900":v.bold&&(Q="bold");const vt=v.italic?"italic":"normal";let St=r;r<Mt?St=Mt:r>G&&(St=G),this.current.fontSizeScale=r/St,this.ctx.font=`${vt} ${Q} ${St}px ${F}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,r){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=r}setLeadingMoveText(i,r){this.setLeading(-r),this.moveText(i,r)}setTextMatrix(i,r,v,L,D,F){this.current.textMatrix=[i,r,v,L,D,F],this.current.textMatrixScale=Math.hypot(i,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,r,v,L){const D=this.ctx,F=this.current,Q=F.font,vt=F.textRenderingMode,St=F.fontSize/F.fontSizeScale,wt=vt&g.TextRenderingMode.FILL_STROKE_MASK,Tt=!!(vt&g.TextRenderingMode.ADD_TO_PATH_FLAG),Ft=F.patternFill&&!Q.missingFile;let Lt;(Q.disableFontFace||Tt||Ft)&&(Lt=Q.getPathGenerator(this.commonObjs,i)),Q.disableFontFace||Ft?(D.save(),D.translate(r,v),D.beginPath(),Lt(D,St),L&&D.setTransform(...L),(wt===g.TextRenderingMode.FILL||wt===g.TextRenderingMode.FILL_STROKE)&&D.fill(),(wt===g.TextRenderingMode.STROKE||wt===g.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((wt===g.TextRenderingMode.FILL||wt===g.TextRenderingMode.FILL_STROKE)&&D.fillText(i,r,v),(wt===g.TextRenderingMode.STROKE||wt===g.TextRenderingMode.FILL_STROKE)&&D.strokeText(i,r,v)),Tt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,k.getCurrentTransform)(D),x:r,y:v,fontSize:St,addToPath:Lt})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const r=i.getImageData(0,0,10,10).data;let v=!1;for(let L=3;L<r.length;L+=4)if(r[L]>0&&r[L]<255){v=!0;break}return(0,g.shadow)(this,"isFontSubpixelAAEnabled",v)}showText(i){const r=this.current,v=r.font;if(v.isType3Font)return this.showType3Text(i);const L=r.fontSize;if(L===0)return;const D=this.ctx,F=r.fontSizeScale,Q=r.charSpacing,vt=r.wordSpacing,St=r.fontDirection,wt=r.textHScale*St,Tt=i.length,Ft=v.vertical,Lt=Ft?1:-1,ht=v.defaultVMetrics,dt=L*r.fontMatrix[0],S=r.textRenderingMode===g.TextRenderingMode.FILL&&!v.disableFontFace&&!r.patternFill;D.save(),D.transform(...r.textMatrix),D.translate(r.x,r.y+r.textRise),St>0?D.scale(wt,-1):D.scale(wt,1);let O;if(r.patternFill){D.save();const Rt=r.fillColor.getPattern(D,this,(0,k.getCurrentTransformInverse)(D),e.PathType.FILL);O=(0,k.getCurrentTransform)(D),D.restore(),D.fillStyle=Rt}let nt=r.lineWidth;const ft=r.textMatrixScale;if(ft===0||nt===0){const Rt=r.textRenderingMode&g.TextRenderingMode.FILL_STROKE_MASK;(Rt===g.TextRenderingMode.STROKE||Rt===g.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=ft;if(F!==1&&(D.scale(F,F),nt/=F),D.lineWidth=nt,v.isInvalidPDFjsFont){const Rt=[];let et=0;for(const zt of i)Rt.push(zt.unicode),et+=zt.width;D.fillText(Rt.join(""),0,0),r.x+=et*dt*wt,D.restore(),this.compose();return}let Ct=0,Dt;for(Dt=0;Dt<Tt;++Dt){const Rt=i[Dt];if(typeof Rt=="number"){Ct+=Lt*Rt*L/1e3;continue}let et=!1;const zt=(Rt.isSpace?vt:0)+Q,Ht=Rt.fontChar,me=Rt.accent;let ce,Te,Yt=Rt.width;if(Ft){const Ae=Rt.vmetric||ht,Ie=-(Rt.vmetric?Ae[1]:Yt*.5)*dt,kt=Ae[2]*dt;Yt=Ae?-Ae[0]:Yt,ce=Ie/F,Te=(Ct+kt)/F}else ce=Ct/F,Te=0;if(v.remeasure&&Yt>0){const Ae=D.measureText(Ht).width*1e3/L*F;if(Yt<Ae&&this.isFontSubpixelAAEnabled){const Ie=Yt/Ae;et=!0,D.save(),D.scale(Ie,1),ce/=Ie}else Yt!==Ae&&(ce+=(Yt-Ae)/2e3*L/F)}if(this.contentVisible&&(Rt.isInFont||v.missingFile)){if(S&&!me)D.fillText(Ht,ce,Te);else if(this.paintChar(Ht,ce,Te,O),me){const Ae=ce+L*me.offset.x/F,Ie=Te-L*me.offset.y/F;this.paintChar(me.fontChar,Ae,Ie,O)}}const re=Ft?Yt*dt-zt*St:Yt*dt+zt*St;Ct+=re,et&&D.restore()}Ft?r.y-=Ct:r.x+=Ct*wt,D.restore(),this.compose()}showType3Text(i){const r=this.ctx,v=this.current,L=v.font,D=v.fontSize,F=v.fontDirection,Q=L.vertical?1:-1,vt=v.charSpacing,St=v.wordSpacing,wt=v.textHScale*F,Tt=v.fontMatrix||g.FONT_IDENTITY_MATRIX,Ft=i.length,Lt=v.textRenderingMode===g.TextRenderingMode.INVISIBLE;let ht,dt,S,O;if(!(Lt||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),r.transform(...v.textMatrix),r.translate(v.x,v.y),r.scale(wt,F),ht=0;ht<Ft;++ht){if(dt=i[ht],typeof dt=="number"){O=Q*dt*D/1e3,this.ctx.translate(O,0),v.x+=O*wt;continue}const nt=(dt.isSpace?St:0)+vt,ft=L.charProcOperatorList[dt.operatorListId];if(!ft){(0,g.warn)(`Type3 character "${dt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=dt,this.save(),r.scale(D,D),r.transform(...Tt),this.executeOperatorList(ft),this.restore()),S=g.Util.applyTransform([dt.width,0],Tt)[0]*D+nt,r.translate(S,0),v.x+=S*wt}r.restore(),this.processingType3=null}}setCharWidth(i,r){}setCharWidthAndBounds(i,r,v,L,D,F){this.ctx.rect(v,L,D-v,F-L),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let r;if(i[0]==="TilingPattern"){const v=i[1],L=this.baseTransform||(0,k.getCurrentTransform)(this.ctx),D={createCanvasGraphics:F=>new ct(F,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};r=new e.TilingPattern(i,v,this.ctx,D,L)}else r=this._getPattern(i[1],i[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,r,v){const L=g.Util.makeHexColor(i,r,v);this.ctx.strokeStyle=L,this.current.strokeColor=L}setFillRGBColor(i,r,v){const L=g.Util.makeHexColor(i,r,v);this.ctx.fillStyle=L,this.current.fillColor=L,this.current.patternFill=!1}_getPattern(i,r=null){let v;return this.cachedPatterns.has(i)?v=this.cachedPatterns.get(i):(v=(0,e.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,v)),r&&(v.matrix=r),v}shadingFill(i){if(!this.contentVisible)return;const r=this.ctx;this.save();const v=this._getPattern(i);r.fillStyle=v.getPattern(r,this,(0,k.getCurrentTransformInverse)(r),e.PathType.SHADING);const L=(0,k.getCurrentTransformInverse)(r);if(L){const{width:D,height:F}=r.canvas,[Q,vt,St,wt]=g.Util.getAxialAlignedBoundingBox([0,0,D,F],L);this.ctx.fillRect(Q,vt,St-Q,wt-vt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,g.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,g.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,k.getCurrentTransform)(this.ctx),r)){const v=r[2]-r[0],L=r[3]-r[1];this.ctx.rect(r[0],r[1],v,L),this.current.updateRectMinMax((0,k.getCurrentTransform)(this.ctx),r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;i.isolated||(0,g.info)("TODO: Support non-isolated groups."),i.knockout&&(0,g.warn)("Knockout groups not supported.");const v=(0,k.getCurrentTransform)(r);if(i.matrix&&r.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let L=g.Util.getAxialAlignedBoundingBox(i.bbox,(0,k.getCurrentTransform)(r));const D=[0,0,r.canvas.width,r.canvas.height];L=g.Util.intersect(L,D)||[0,0,0,0];const F=Math.floor(L[0]),Q=Math.floor(L[1]);let vt=Math.max(Math.ceil(L[2])-F,1),St=Math.max(Math.ceil(L[3])-Q,1),wt=1,Tt=1;vt>N&&(wt=vt/N,vt=N),St>N&&(Tt=St/N,St=N),this.current.startNewPathAndClipBox([0,0,vt,St]);let Ft="groupAt"+this.groupLevel;i.smask&&(Ft+="_smask_"+this.smaskCounter++%2);const Lt=this.cachedCanvases.getCanvas(Ft,vt,St),ht=Lt.context;ht.scale(1/wt,1/Tt),ht.translate(-F,-Q),ht.transform(...v),i.smask?this.smaskStack.push({canvas:Lt.canvas,context:ht,offsetX:F,offsetY:Q,scaleX:wt,scaleY:Tt,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(F,Q),r.scale(wt,Tt),r.save()),a(r,ht),this.ctx=ht,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,v=this.groupStack.pop();if(this.ctx=v,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const L=(0,k.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...L);const D=g.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],L);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(i,r,v,L,D){if(tt(this,_t,qi).call(this),u(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(r)&&r.length===4){const F=r[2]-r[0],Q=r[3]-r[1];if(D&&this.annotationCanvasMap){v=v.slice(),v[4]-=r[0],v[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=F,r[3]=Q;const[vt,St]=g.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(this.ctx)),{viewportScale:wt}=this,Tt=Math.ceil(F*this.outputScaleX*wt),Ft=Math.ceil(Q*this.outputScaleY*wt);this.annotationCanvas=this.canvasFactory.create(Tt,Ft);const{canvas:Lt,context:ht}=this.annotationCanvas;this.annotationCanvasMap.set(i,Lt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ht,this.ctx.save(),this.ctx.setTransform(vt,0,0,-St,0,Q*St),u(this.ctx)}else u(this.ctx),this.ctx.rect(r[0],r[1],F,Q),this.ctx.clip(),this.endPath()}this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...v),this.transform(...L)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),tt(this,_t,Gi).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const r=i.count;i=this.getObject(i.data,i),i.count=r;const v=this.ctx,L=this.processingType3;if(L&&(L.compiled===void 0&&(L.compiled=m(i)),L.compiled)){L.compiled(v);return}const D=this._createMaskCanvas(i),F=D.canvas;v.save(),v.setTransform(1,0,0,1,0,0),v.drawImage(F,D.offsetX,D.offsetY),v.restore(),this.compose()}paintImageMaskXObjectRepeat(i,r,v=0,L=0,D,F){if(!this.contentVisible)return;i=this.getObject(i.data,i);const Q=this.ctx;Q.save();const vt=(0,k.getCurrentTransform)(Q);Q.transform(r,v,L,D,0,0);const St=this._createMaskCanvas(i);Q.setTransform(1,0,0,1,St.offsetX-vt[4],St.offsetY-vt[5]);for(let wt=0,Tt=F.length;wt<Tt;wt+=2){const Ft=g.Util.transform(vt,[r,v,L,D,F[wt],F[wt+1]]),[Lt,ht]=g.Util.applyTransform([0,0],Ft);Q.drawImage(St.canvas,Lt,ht)}Q.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const r=this.ctx,v=this.current.fillColor,L=this.current.patternFill;for(const D of i){const{data:F,width:Q,height:vt,transform:St}=D,wt=this.cachedCanvases.getCanvas("maskCanvas",Q,vt),Tt=wt.context;Tt.save();const Ft=this.getObject(F,D);C(Tt,Ft),Tt.globalCompositeOperation="source-in",Tt.fillStyle=L?v.getPattern(Tt,this,(0,k.getCurrentTransformInverse)(r),e.PathType.FILL):v,Tt.fillRect(0,0,Q,vt),Tt.restore(),r.save(),r.transform(...St),r.scale(1,-1),y(r,wt.canvas,0,0,Q,vt,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const r=this.getObject(i);if(!r){(0,g.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(r)}paintImageXObjectRepeat(i,r,v,L){if(!this.contentVisible)return;const D=this.getObject(i);if(!D){(0,g.warn)("Dependent image isn't ready yet");return}const F=D.width,Q=D.height,vt=[];for(let St=0,wt=L.length;St<wt;St+=2)vt.push({transform:[r,0,0,v,L[St],L[St+1]],x:0,y:0,w:F,h:Q});this.paintInlineImageXObjectGroup(D,vt)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:r,width:v,height:L}=i,D=this.cachedCanvases.getCanvas("inlineImage",v,L),F=D.context;return F.filter=this.current.transferMaps,F.drawImage(r,0,0),F.filter="none",D.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const r=i.width,v=i.height,L=this.ctx;if(this.save(),!g.isNodeJS){const{filter:Q}=L;Q!=="none"&&Q!==""&&(L.filter="none")}L.scale(1/r,-1/v);let D;if(i.bitmap)D=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)D=i;else{const vt=this.cachedCanvases.getCanvas("inlineImage",r,v).context;H(vt,i),D=this.applyTransferMapsToCanvas(vt)}const F=this._scaleImage(D,(0,k.getCurrentTransformInverse)(L));L.imageSmoothingEnabled=w((0,k.getCurrentTransform)(L),i.interpolate),y(L,F.img,0,0,F.paintWidth,F.paintHeight,0,-v,r,v),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,r){if(!this.contentVisible)return;const v=this.ctx;let L;if(i.bitmap)L=i.bitmap;else{const D=i.width,F=i.height,vt=this.cachedCanvases.getCanvas("inlineImage",D,F).context;H(vt,i),L=this.applyTransferMapsToCanvas(vt)}for(const D of r)v.save(),v.transform(...D.transform),v.scale(1,-1),y(v,L,D.x,D.y,D.w,D.h,0,-1,1,1),v.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,r){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,r){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const v=this.ctx;this.pendingClip&&(r||(this.pendingClip===rt?v.clip("evenodd"):v.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),v.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,k.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const r=Math.abs(i[0]*i[3]-i[2]*i[1]),v=Math.hypot(i[0],i[2]),L=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(v,L)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:r,b:v,c:L,d:D}=this.ctx.getTransform();let F,Q;if(v===0&&L===0){const vt=Math.abs(r),St=Math.abs(D);if(vt===St)if(i===0)F=Q=1/vt;else{const wt=vt*i;F=Q=wt<1?1/wt:1}else if(i===0)F=1/vt,Q=1/St;else{const wt=vt*i,Tt=St*i;F=wt<1?1/wt:1,Q=Tt<1?1/Tt:1}}else{const vt=Math.abs(r*D-v*L),St=Math.hypot(r,v),wt=Math.hypot(L,D);if(i===0)F=wt/vt,Q=St/vt;else{const Tt=i*vt;F=wt>Tt?wt/Tt:1,Q=St>Tt?St/Tt:1}}this._cachedScaleForStroking[0]=F,this._cachedScaleForStroking[1]=Q}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:r}=this,{lineWidth:v}=this.current,[L,D]=this.getScaleForStroking();if(r.lineWidth=v||1,L===1&&D===1){r.stroke();return}const F=r.getLineDash();if(i&&r.save(),r.scale(L,D),F.length>0){const Q=Math.max(L,D);r.setLineDash(F.map(vt=>vt/Q)),r.lineDashOffset/=Q}r.stroke(),i&&r.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};_t=new WeakSet,qi=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Gi=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const r=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=r}}};let X=ct;b.CanvasGraphics=X;for(const T in g.OPS)X.prototype[T]!==void 0&&(X.prototype[g.OPS[T]]=X.prototype[T])},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TilingPattern=b.PathType=void 0,b.getShadingPattern=A;var g=Et(1),k=Et(6);const e={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};b.PathType=e;function it(m,E){if(!E)return;const H=E[2]-E[0],C=E[3]-E[1],a=new Path2D;a.rect(E[0],E[1],H,C),m.clip(a)}class Mt{constructor(){this.constructor===Mt&&(0,g.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,g.unreachable)("Abstract method `getPattern` called.")}}class G extends Mt{constructor(E){super(),this._type=E[1],this._bbox=E[2],this._colorStops=E[3],this._p0=E[4],this._p1=E[5],this._r0=E[6],this._r1=E[7],this.matrix=null}_createGradient(E){let H;this._type==="axial"?H=E.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(H=E.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const C of this._colorStops)H.addColorStop(C[0],C[1]);return H}getPattern(E,H,C,a){let u;if(a===e.STROKE||a===e.FILL){const o=H.current.getClippedPathBoundingBox(a,(0,k.getCurrentTransform)(E))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,B=H.cachedCanvases.getCanvas("pattern",c,h,!0),l=B.context;l.clearRect(0,0,l.canvas.width,l.canvas.height),l.beginPath(),l.rect(0,0,l.canvas.width,l.canvas.height),l.translate(-o[0],-o[1]),C=g.Util.transform(C,[1,0,0,1,o[0],o[1]]),l.transform(...H.baseTransform),this.matrix&&l.transform(...this.matrix),it(l,this._bbox),l.fillStyle=this._createGradient(l),l.fill(),u=E.createPattern(B.canvas,"no-repeat");const w=new DOMMatrix(C);u.setTransform(w)}else it(E,this._bbox),u=this._createGradient(E);return u}}function N(m,E,H,C,a,u,o,c){const h=E.coords,B=E.colors,l=m.data,w=m.width*4;let I;h[H+1]>h[C+1]&&(I=H,H=C,C=I,I=u,u=o,o=I),h[C+1]>h[a+1]&&(I=C,C=a,a=I,I=o,o=c,c=I),h[H+1]>h[C+1]&&(I=H,H=C,C=I,I=u,u=o,o=I);const bt=(h[H]+E.offsetX)*E.scaleX,K=(h[H+1]+E.offsetY)*E.scaleY,rt=(h[C]+E.offsetX)*E.scaleX,X=(h[C+1]+E.offsetY)*E.scaleY,_t=(h[a]+E.offsetX)*E.scaleX,x=(h[a+1]+E.offsetY)*E.scaleY;if(K>=x)return;const $=B[u],ct=B[u+1],T=B[u+2],i=B[o],r=B[o+1],v=B[o+2],L=B[c],D=B[c+1],F=B[c+2],Q=Math.round(K),vt=Math.round(x);let St,wt,Tt,Ft,Lt,ht,dt,S;for(let O=Q;O<=vt;O++){if(O<X){const Rt=O<K?0:(K-O)/(K-X);St=bt-(bt-rt)*Rt,wt=$-($-i)*Rt,Tt=ct-(ct-r)*Rt,Ft=T-(T-v)*Rt}else{let Rt;O>x?Rt=1:X===x?Rt=0:Rt=(X-O)/(X-x),St=rt-(rt-_t)*Rt,wt=i-(i-L)*Rt,Tt=r-(r-D)*Rt,Ft=v-(v-F)*Rt}let nt;O<K?nt=0:O>x?nt=1:nt=(K-O)/(K-x),Lt=bt-(bt-_t)*nt,ht=$-($-L)*nt,dt=ct-(ct-D)*nt,S=T-(T-F)*nt;const ft=Math.round(Math.min(St,Lt)),Ct=Math.round(Math.max(St,Lt));let Dt=w*O+ft*4;for(let Rt=ft;Rt<=Ct;Rt++)nt=(St-Rt)/(St-Lt),nt<0?nt=0:nt>1&&(nt=1),l[Dt++]=wt-(wt-ht)*nt|0,l[Dt++]=Tt-(Tt-dt)*nt|0,l[Dt++]=Ft-(Ft-S)*nt|0,l[Dt++]=255}}function f(m,E,H){const C=E.coords,a=E.colors;let u,o;switch(E.type){case"lattice":const c=E.verticesPerRow,h=Math.floor(C.length/c)-1,B=c-1;for(u=0;u<h;u++){let l=u*c;for(let w=0;w<B;w++,l++)N(m,H,C[l],C[l+1],C[l+c],a[l],a[l+1],a[l+c]),N(m,H,C[l+c+1],C[l+1],C[l+c],a[l+c+1],a[l+1],a[l+c])}break;case"triangles":for(u=0,o=C.length;u<o;u+=3)N(m,H,C[u],C[u+1],C[u+2],a[u],a[u+1],a[u+2]);break;default:throw new Error("illegal figure")}}class z extends Mt{constructor(E){super(),this._coords=E[2],this._colors=E[3],this._figures=E[4],this._bounds=E[5],this._bbox=E[7],this._background=E[8],this.matrix=null}_createMeshCanvas(E,H,C){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),B=Math.ceil(this._bounds[2])-c,l=Math.ceil(this._bounds[3])-h,w=Math.min(Math.ceil(Math.abs(B*E[0]*1.1)),3e3),I=Math.min(Math.ceil(Math.abs(l*E[1]*1.1)),3e3),bt=B/w,K=l/I,rt={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/bt,scaleY:1/K},X=w+2*2,_t=I+2*2,x=C.getCanvas("mesh",X,_t,!1),$=x.context,ct=$.createImageData(w,I);if(H){const i=ct.data;for(let r=0,v=i.length;r<v;r+=4)i[r]=H[0],i[r+1]=H[1],i[r+2]=H[2],i[r+3]=255}for(const i of this._figures)f(ct,i,rt);return $.putImageData(ct,2,2),{canvas:x.canvas,offsetX:c-2*bt,offsetY:h-2*K,scaleX:bt,scaleY:K}}getPattern(E,H,C,a){it(E,this._bbox);let u;if(a===e.SHADING)u=g.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(E));else if(u=g.Util.singularValueDecompose2dScale(H.baseTransform),this.matrix){const c=g.Util.singularValueDecompose2dScale(this.matrix);u=[u[0]*c[0],u[1]*c[1]]}const o=this._createMeshCanvas(u,a===e.SHADING?null:this._background,H.cachedCanvases);return a!==e.SHADING&&(E.setTransform(...H.baseTransform),this.matrix&&E.transform(...this.matrix)),E.translate(o.offsetX,o.offsetY),E.scale(o.scaleX,o.scaleY),E.createPattern(o.canvas,"no-repeat")}}class W extends Mt{getPattern(){return"hotpink"}}function A(m){switch(m[0]){case"RadialAxial":return new G(m);case"Mesh":return new z(m);case"Dummy":return new W}throw new Error(`Unknown IR type: ${m[0]}`)}const _={COLORED:1,UNCOLORED:2},y=class y{constructor(E,H,C,a,u){this.operatorList=E[2],this.matrix=E[3]||[1,0,0,1,0,0],this.bbox=E[4],this.xstep=E[5],this.ystep=E[6],this.paintType=E[7],this.tilingType=E[8],this.color=H,this.ctx=C,this.canvasGraphicsFactory=a,this.baseTransform=u}createPatternCanvas(E){const H=this.operatorList,C=this.bbox,a=this.xstep,u=this.ystep,o=this.paintType,c=this.tilingType,h=this.color,B=this.canvasGraphicsFactory;(0,g.info)("TilingType: "+c);const l=C[0],w=C[1],I=C[2],bt=C[3],K=g.Util.singularValueDecompose2dScale(this.matrix),rt=g.Util.singularValueDecompose2dScale(this.baseTransform),X=[K[0]*rt[0],K[1]*rt[1]],_t=this.getSizeAndScale(a,this.ctx.canvas.width,X[0]),x=this.getSizeAndScale(u,this.ctx.canvas.height,X[1]),$=E.cachedCanvases.getCanvas("pattern",_t.size,x.size,!0),ct=$.context,T=B.createCanvasGraphics(ct);T.groupLevel=E.groupLevel,this.setFillAndStrokeStyleToContext(T,o,h);let i=l,r=w,v=I,L=bt;return l<0&&(i=0,v+=Math.abs(l)),w<0&&(r=0,L+=Math.abs(w)),ct.translate(-(_t.scale*i),-(x.scale*r)),T.transform(_t.scale,0,0,x.scale,0,0),ct.save(),this.clipBbox(T,i,r,v,L),T.baseTransform=(0,k.getCurrentTransform)(T.ctx),T.executeOperatorList(H),T.endDrawing(),{canvas:$.canvas,scaleX:_t.scale,scaleY:x.scale,offsetX:i,offsetY:r}}getSizeAndScale(E,H,C){E=Math.abs(E);const a=Math.max(y.MAX_PATTERN_SIZE,H);let u=Math.ceil(E*C);return u>=a?u=a:C=u/E,{scale:C,size:u}}clipBbox(E,H,C,a,u){const o=a-H,c=u-C;E.ctx.rect(H,C,o,c),E.current.updateRectMinMax((0,k.getCurrentTransform)(E.ctx),[H,C,a,u]),E.clip(),E.endPath()}setFillAndStrokeStyleToContext(E,H,C){const a=E.ctx,u=E.current;switch(H){case _.COLORED:const o=this.ctx;a.fillStyle=o.fillStyle,a.strokeStyle=o.strokeStyle,u.fillColor=o.fillStyle,u.strokeColor=o.strokeStyle;break;case _.UNCOLORED:const c=g.Util.makeHexColor(C[0],C[1],C[2]);a.fillStyle=c,a.strokeStyle=c,u.fillColor=c,u.strokeColor=c;break;default:throw new g.FormatError(`Unsupported paint type: ${H}`)}}getPattern(E,H,C,a){let u=C;a!==e.SHADING&&(u=g.Util.transform(u,H.baseTransform),this.matrix&&(u=g.Util.transform(u,this.matrix)));const o=this.createPatternCanvas(H);let c=new DOMMatrix(u);c=c.translate(o.offsetX,o.offsetY),c=c.scale(1/o.scaleX,1/o.scaleY);const h=E.createPattern(o.canvas,"repeat");return h.setTransform(c),h}};Xe(y,"MAX_PATTERN_SIZE",3e3);let R=y;b.TilingPattern=R},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.convertBlackAndWhiteToRGBA=e,b.convertToRGBA=k,b.grayToRGBA=Mt;var g=Et(1);function k(G){switch(G.kind){case g.ImageKind.GRAYSCALE_1BPP:return e(G);case g.ImageKind.RGB_24BPP:return it(G)}return null}function e({src:G,srcPos:N=0,dest:f,width:z,height:W,nonBlackColor:A=4294967295,inverseDecode:_=!1}){const R=g.FeatureTest.isLittleEndian?4278190080:255,[y,m]=_?[A,R]:[R,A],E=z>>3,H=z&7,C=G.length;f=new Uint32Array(f.buffer);let a=0;for(let u=0;u<W;u++){for(const c=N+E;N<c;N++){const h=N<C?G[N]:255;f[a++]=h&128?m:y,f[a++]=h&64?m:y,f[a++]=h&32?m:y,f[a++]=h&16?m:y,f[a++]=h&8?m:y,f[a++]=h&4?m:y,f[a++]=h&2?m:y,f[a++]=h&1?m:y}if(H===0)continue;const o=N<C?G[N++]:255;for(let c=0;c<H;c++)f[a++]=o&1<<7-c?m:y}return{srcPos:N,destPos:a}}function it({src:G,srcPos:N=0,dest:f,destPos:z=0,width:W,height:A}){let _=0;const R=G.length>>2,y=new Uint32Array(G.buffer,N,R);if(g.FeatureTest.isLittleEndian){for(;_<R-2;_+=3,z+=4){const m=y[_],E=y[_+1],H=y[_+2];f[z]=m|4278190080,f[z+1]=m>>>24|E<<8|4278190080,f[z+2]=E>>>16|H<<16|4278190080,f[z+3]=H>>>8|4278190080}for(let m=_*4,E=G.length;m<E;m+=3)f[z++]=G[m]|G[m+1]<<8|G[m+2]<<16|4278190080}else{for(;_<R-2;_+=3,z+=4){const m=y[_],E=y[_+1],H=y[_+2];f[z]=m|255,f[z+1]=m<<24|E>>>8|255,f[z+2]=E<<16|H>>>16|255,f[z+3]=H<<8|255}for(let m=_*4,E=G.length;m<E;m+=3)f[z++]=G[m]<<24|G[m+1]<<16|G[m+2]<<8|255}return{srcPos:N,destPos:z}}function Mt(G,N){if(g.FeatureTest.isLittleEndian)for(let f=0,z=G.length;f<z;f++)N[f]=G[f]*65793|4278190080;else for(let f=0,z=G.length;f<z;f++)N[f]=G[f]*16843008|255}},(d,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.GlobalWorkerOptions=void 0;const Et=Object.create(null);b.GlobalWorkerOptions=Et,Et.workerPort=null,Et.workerSrc=""},(d,b,Et)=>{var G,Hr,Ur,ci;Object.defineProperty(b,"__esModule",{value:!0}),b.MessageHandler=void 0;var g=Et(1);const k={DATA:1,ERROR:2},e={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function it(W){switch(W instanceof Error||typeof W=="object"&&W!==null||(0,g.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),W.name){case"AbortException":return new g.AbortException(W.message);case"MissingPDFException":return new g.MissingPDFException(W.message);case"PasswordException":return new g.PasswordException(W.message,W.code);case"UnexpectedResponseException":return new g.UnexpectedResponseException(W.message,W.status);case"UnknownErrorException":return new g.UnknownErrorException(W.message,W.details);default:return new g.UnknownErrorException(W.message,W.toString())}}class Mt{constructor(A,_,R){gt(this,G);this.sourceName=A,this.targetName=_,this.comObj=R,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=y=>{const m=y.data;if(m.targetName!==this.sourceName)return;if(m.stream){tt(this,G,Ur).call(this,m);return}if(m.callback){const H=m.callbackId,C=this.callbackCapabilities[H];if(!C)throw new Error(`Cannot resolve callback ${H}`);if(delete this.callbackCapabilities[H],m.callback===k.DATA)C.resolve(m.data);else if(m.callback===k.ERROR)C.reject(it(m.reason));else throw new Error("Unexpected callback case");return}const E=this.actionHandler[m.action];if(!E)throw new Error(`Unknown action from worker: ${m.action}`);if(m.callbackId){const H=this.sourceName,C=m.sourceName;new Promise(function(a){a(E(m.data))}).then(function(a){R.postMessage({sourceName:H,targetName:C,callback:k.DATA,callbackId:m.callbackId,data:a})},function(a){R.postMessage({sourceName:H,targetName:C,callback:k.ERROR,callbackId:m.callbackId,reason:it(a)})});return}if(m.streamId){tt(this,G,Hr).call(this,m);return}E(m.data)},R.addEventListener("message",this._onComObjOnMessage)}on(A,_){const R=this.actionHandler;if(R[A])throw new Error(`There is already an actionName called "${A}"`);R[A]=_}send(A,_,R){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:_},R)}sendWithPromise(A,_,R){const y=this.callbackId++,m=new g.PromiseCapability;this.callbackCapabilities[y]=m;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:y,data:_},R)}catch(E){m.reject(E)}return m.promise}sendWithStream(A,_,R,y){const m=this.streamId++,E=this.sourceName,H=this.targetName,C=this.comObj;return new ReadableStream({start:a=>{const u=new g.PromiseCapability;return this.streamControllers[m]={controller:a,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},C.postMessage({sourceName:E,targetName:H,action:A,streamId:m,data:_,desiredSize:a.desiredSize},y),u.promise},pull:a=>{const u=new g.PromiseCapability;return this.streamControllers[m].pullCall=u,C.postMessage({sourceName:E,targetName:H,stream:e.PULL,streamId:m,desiredSize:a.desiredSize}),u.promise},cancel:a=>{(0,g.assert)(a instanceof Error,"cancel must have a valid reason");const u=new g.PromiseCapability;return this.streamControllers[m].cancelCall=u,this.streamControllers[m].isClosed=!0,C.postMessage({sourceName:E,targetName:H,stream:e.CANCEL,streamId:m,reason:it(a)}),u.promise}},R)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}G=new WeakSet,Hr=function(A){const _=A.streamId,R=this.sourceName,y=A.sourceName,m=this.comObj,E=this,H=this.actionHandler[A.action],C={enqueue(a,u=1,o){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=u,c>0&&this.desiredSize<=0&&(this.sinkCapability=new g.PromiseCapability,this.ready=this.sinkCapability.promise),m.postMessage({sourceName:R,targetName:y,stream:e.ENQUEUE,streamId:_,chunk:a},o)},close(){this.isCancelled||(this.isCancelled=!0,m.postMessage({sourceName:R,targetName:y,stream:e.CLOSE,streamId:_}),delete E.streamSinks[_])},error(a){(0,g.assert)(a instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,m.postMessage({sourceName:R,targetName:y,stream:e.ERROR,streamId:_,reason:it(a)}))},sinkCapability:new g.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};C.sinkCapability.resolve(),C.ready=C.sinkCapability.promise,this.streamSinks[_]=C,new Promise(function(a){a(H(A.data,C))}).then(function(){m.postMessage({sourceName:R,targetName:y,stream:e.START_COMPLETE,streamId:_,success:!0})},function(a){m.postMessage({sourceName:R,targetName:y,stream:e.START_COMPLETE,streamId:_,reason:it(a)})})},Ur=function(A){const _=A.streamId,R=this.sourceName,y=A.sourceName,m=this.comObj,E=this.streamControllers[_],H=this.streamSinks[_];switch(A.stream){case e.START_COMPLETE:A.success?E.startCall.resolve():E.startCall.reject(it(A.reason));break;case e.PULL_COMPLETE:A.success?E.pullCall.resolve():E.pullCall.reject(it(A.reason));break;case e.PULL:if(!H){m.postMessage({sourceName:R,targetName:y,stream:e.PULL_COMPLETE,streamId:_,success:!0});break}H.desiredSize<=0&&A.desiredSize>0&&H.sinkCapability.resolve(),H.desiredSize=A.desiredSize,new Promise(function(C){var a;C((a=H.onPull)==null?void 0:a.call(H))}).then(function(){m.postMessage({sourceName:R,targetName:y,stream:e.PULL_COMPLETE,streamId:_,success:!0})},function(C){m.postMessage({sourceName:R,targetName:y,stream:e.PULL_COMPLETE,streamId:_,reason:it(C)})});break;case e.ENQUEUE:if((0,g.assert)(E,"enqueue should have stream controller"),E.isClosed)break;E.controller.enqueue(A.chunk);break;case e.CLOSE:if((0,g.assert)(E,"close should have stream controller"),E.isClosed)break;E.isClosed=!0,E.controller.close(),tt(this,G,ci).call(this,E,_);break;case e.ERROR:(0,g.assert)(E,"error should have stream controller"),E.controller.error(it(A.reason)),tt(this,G,ci).call(this,E,_);break;case e.CANCEL_COMPLETE:A.success?E.cancelCall.resolve():E.cancelCall.reject(it(A.reason)),tt(this,G,ci).call(this,E,_);break;case e.CANCEL:if(!H)break;new Promise(function(C){var a;C((a=H.onCancel)==null?void 0:a.call(H,it(A.reason)))}).then(function(){m.postMessage({sourceName:R,targetName:y,stream:e.CANCEL_COMPLETE,streamId:_,success:!0})},function(C){m.postMessage({sourceName:R,targetName:y,stream:e.CANCEL_COMPLETE,streamId:_,reason:it(C)})}),H.sinkCapability.reject(it(A.reason)),H.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}},ci=async function(A,_){var R,y,m;await Promise.allSettled([(R=A.startCall)==null?void 0:R.promise,(y=A.pullCall)==null?void 0:y.promise,(m=A.cancelCall)==null?void 0:m.promise]),delete this.streamControllers[_]},b.MessageHandler=Mt},(d,b,Et)=>{var e,it;Object.defineProperty(b,"__esModule",{value:!0}),b.Metadata=void 0;var g=Et(1);class k{constructor({parsedData:G,rawData:N}){gt(this,e);gt(this,it);mt(this,e,G),mt(this,it,N)}getRaw(){return t(this,it)}get(G){return t(this,e).get(G)??null}getAll(){return(0,g.objectFromMap)(t(this,e))}has(G){return t(this,e).has(G)}}e=new WeakMap,it=new WeakMap,b.Metadata=k},(d,b,Et)=>{var G,N,f,z,W,A,Xi;Object.defineProperty(b,"__esModule",{value:!0}),b.OptionalContentConfig=void 0;var g=Et(1),k=Et(8);const e=Symbol("INTERNAL");class it{constructor(y,m){gt(this,G,!0);this.name=y,this.intent=m}get visible(){return t(this,G)}_setVisible(y,m){y!==e&&(0,g.unreachable)("Internal method `_setVisible` called."),mt(this,G,m)}}G=new WeakMap;class Mt{constructor(y){gt(this,A);gt(this,N,null);gt(this,f,new Map);gt(this,z,null);gt(this,W,null);if(this.name=null,this.creator=null,y!==null){this.name=y.name,this.creator=y.creator,mt(this,W,y.order);for(const m of y.groups)t(this,f).set(m.id,new it(m.name,m.intent));if(y.baseState==="OFF")for(const m of t(this,f).values())m._setVisible(e,!1);for(const m of y.on)t(this,f).get(m)._setVisible(e,!0);for(const m of y.off)t(this,f).get(m)._setVisible(e,!1);mt(this,z,this.getHash())}}isVisible(y){if(t(this,f).size===0)return!0;if(!y)return(0,g.warn)("Optional content group not defined."),!0;if(y.type==="OCG")return t(this,f).has(y.id)?t(this,f).get(y.id).visible:((0,g.warn)(`Optional content group not found: ${y.id}`),!0);if(y.type==="OCMD"){if(y.expression)return tt(this,A,Xi).call(this,y.expression);if(!y.policy||y.policy==="AnyOn"){for(const m of y.ids){if(!t(this,f).has(m))return(0,g.warn)(`Optional content group not found: ${m}`),!0;if(t(this,f).get(m).visible)return!0}return!1}else if(y.policy==="AllOn"){for(const m of y.ids){if(!t(this,f).has(m))return(0,g.warn)(`Optional content group not found: ${m}`),!0;if(!t(this,f).get(m).visible)return!1}return!0}else if(y.policy==="AnyOff"){for(const m of y.ids){if(!t(this,f).has(m))return(0,g.warn)(`Optional content group not found: ${m}`),!0;if(!t(this,f).get(m).visible)return!0}return!1}else if(y.policy==="AllOff"){for(const m of y.ids){if(!t(this,f).has(m))return(0,g.warn)(`Optional content group not found: ${m}`),!0;if(t(this,f).get(m).visible)return!1}return!0}return(0,g.warn)(`Unknown optional content policy ${y.policy}.`),!0}return(0,g.warn)(`Unknown group type ${y.type}.`),!0}setVisibility(y,m=!0){if(!t(this,f).has(y)){(0,g.warn)(`Optional content group not found: ${y}`);return}t(this,f).get(y)._setVisible(e,!!m),mt(this,N,null)}get hasInitialVisibility(){return t(this,z)===null||this.getHash()===t(this,z)}getOrder(){return t(this,f).size?t(this,W)?t(this,W).slice():[...t(this,f).keys()]:null}getGroups(){return t(this,f).size>0?(0,g.objectFromMap)(t(this,f)):null}getGroup(y){return t(this,f).get(y)||null}getHash(){if(t(this,N)!==null)return t(this,N);const y=new k.MurmurHash3_64;for(const[m,E]of t(this,f))y.update(`${m}:${E.visible}`);return mt(this,N,y.hexdigest())}}N=new WeakMap,f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakSet,Xi=function(y){const m=y.length;if(m<2)return!0;const E=y[0];for(let H=1;H<m;H++){const C=y[H];let a;if(Array.isArray(C))a=tt(this,A,Xi).call(this,C);else if(t(this,f).has(C))a=t(this,f).get(C).visible;else return(0,g.warn)(`Optional content group not found: ${C}`),!0;switch(E){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return E==="And"},b.OptionalContentConfig=Mt},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFDataTransportStream=void 0;var g=Et(1),k=Et(6);class e{constructor({length:N,initialData:f,progressiveDone:z=!1,contentDispositionFilename:W=null,disableRange:A=!1,disableStream:_=!1},R){if((0,g.assert)(R,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=z,this._contentDispositionFilename=W,(f==null?void 0:f.length)>0){const y=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;this._queuedChunks.push(y)}this._pdfDataRangeTransport=R,this._isStreamingSupported=!_,this._isRangeSupported=!A,this._contentLength=N,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((y,m)=>{this._onReceiveData({begin:y,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((y,m)=>{this._onProgress({loaded:y,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(y=>{this._onReceiveData({chunk:y})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:N,chunk:f}){const z=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(N===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(z):this._queuedChunks.push(z);else{const W=this._rangeReaders.some(function(A){return A._begin!==N?!1:(A._enqueue(z),!0)});(0,g.assert)(W,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}_onProgress(N){var f,z,W,A;N.total===void 0?(z=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||z.call(f,{loaded:N.loaded}):(A=(W=this._fullRequestReader)==null?void 0:W.onProgress)==null||A.call(W,{loaded:N.loaded,total:N.total})}_onProgressiveDone(){var N;(N=this._fullRequestReader)==null||N.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(N){const f=this._rangeReaders.indexOf(N);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,g.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const N=this._queuedChunks;return this._queuedChunks=null,new it(this,N,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(N,f){if(f<=this._progressiveDataLength)return null;const z=new Mt(this,N,f);return this._pdfDataRangeTransport.requestDataRange(N,f),this._rangeReaders.push(z),z}cancelAllRequests(N){var f;(f=this._fullRequestReader)==null||f.cancel(N);for(const z of this._rangeReaders.slice(0))z.cancel(N);this._pdfDataRangeTransport.abort()}}b.PDFDataTransportStream=e;class it{constructor(N,f,z=!1,W=null){this._stream=N,this._done=z||!1,this._filename=(0,k.isPdfFile)(W)?W:null,this._queuedChunks=f||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),N._fullRequestReader=this,this.onProgress=null}_enqueue(N){this._done||(this._requests.length>0?this._requests.shift().resolve({value:N,done:!1}):this._queuedChunks.push(N),this._loaded+=N.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const N=new g.PromiseCapability;return this._requests.push(N),N.promise}cancel(N){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Mt{constructor(N,f,z){this._stream=N,this._begin=f,this._end=z,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(N){if(!this._done){if(this._requests.length===0)this._queuedChunk=N;else{this._requests.shift().resolve({value:N,done:!1});for(const z of this._requests)z.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const N=new g.PromiseCapability;return this._requests.push(N),N.promise}cancel(N){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFFetchStream=void 0;var g=Et(1),k=Et(20);function e(z,W,A){return{method:"GET",headers:z,signal:A.signal,mode:"cors",credentials:W?"include":"same-origin",redirect:"follow"}}function it(z){const W=new Headers;for(const A in z){const _=z[A];_!==void 0&&W.append(A,_)}return W}function Mt(z){return z instanceof Uint8Array?z.buffer:z instanceof ArrayBuffer?z:((0,g.warn)(`getArrayBuffer - unexpected data format: ${z}`),new Uint8Array(z).buffer)}class G{constructor(W){this.source=W,this.isHttp=/^https?:/i.test(W.url),this.httpHeaders=this.isHttp&&W.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var W;return((W=this._fullRequestReader)==null?void 0:W._loaded)??0}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new N(this),this._fullRequestReader}getRangeReader(W,A){if(A<=this._progressiveDataLength)return null;const _=new f(this,W,A);return this._rangeRequestReaders.push(_),_}cancelAllRequests(W){var A;(A=this._fullRequestReader)==null||A.cancel(W);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(W)}}b.PDFFetchStream=G;class N{constructor(W){this._stream=W,this._reader=null,this._loaded=0,this._filename=null;const A=W.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=new g.PromiseCapability,this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=it(this._stream.httpHeaders);const _=A.url;fetch(_,e(this._headers,this._withCredentials,this._abortController)).then(R=>{if(!(0,k.validateResponseStatus)(R.status))throw(0,k.createResponseStatusError)(R.status,_);this._reader=R.body.getReader(),this._headersCapability.resolve();const y=H=>R.headers.get(H),{allowRangeRequests:m,suggestedLength:E}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=E||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(y),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new g.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._headersCapability.promise;const{value:W,done:A}=await this._reader.read();return A?{value:W,done:A}:(this._loaded+=W.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Mt(W),done:!1})}cancel(W){var A;(A=this._reader)==null||A.cancel(W),this._abortController.abort()}}class f{constructor(W,A,_){this._stream=W,this._reader=null,this._loaded=0;const R=W.source;this._withCredentials=R.withCredentials||!1,this._readCapability=new g.PromiseCapability,this._isStreamingSupported=!R.disableStream,this._abortController=new AbortController,this._headers=it(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${_-1}`);const y=R.url;fetch(y,e(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,k.validateResponseStatus)(m.status))throw(0,k.createResponseStatusError)(m.status,y);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._readCapability.promise;const{value:W,done:A}=await this._reader.read();return A?{value:W,done:A}:(this._loaded+=W.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:Mt(W),done:!1})}cancel(W){var A;(A=this._reader)==null||A.cancel(W),this._abortController.abort()}}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createResponseStatusError=G,b.extractFilenameFromHeader=Mt,b.validateRangeRequestCapabilities=it,b.validateResponseStatus=N;var g=Et(1),k=Et(21),e=Et(6);function it({getResponseHeader:f,isHttp:z,rangeChunkSize:W,disableRange:A}){const _={allowRangeRequests:!1,suggestedLength:void 0},R=parseInt(f("Content-Length"),10);return!Number.isInteger(R)||(_.suggestedLength=R,R<=2*W)||A||!z||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(_.allowRangeRequests=!0),_}function Mt(f){const z=f("Content-Disposition");if(z){let W=(0,k.getFilenameFromContentDispositionHeader)(z);if(W.includes("%"))try{W=decodeURIComponent(W)}catch{}if((0,e.isPdfFile)(W))return W}return null}function G(f,z){return f===404||f===0&&z.startsWith("file:")?new g.MissingPDFException('Missing PDF "'+z+'".'):new g.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${z}".`,f)}function N(f){return f===200||f===206}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.getFilenameFromContentDispositionHeader=k;var g=Et(1);function k(e){let it=!0,Mt=G("filename\\*","i").exec(e);if(Mt){Mt=Mt[1];let R=W(Mt);return R=unescape(R),R=A(R),R=_(R),f(R)}if(Mt=z(e),Mt){const R=_(Mt);return f(R)}if(Mt=G("filename","i").exec(e),Mt){Mt=Mt[1];let R=W(Mt);return R=_(R),f(R)}function G(R,y){return new RegExp("(?:^|;)\\s*"+R+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function N(R,y){if(R){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const m=new TextDecoder(R,{fatal:!0}),E=(0,g.stringToBytes)(y);y=m.decode(E),it=!1}catch{}}return y}function f(R){return it&&/[\x80-\xff]/.test(R)&&(R=N("utf-8",R),it&&(R=N("iso-8859-1",R))),R}function z(R){const y=[];let m;const E=G("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=E.exec(R))!==null;){let[,C,a,u]=m;if(C=parseInt(C,10),C in y){if(C===0)break;continue}y[C]=[a,u]}const H=[];for(let C=0;C<y.length&&C in y;++C){let[a,u]=y[C];u=W(u),a&&(u=unescape(u),C===0&&(u=A(u))),H.push(u)}return H.join("")}function W(R){if(R.startsWith('"')){const y=R.slice(1).split('\\"');for(let m=0;m<y.length;++m){const E=y[m].indexOf('"');E!==-1&&(y[m]=y[m].slice(0,E),y.length=m+1),y[m]=y[m].replaceAll(/\\(.)/g,"$1")}R=y.join('"')}return R}function A(R){const y=R.indexOf("'");if(y===-1)return R;const m=R.slice(0,y),H=R.slice(y+1).replace(/^[^']*'/,"");return N(m,H)}function _(R){return!R.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(R)?R:R.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,m,E,H){if(E==="q"||E==="Q")return H=H.replaceAll("_"," "),H=H.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,a){return String.fromCharCode(parseInt(a,16))}),N(m,H);try{H=atob(H)}catch{}return N(m,H)})}return""}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFNetworkStream=void 0;var g=Et(1),k=Et(20);const e=200,it=206;function Mt(W){const A=W.response;return typeof A!="string"?A:(0,g.stringToBytes)(A).buffer}class G{constructor(A,_={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&_.httpHeaders||Object.create(null),this.withCredentials=_.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,_,R){const y={begin:A,end:_};for(const m in R)y[m]=R[m];return this.request(y)}requestFull(A){return this.request(A)}request(A){const _=new XMLHttpRequest,R=this.currXhrId++,y=this.pendingRequests[R]={xhr:_};_.open("GET",this.url),_.withCredentials=this.withCredentials;for(const m in this.httpHeaders){const E=this.httpHeaders[m];E!==void 0&&_.setRequestHeader(m,E)}return this.isHttp&&"begin"in A&&"end"in A?(_.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),y.expectedStatus=it):y.expectedStatus=e,_.responseType="arraybuffer",A.onError&&(_.onerror=function(m){A.onError(_.status)}),_.onreadystatechange=this.onStateChange.bind(this,R),_.onprogress=this.onProgress.bind(this,R),y.onHeadersReceived=A.onHeadersReceived,y.onDone=A.onDone,y.onError=A.onError,y.onProgress=A.onProgress,_.send(null),R}onProgress(A,_){var y;const R=this.pendingRequests[A];R&&((y=R.onProgress)==null||y.call(R,_))}onStateChange(A,_){var C,a,u;const R=this.pendingRequests[A];if(!R)return;const y=R.xhr;if(y.readyState>=2&&R.onHeadersReceived&&(R.onHeadersReceived(),delete R.onHeadersReceived),y.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],y.status===0&&this.isHttp){(C=R.onError)==null||C.call(R,y.status);return}const m=y.status||e;if(!(m===e&&R.expectedStatus===it)&&m!==R.expectedStatus){(a=R.onError)==null||a.call(R,y.status);return}const H=Mt(y);if(m===it){const o=y.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);R.onDone({begin:parseInt(c[1],10),chunk:H})}else H?R.onDone({begin:0,chunk:H}):(u=R.onError)==null||u.call(R,y.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const _=this.pendingRequests[A].xhr;delete this.pendingRequests[A],_.abort()}}class N{constructor(A){this._source=A,this._manager=new G(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const _=this._rangeRequestReaders.indexOf(A);_>=0&&this._rangeRequestReaders.splice(_,1)}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(A,_){const R=new z(this._manager,A,_);return R.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(R),R}cancelAllRequests(A){var _;(_=this._fullRequestReader)==null||_.cancel(A);for(const R of this._rangeRequestReaders.slice(0))R.cancel(A)}}b.PDFNetworkStream=N;class f{constructor(A,_){this._manager=A;const R={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._fullRequestId=A.requestFull(R),this._headersReceivedCapability=new g.PromiseCapability,this._disableRange=_.disableRange||!1,this._contentLength=_.length,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,_=this._manager.getRequestXhr(A),R=E=>_.getResponseHeader(E),{allowRangeRequests:y,suggestedLength:m}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:R,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});y&&(this._isRangeSupported=!0),this._contentLength=m||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(R),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,k.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var _;(_=this.onProgress)==null||_.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=new g.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class z{constructor(A,_,R){this._manager=A;const y={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(_,R,y),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const _=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunk=_,this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,k.createResponseStatusError)(A,this._url);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var _;this.isStreamingSupported||(_=this.onProgress)==null||_.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const A=new g.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PDFNodeStream=void 0;var g=Et(1),k=Et(20);const e=/^file:\/\/\/[a-zA-Z]:\//;function it(R){const y=require$$5,m=y.parse(R);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(R)?y.parse(`file:///${R}`):(m.host||(m.protocol="file:"),m)}class Mt{constructor(y){this.source=y,this.url=it(y.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new z(this),this._fullRequestReader}getRangeReader(y,m){if(m<=this._progressiveDataLength)return null;const E=this.isFsUrl?new _(this,y,m):new W(this,y,m);return this._rangeRequestReaders.push(E),E}cancelAllRequests(y){var m;(m=this._fullRequestReader)==null||m.cancel(y);for(const E of this._rangeRequestReaders.slice(0))E.cancel(y)}}b.PDFNodeStream=Mt;class G{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null;const m=y.source;this._contentLength=m.length,this._loaded=0,this._filename=null,this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._readableStream=null,this._readCapability=new g.PromiseCapability,this._headersCapability=new g.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=new g.PromiseCapability,this.read()):(this._loaded+=y.length,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",m=>{this._error(m)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new g.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class N{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new g.PromiseCapability;const m=y.source;this._isStreamingSupported=!m.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=new g.PromiseCapability,this.read()):(this._loaded+=y.length,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",m=>{this._error(m)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(R,y){return{protocol:R.protocol,auth:R.auth,host:R.hostname,port:R.port,path:R.path,method:"GET",headers:y}}class z extends G{constructor(y){super(y);const m=E=>{if(E.statusCode===404){const u=new g.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(E);const H=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:C,suggestedLength:a}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:H,isHttp:y.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=C,this._contentLength=a||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(H)};if(this._request=null,this._url.protocol==="http:"){const E=require$$5;this._request=E.request(f(this._url,y.httpHeaders),m)}else{const E=require$$5;this._request=E.request(f(this._url,y.httpHeaders),m)}this._request.on("error",E=>{this._storedError=E,this._headersCapability.reject(E)}),this._request.end()}}class W extends N{constructor(y,m,E){super(y),this._httpHeaders={};for(const C in y.httpHeaders){const a=y.httpHeaders[C];a!==void 0&&(this._httpHeaders[C]=a)}this._httpHeaders.Range=`bytes=${m}-${E-1}`;const H=C=>{if(C.statusCode===404){const a=new g.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(C)};if(this._request=null,this._url.protocol==="http:"){const C=require$$5;this._request=C.request(f(this._url,this._httpHeaders),H)}else{const C=require$$5;this._request=C.request(f(this._url,this._httpHeaders),H)}this._request.on("error",C=>{this._storedError=C}),this._request.end()}}class A extends G{constructor(y){super(y);let m=decodeURIComponent(this._url.path);e.test(this._url.href)&&(m=m.replace(/^\//,""));const E=require$$5;E.lstat(m,(H,C)=>{if(H){H.code==="ENOENT"&&(H=new g.MissingPDFException(`Missing PDF "${m}".`)),this._storedError=H,this._headersCapability.reject(H);return}this._contentLength=C.size,this._setReadableStream(E.createReadStream(m)),this._headersCapability.resolve()})}}class _ extends N{constructor(y,m,E){super(y);let H=decodeURIComponent(this._url.path);e.test(this._url.href)&&(H=H.replace(/^\//,""));const C=require$$5;this._setReadableStream(C.createReadStream(H,{start:m,end:E-1}))}}},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SVGGraphics=void 0;var g=Et(6),k=Et(1);const e={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},it="http://www.w3.org/XML/1998/namespace",Mt="http://www.w3.org/1999/xlink",G=["butt","round","square"],N=["miter","round","bevel"],f=function(C,a="",u=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!u)return URL.createObjectURL(new Blob([C],{type:a}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${a};base64,`;for(let h=0,B=C.length;h<B;h+=3){const l=C[h]&255,w=C[h+1]&255,I=C[h+2]&255,bt=l>>2,K=(l&3)<<4|w>>4,rt=h+1<B?(w&15)<<2|I>>6:64,X=h+2<B?I&63:64;c+=o[bt]+o[K]+o[rt]+o[X]}return c},z=function(){const C=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,u=new Int32Array(256);for(let I=0;I<256;I++){let bt=I;for(let K=0;K<8;K++)bt=bt&1?3988292384^bt>>1&2147483647:bt>>1&2147483647;u[I]=bt}function o(I,bt,K){let rt=-1;for(let X=bt;X<K;X++){const _t=(rt^I[X])&255,x=u[_t];rt=rt>>>8^x}return rt^-1}function c(I,bt,K,rt){let X=rt;const _t=bt.length;K[X]=_t>>24&255,K[X+1]=_t>>16&255,K[X+2]=_t>>8&255,K[X+3]=_t&255,X+=4,K[X]=I.charCodeAt(0)&255,K[X+1]=I.charCodeAt(1)&255,K[X+2]=I.charCodeAt(2)&255,K[X+3]=I.charCodeAt(3)&255,X+=4,K.set(bt,X),X+=bt.length;const x=o(K,rt+4,X);K[X]=x>>24&255,K[X+1]=x>>16&255,K[X+2]=x>>8&255,K[X+3]=x&255}function h(I,bt,K){let rt=1,X=0;for(let _t=bt;_t<K;++_t)rt=(rt+(I[_t]&255))%65521,X=(X+rt)%65521;return X<<16|rt}function B(I){if(!k.isNodeJS)return l(I);try{const bt=parseInt(process.versions.node)>=8?I:Buffer.from(I),K=require$$5.deflateSync(bt,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(bt){(0,k.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+bt)}return l(I)}function l(I){let bt=I.length;const K=65535,rt=Math.ceil(bt/K),X=new Uint8Array(2+bt+rt*5+4);let _t=0;X[_t++]=120,X[_t++]=156;let x=0;for(;bt>K;)X[_t++]=0,X[_t++]=255,X[_t++]=255,X[_t++]=0,X[_t++]=0,X.set(I.subarray(x,x+K),_t),_t+=K,x+=K,bt-=K;X[_t++]=1,X[_t++]=bt&255,X[_t++]=bt>>8&255,X[_t++]=~bt&65535&255,X[_t++]=(~bt&65535)>>8&255,X.set(I.subarray(x),_t),_t+=I.length-x;const $=h(I,0,I.length);return X[_t++]=$>>24&255,X[_t++]=$>>16&255,X[_t++]=$>>8&255,X[_t++]=$&255,X}function w(I,bt,K,rt){const X=I.width,_t=I.height;let x,$,ct;const T=I.data;switch(bt){case k.ImageKind.GRAYSCALE_1BPP:$=0,x=1,ct=X+7>>3;break;case k.ImageKind.RGB_24BPP:$=2,x=8,ct=X*3;break;case k.ImageKind.RGBA_32BPP:$=6,x=8,ct=X*4;break;default:throw new Error("invalid format")}const i=new Uint8Array((1+ct)*_t);let r=0,v=0;for(let St=0;St<_t;++St)i[r++]=0,i.set(T.subarray(v,v+ct),r),v+=ct,r+=ct;if(bt===k.ImageKind.GRAYSCALE_1BPP&&rt){r=0;for(let St=0;St<_t;St++){r++;for(let wt=0;wt<ct;wt++)i[r++]^=255}}const L=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,X&255,_t>>24&255,_t>>16&255,_t>>8&255,_t&255,x,$,0,0,0]),D=B(i),F=C.length+a*3+L.length+D.length,Q=new Uint8Array(F);let vt=0;return Q.set(C,vt),vt+=C.length,c("IHDR",L,Q,vt),vt+=a+L.length,c("IDATA",D,Q,vt),vt+=a+D.length,c("IEND",new Uint8Array(0),Q,vt),f(Q,"image/png",K)}return function(bt,K,rt){const X=bt.kind===void 0?k.ImageKind.GRAYSCALE_1BPP:bt.kind;return w(bt,X,K,rt)}}();class W{constructor(){this.fontSizeScale=1,this.fontWeight=e.fontWeight,this.fontSize=0,this.textMatrix=k.IDENTITY_MATRIX,this.fontMatrix=k.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=k.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=e.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,u){this.x=a,this.y=u}}function A(C){let a=[];const u=[];for(const o of C){if(o.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),u.push(a),a=a.at(-1).items;continue}o.fn==="restore"?a=u.pop():a.push(o)}return a}function _(C){if(Number.isInteger(C))return C.toString();const a=C.toFixed(10);let u=a.length-1;if(a[u]!=="0")return a;do u--;while(a[u]==="0");return a.substring(0,a[u]==="."?u:u+1)}function R(C){if(C[4]===0&&C[5]===0){if(C[1]===0&&C[2]===0)return C[0]===1&&C[3]===1?"":`scale(${_(C[0])} ${_(C[3])})`;if(C[0]===C[3]&&C[1]===-C[2]){const a=Math.acos(C[0])*180/Math.PI;return`rotate(${_(a)})`}}else if(C[0]===1&&C[1]===0&&C[2]===0&&C[3]===1)return`translate(${_(C[4])} ${_(C[5])})`;return`matrix(${_(C[0])} ${_(C[1])} ${_(C[2])} ${_(C[3])} ${_(C[4])} ${_(C[5])})`}let y=0,m=0,E=0;class H{constructor(a,u,o=!1){(0,g.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new g.DOMSVGFactory,this.current=new W,this.transformMatrix=k.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=u,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const c in k.OPS)this._operatorIdMapping[k.OPS[c]]=c}getObject(a,u=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):u}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const u=a.fnArray,o=a.argsArray;for(let c=0,h=u.length;c<h;c++)if(u[c]===k.OPS.dependency)for(const B of o[c]){const l=B.startsWith("g_")?this.commonObjs:this.objs,w=new Promise(I=>{l.get(B,I)});this.current.dependencies.push(w)}return Promise.all(this.current.dependencies)}transform(a,u,o,c,h,B){const l=[a,u,o,c,h,B];this.transformMatrix=k.Util.transform(this.transformMatrix,l),this.tgrp=null}getSVG(a,u){this.viewport=u;const o=this._initialize(u);return this.loadDependencies(a).then(()=>(this.transformMatrix=k.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),o))}convertOpList(a){const u=this._operatorIdMapping,o=a.argsArray,c=a.fnArray,h=[];for(let B=0,l=c.length;B<l;B++){const w=c[B];h.push({fnId:w,fn:u[w],args:o[B]})}return A(h)}executeOpTree(a){for(const u of a){const o=u.fn,c=u.fnId,h=u.args;switch(c|0){case k.OPS.beginText:this.beginText();break;case k.OPS.dependency:break;case k.OPS.setLeading:this.setLeading(h);break;case k.OPS.setLeadingMoveText:this.setLeadingMoveText(h[0],h[1]);break;case k.OPS.setFont:this.setFont(h);break;case k.OPS.showText:this.showText(h[0]);break;case k.OPS.showSpacedText:this.showText(h[0]);break;case k.OPS.endText:this.endText();break;case k.OPS.moveText:this.moveText(h[0],h[1]);break;case k.OPS.setCharSpacing:this.setCharSpacing(h[0]);break;case k.OPS.setWordSpacing:this.setWordSpacing(h[0]);break;case k.OPS.setHScale:this.setHScale(h[0]);break;case k.OPS.setTextMatrix:this.setTextMatrix(h[0],h[1],h[2],h[3],h[4],h[5]);break;case k.OPS.setTextRise:this.setTextRise(h[0]);break;case k.OPS.setTextRenderingMode:this.setTextRenderingMode(h[0]);break;case k.OPS.setLineWidth:this.setLineWidth(h[0]);break;case k.OPS.setLineJoin:this.setLineJoin(h[0]);break;case k.OPS.setLineCap:this.setLineCap(h[0]);break;case k.OPS.setMiterLimit:this.setMiterLimit(h[0]);break;case k.OPS.setFillRGBColor:this.setFillRGBColor(h[0],h[1],h[2]);break;case k.OPS.setStrokeRGBColor:this.setStrokeRGBColor(h[0],h[1],h[2]);break;case k.OPS.setStrokeColorN:this.setStrokeColorN(h);break;case k.OPS.setFillColorN:this.setFillColorN(h);break;case k.OPS.shadingFill:this.shadingFill(h[0]);break;case k.OPS.setDash:this.setDash(h[0],h[1]);break;case k.OPS.setRenderingIntent:this.setRenderingIntent(h[0]);break;case k.OPS.setFlatness:this.setFlatness(h[0]);break;case k.OPS.setGState:this.setGState(h[0]);break;case k.OPS.fill:this.fill();break;case k.OPS.eoFill:this.eoFill();break;case k.OPS.stroke:this.stroke();break;case k.OPS.fillStroke:this.fillStroke();break;case k.OPS.eoFillStroke:this.eoFillStroke();break;case k.OPS.clip:this.clip("nonzero");break;case k.OPS.eoClip:this.clip("evenodd");break;case k.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case k.OPS.paintImageXObject:this.paintImageXObject(h[0]);break;case k.OPS.paintInlineImageXObject:this.paintInlineImageXObject(h[0]);break;case k.OPS.paintImageMaskXObject:this.paintImageMaskXObject(h[0]);break;case k.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(h[0],h[1]);break;case k.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case k.OPS.closePath:this.closePath();break;case k.OPS.closeStroke:this.closeStroke();break;case k.OPS.closeFillStroke:this.closeFillStroke();break;case k.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case k.OPS.nextLine:this.nextLine();break;case k.OPS.transform:this.transform(h[0],h[1],h[2],h[3],h[4],h[5]);break;case k.OPS.constructPath:this.constructPath(h[0],h[1]);break;case k.OPS.endPath:this.endPath();break;case 92:this.group(u.items);break;default:(0,k.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,u,o,c,h,B){const l=this.current;l.textMatrix=l.lineMatrix=[a,u,o,c,h,B],l.textMatrixScale=Math.hypot(a,u),l.x=l.lineX=0,l.y=l.lineY=0,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${_(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",_(-l.y)),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtElement.append(l.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=k.IDENTITY_MATRIX,a.lineMatrix=k.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,u){const o=this.current;o.x=o.lineX+=a,o.y=o.lineY+=u,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${_(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",_(-o.y))}showText(a){const u=this.current,o=u.font,c=u.fontSize;if(c===0)return;const h=u.fontSizeScale,B=u.charSpacing,l=u.wordSpacing,w=u.fontDirection,I=u.textHScale*w,bt=o.vertical,K=bt?1:-1,rt=o.defaultVMetrics,X=c*u.fontMatrix[0];let _t=0;for(const ct of a){if(ct===null){_t+=w*l;continue}else if(typeof ct=="number"){_t+=K*ct*c/1e3;continue}const T=(ct.isSpace?l:0)+B,i=ct.fontChar;let r,v,L=ct.width;if(bt){let F;const Q=ct.vmetric||rt;F=ct.vmetric?Q[1]:L*.5,F=-F*X;const vt=Q[2]*X;L=Q?-Q[0]:L,r=F/h,v=(_t+vt)/h}else r=_t/h,v=0;(ct.isInFont||o.missingFile)&&(u.xcoords.push(u.x+r),bt&&u.ycoords.push(-u.y+v),u.tspan.textContent+=i);const D=bt?L*X-T*w:L*X+T*w;_t+=D}u.tspan.setAttributeNS(null,"x",u.xcoords.map(_).join(" ")),bt?u.tspan.setAttributeNS(null,"y",u.ycoords.map(_).join(" ")):u.tspan.setAttributeNS(null,"y",_(-u.y)),bt?u.y-=_t:u.x+=_t*I,u.tspan.setAttributeNS(null,"font-family",u.fontFamily),u.tspan.setAttributeNS(null,"font-size",`${_(u.fontSize)}px`),u.fontStyle!==e.fontStyle&&u.tspan.setAttributeNS(null,"font-style",u.fontStyle),u.fontWeight!==e.fontWeight&&u.tspan.setAttributeNS(null,"font-weight",u.fontWeight);const x=u.textRenderingMode&k.TextRenderingMode.FILL_STROKE_MASK;if(x===k.TextRenderingMode.FILL||x===k.TextRenderingMode.FILL_STROKE?(u.fillColor!==e.fillColor&&u.tspan.setAttributeNS(null,"fill",u.fillColor),u.fillAlpha<1&&u.tspan.setAttributeNS(null,"fill-opacity",u.fillAlpha)):u.textRenderingMode===k.TextRenderingMode.ADD_TO_PATH?u.tspan.setAttributeNS(null,"fill","transparent"):u.tspan.setAttributeNS(null,"fill","none"),x===k.TextRenderingMode.STROKE||x===k.TextRenderingMode.FILL_STROKE){const ct=1/(u.textMatrixScale||1);this._setStrokeAttributes(u.tspan,ct)}let $=u.textMatrix;u.textRise!==0&&($=$.slice(),$[5]+=u.textRise),u.txtElement.setAttributeNS(null,"transform",`${R($)} scale(${_(I)}, -1)`),u.txtElement.setAttributeNS(it,"xml:space","preserve"),u.txtElement.append(u.tspan),u.txtgrp.append(u.txtElement),this._ensureTransformGroup().append(u.txtElement)}setLeadingMoveText(a,u){this.setLeading(-u),this.moveText(a,u)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const u=f(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${u}); }
`}setFont(a){const u=this.current,o=this.commonObjs.get(a[0]);let c=a[1];u.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),u.fontMatrix=o.fontMatrix||k.FONT_IDENTITY_MATRIX;let h="normal";o.black?h="900":o.bold&&(h="bold");const B=o.italic?"italic":"normal";c<0?(c=-c,u.fontDirection=-1):u.fontDirection=1,u.fontSize=c,u.fontFamily=o.loadedName,u.fontWeight=h,u.fontStyle=B,u.tspan=this.svgFactory.createElement("svg:tspan"),u.tspan.setAttributeNS(null,"y",_(-u.y)),u.xcoords=[],u.ycoords=[]}endText(){var u;const a=this.current;a.textRenderingMode&k.TextRenderingMode.ADD_TO_PATH_FLAG&&((u=a.txtElement)!=null&&u.hasChildNodes())&&(a.element=a.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=G[a]}setLineJoin(a){this.current.lineJoin=N[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,u,o){this.current.strokeColor=k.Util.makeHexColor(a,u,o)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,u,o){this.current.fillColor=k.Util.makeHexColor(a,u,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const{width:u,height:o}=this.viewport,c=k.Util.inverseTransform(this.transformMatrix),[h,B,l,w]=k.Util.getAxialAlignedBoundingBox([0,0,u,o],c),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",h),I.setAttributeNS(null,"y",B),I.setAttributeNS(null,"width",l-h),I.setAttributeNS(null,"height",w-B),I.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&I.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(I)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const u=a[1],o=a[2],c=a[3]||k.IDENTITY_MATRIX,[h,B,l,w]=a[4],I=a[5],bt=a[6],K=a[7],rt=`shading${E++}`,[X,_t,x,$]=k.Util.normalizeRect([...k.Util.applyTransform([h,B],c),...k.Util.applyTransform([l,w],c)]),[ct,T]=k.Util.singularValueDecompose2dScale(c),i=I*ct,r=bt*T,v=this.svgFactory.createElement("svg:pattern");v.setAttributeNS(null,"id",rt),v.setAttributeNS(null,"patternUnits","userSpaceOnUse"),v.setAttributeNS(null,"width",i),v.setAttributeNS(null,"height",r),v.setAttributeNS(null,"x",`${X}`),v.setAttributeNS(null,"y",`${_t}`);const L=this.svg,D=this.transformMatrix,F=this.current.fillColor,Q=this.current.strokeColor,vt=this.svgFactory.create(x-X,$-_t);if(this.svg=vt,this.transformMatrix=c,K===2){const St=k.Util.makeHexColor(...u);this.current.fillColor=St,this.current.strokeColor=St}return this.executeOpTree(this.convertOpList(o)),this.svg=L,this.transformMatrix=D,this.current.fillColor=F,this.current.strokeColor=Q,v.append(vt.childNodes[0]),this.defs.append(v),`url(#${rt})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const u=`shading${E++}`,o=a[3];let c;switch(a[1]){case"axial":const h=a[4],B=a[5];c=this.svgFactory.createElement("svg:linearGradient"),c.setAttributeNS(null,"id",u),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"x1",h[0]),c.setAttributeNS(null,"y1",h[1]),c.setAttributeNS(null,"x2",B[0]),c.setAttributeNS(null,"y2",B[1]);break;case"radial":const l=a[4],w=a[5],I=a[6],bt=a[7];c=this.svgFactory.createElement("svg:radialGradient"),c.setAttributeNS(null,"id",u),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"cx",w[0]),c.setAttributeNS(null,"cy",w[1]),c.setAttributeNS(null,"r",bt),c.setAttributeNS(null,"fx",l[0]),c.setAttributeNS(null,"fy",l[1]),c.setAttributeNS(null,"fr",I);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const h of o){const B=this.svgFactory.createElement("svg:stop");B.setAttributeNS(null,"offset",h[0]),B.setAttributeNS(null,"stop-color",h[1]),c.append(B)}return this.defs.append(c),`url(#${u})`;case"Mesh":return(0,k.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,u){this.current.dashArray=a,this.current.dashPhase=u}constructPath(a,u){const o=this.current;let c=o.x,h=o.y,B=[],l=0;for(const w of a)switch(w|0){case k.OPS.rectangle:c=u[l++],h=u[l++];const I=u[l++],bt=u[l++],K=c+I,rt=h+bt;B.push("M",_(c),_(h),"L",_(K),_(h),"L",_(K),_(rt),"L",_(c),_(rt),"Z");break;case k.OPS.moveTo:c=u[l++],h=u[l++],B.push("M",_(c),_(h));break;case k.OPS.lineTo:c=u[l++],h=u[l++],B.push("L",_(c),_(h));break;case k.OPS.curveTo:c=u[l+4],h=u[l+5],B.push("C",_(u[l]),_(u[l+1]),_(u[l+2]),_(u[l+3]),_(c),_(h)),l+=6;break;case k.OPS.curveTo2:B.push("C",_(c),_(h),_(u[l]),_(u[l+1]),_(u[l+2]),_(u[l+3])),c=u[l+2],h=u[l+3],l+=4;break;case k.OPS.curveTo3:c=u[l+2],h=u[l+3],B.push("C",_(u[l]),_(u[l+1]),_(c),_(h),_(c),_(h)),l+=4;break;case k.OPS.closePath:B.push("Z");break}B=B.join(" "),o.path&&a.length>0&&a[0]!==k.OPS.rectangle&&a[0]!==k.OPS.moveTo?B=o.path.getAttributeNS(null,"d")+B:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",B),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(c,h)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const u=`clippath${y++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",u),o.setAttributeNS(null,"transform",R(this.transformMatrix));const c=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?c.setAttributeNS(null,"clip-rule","evenodd"):c.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(c),this.defs.append(o),a.activeClipUrl){a.clipGroup=null;for(const h of this.extraStack)h.clipGroup=null;o.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${u})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const u=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",u)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[u,o]of a)switch(u){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,k.warn)(`Unimplemented graphic state operator ${u}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a,u=1){const o=this.current;let c=o.dashArray;u!==1&&c.length>0&&(c=c.map(function(h){return u*h})),a.setAttributeNS(null,"stroke",o.strokeColor),a.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",_(o.miterLimit)),a.setAttributeNS(null,"stroke-linecap",o.lineCap),a.setAttributeNS(null,"stroke-linejoin",o.lineJoin),a.setAttributeNS(null,"stroke-width",_(u*o.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",c.map(_).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",_(u*o.dashPhase)+"px")}eoFill(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const u=this.getObject(a);if(!u){(0,k.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(u)}paintInlineImageXObject(a,u){const o=a.width,c=a.height,h=z(a,this.forceDataSchema,!!u),B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y","0"),B.setAttributeNS(null,"width",_(o)),B.setAttributeNS(null,"height",_(c)),this.current.element=B,this.clip("nonzero");const l=this.svgFactory.createElement("svg:image");l.setAttributeNS(Mt,"xlink:href",h),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",_(-c)),l.setAttributeNS(null,"width",_(o)+"px"),l.setAttributeNS(null,"height",_(c)+"px"),l.setAttributeNS(null,"transform",`scale(${_(1/o)} ${_(-1/c)})`),u?u.append(l):this._ensureTransformGroup().append(l)}paintImageMaskXObject(a){const u=this.getObject(a.data,a);if(u.bitmap){(0,k.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,c=u.width,h=u.height,B=o.fillColor;o.maskId=`mask${m++}`;const l=this.svgFactory.createElement("svg:mask");l.setAttributeNS(null,"id",o.maskId);const w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x","0"),w.setAttributeNS(null,"y","0"),w.setAttributeNS(null,"width",_(c)),w.setAttributeNS(null,"height",_(h)),w.setAttributeNS(null,"fill",B),w.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(l),this._ensureTransformGroup().append(w),this.paintInlineImageXObject(u,l)}paintFormXObjectBegin(a,u){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),u){const o=u[2]-u[0],c=u[3]-u[1],h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x",u[0]),h.setAttributeNS(null,"y",u[1]),h.setAttributeNS(null,"width",_(o)),h.setAttributeNS(null,"height",_(c)),this.current.element=h,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const u=this.svgFactory.create(a.width,a.height),o=this.svgFactory.createElement("svg:defs");u.append(o),this.defs=o;const c=this.svgFactory.createElement("svg:g");return c.setAttributeNS(null,"transform",R(a.transform)),u.append(c),this.svg=c,u}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",R(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}b.SVGGraphics=H},(d,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.XfaText=void 0;class Et{static textContent(k){const e=[],it={items:e,styles:Object.create(null)};function Mt(G){var z;if(!G)return;let N=null;const f=G.name;if(f==="#text")N=G.value;else if(Et.shouldBuildText(f))(z=G==null?void 0:G.attributes)!=null&&z.textContent?N=G.attributes.textContent:G.value&&(N=G.value);else return;if(N!==null&&e.push({str:N}),!!G.children)for(const W of G.children)Mt(W)}return Mt(k),it}static shouldBuildText(k){return!(k==="textarea"||k==="input"||k==="option"||k==="select")}}b.XfaText=Et},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TextLayerRenderTask=void 0,b.renderTextLayer=R,b.updateTextLayer=y;var g=Et(1),k=Et(6);const e=1e5,it=30,Mt=.8,G=new Map;function N(m,E){let H;if(E&&g.FeatureTest.isOffscreenCanvasSupported)H=new OffscreenCanvas(m,m).getContext("2d",{alpha:!1});else{const C=document.createElement("canvas");C.width=C.height=m,H=C.getContext("2d",{alpha:!1})}return H}function f(m,E){const H=G.get(m);if(H)return H;const C=N(it,E);C.font=`${it}px ${m}`;const a=C.measureText("");let u=a.fontBoundingBoxAscent,o=Math.abs(a.fontBoundingBoxDescent);if(u){const h=u/(u+o);return G.set(m,h),C.canvas.width=C.canvas.height=0,h}C.strokeStyle="red",C.clearRect(0,0,it,it),C.strokeText("g",0,0);let c=C.getImageData(0,0,it,it).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/it);break}C.clearRect(0,0,it,it),C.strokeText("A",0,it),c=C.getImageData(0,0,it,it).data,u=0;for(let h=0,B=c.length;h<B;h+=4)if(c[h]>0){u=it-Math.floor(h/4/it);break}if(C.canvas.width=C.canvas.height=0,u){const h=u/(u+o);return G.set(m,h),h}return G.set(m,Mt),Mt}function z(m,E,H){const C=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:E.str!=="",hasEOL:E.hasEOL,fontSize:0};m._textDivs.push(C);const u=g.Util.transform(m._transform,E.transform);let o=Math.atan2(u[1],u[0]);const c=H[E.fontName];c.vertical&&(o+=Math.PI/2);const h=Math.hypot(u[2],u[3]),B=h*f(c.fontFamily,m._isOffscreenCanvasSupported);let l,w;o===0?(l=u[4],w=u[5]-B):(l=u[4]+B*Math.sin(o),w=u[5]-B*Math.cos(o));const I="calc(var(--scale-factor)*",bt=C.style;m._container===m._rootContainer?(bt.left=`${(100*l/m._pageWidth).toFixed(2)}%`,bt.top=`${(100*w/m._pageHeight).toFixed(2)}%`):(bt.left=`${I}${l.toFixed(2)}px)`,bt.top=`${I}${w.toFixed(2)}px)`),bt.fontSize=`${I}${h.toFixed(2)}px)`,bt.fontFamily=c.fontFamily,a.fontSize=h,C.setAttribute("role","presentation"),C.textContent=E.str,C.dir=E.dir,m._fontInspectorEnabled&&(C.dataset.fontName=E.fontName),o!==0&&(a.angle=o*(180/Math.PI));let K=!1;if(E.str.length>1)K=!0;else if(E.str!==" "&&E.transform[0]!==E.transform[3]){const rt=Math.abs(E.transform[0]),X=Math.abs(E.transform[3]);rt!==X&&Math.max(rt,X)/Math.min(rt,X)>1.5&&(K=!0)}K&&(a.canvasWidth=c.vertical?E.height:E.width),m._textDivProperties.set(C,a),m._isReadableStream&&m._layoutText(C)}function W(m){const{div:E,scale:H,properties:C,ctx:a,prevFontSize:u,prevFontFamily:o}=m,{style:c}=E;let h="";if(C.canvasWidth!==0&&C.hasText){const{fontFamily:B}=c,{canvasWidth:l,fontSize:w}=C;(u!==w||o!==B)&&(a.font=`${w*H}px ${B}`,m.prevFontSize=w,m.prevFontFamily=B);const{width:I}=a.measureText(E.textContent);I>0&&(h=`scaleX(${l*H/I})`)}C.angle!==0&&(h=`rotate(${C.angle}deg) ${h}`),h.length>0&&(c.transform=h)}function A(m){if(m._canceled)return;const E=m._textDivs,H=m._capability;if(E.length>e){H.resolve();return}if(!m._isReadableStream)for(const a of E)m._layoutText(a);H.resolve()}class _{constructor({textContentSource:E,container:H,viewport:C,textDivs:a,textDivProperties:u,textContentItemsStr:o,isOffscreenCanvasSupported:c}){var I;this._textContentSource=E,this._isReadableStream=E instanceof ReadableStream,this._container=this._rootContainer=H,this._textDivs=a||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!((I=globalThis.FontInspector)!=null&&I.enabled),this._reader=null,this._textDivProperties=u||new WeakMap,this._canceled=!1,this._capability=new g.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:N(0,c)};const{pageWidth:h,pageHeight:B,pageX:l,pageY:w}=C.rawDims;this._transform=[1,0,0,-1,-l,w+B],this._pageWidth=h,this._pageHeight=B,(0,k.setLayerDimensions)(H,C),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new g.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new g.AbortException("TextLayer task cancelled."))}_processItems(E,H){for(const C of E){if(C.str===void 0){if(C.type==="beginMarkedContentProps"||C.type==="beginMarkedContent"){const a=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),C.id!==null&&this._container.setAttribute("id",`${C.id}`),a.append(this._container)}else C.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(C.str),z(this,C,H)}}_layoutText(E){const H=this._layoutTextParams.properties=this._textDivProperties.get(E);if(this._layoutTextParams.div=E,W(this._layoutTextParams),H.hasText&&this._container.append(E),H.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this._container.append(C)}}_render(){const E=new g.PromiseCapability;let H=Object.create(null);if(this._isReadableStream){const C=()=>{this._reader.read().then(({value:a,done:u})=>{if(u){E.resolve();return}Object.assign(H,a.styles),this._processItems(a.items,H),C()},E.reject)};this._reader=this._textContentSource.getReader(),C()}else if(this._textContentSource){const{items:C,styles:a}=this._textContentSource;this._processItems(C,a),E.resolve()}else throw new Error('No "textContentSource" parameter specified.');E.promise.then(()=>{H=null,A(this)},this._capability.reject)}}b.TextLayerRenderTask=_;function R(m){!m.textContentSource&&(m.textContent||m.textContentStream)&&((0,k.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),m.textContentSource=m.textContent||m.textContentStream);const{container:E,viewport:H}=m,C=getComputedStyle(E),a=C.getPropertyValue("visibility"),u=parseFloat(C.getPropertyValue("--scale-factor"));a==="visible"&&(!u||Math.abs(u-H.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new _(m);return o._render(),o}function y({container:m,viewport:E,textDivs:H,textDivProperties:C,isOffscreenCanvasSupported:a,mustRotate:u=!0,mustRescale:o=!0}){if(u&&(0,k.setLayerDimensions)(m,{rotation:E.rotation}),o){const c=N(0,a),B={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:c};for(const l of H)B.properties=C.get(l),B.div=l,W(B)}}},(d,b,Et)=>{var f,z,W,A,_,R,y,m,E,H,C,$i,hi,Yi,Ki;Object.defineProperty(b,"__esModule",{value:!0}),b.AnnotationEditorLayer=void 0;var g=Et(1),k=Et(4),e=Et(28),it=Et(33),Mt=Et(6),G=Et(34);const h=class h{constructor({uiManager:l,pageIndex:w,div:I,accessibilityManager:bt,annotationLayer:K,viewport:rt,l10n:X}){gt(this,C);gt(this,f);gt(this,z,!1);gt(this,W,null);gt(this,A,this.pointerup.bind(this));gt(this,_,this.pointerdown.bind(this));gt(this,R,new Map);gt(this,y,!1);gt(this,m,!1);gt(this,E,!1);gt(this,H);const _t=[e.FreeTextEditor,it.InkEditor,G.StampEditor];if(!h._initialized){h._initialized=!0;for(const x of _t)x.initialize(X)}l.registerEditorTypes(_t),mt(this,H,l),this.pageIndex=w,this.div=I,mt(this,f,bt),mt(this,W,K),this.viewport=rt,t(this,H).addLayer(this)}get isEmpty(){return t(this,R).size===0}updateToolbar(l){t(this,H).updateToolbar(l)}updateMode(l=t(this,H).getMode()){tt(this,C,Ki).call(this),l===g.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),l!==g.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",l===g.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",l===g.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",l===g.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(l){if(!l&&t(this,H).getMode()!==g.AnnotationEditorType.INK)return;if(!l){for(const I of t(this,R).values())if(I.isEmpty()){I.setInBackground();return}}tt(this,C,hi).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(l){t(this,H).setEditingState(l)}addCommands(l){t(this,H).addCommands(l)}enable(){this.div.style.pointerEvents="auto";const l=new Set;for(const I of t(this,R).values())I.enableEditing(),I.annotationElementId&&l.add(I.annotationElementId);if(!t(this,W))return;const w=t(this,W).getEditableAnnotations();for(const I of w){if(I.hide(),t(this,H).isDeletedAnnotationElement(I.data.id)||l.has(I.data.id))continue;const bt=this.deserialize(I);bt&&(this.addOrRebuild(bt),bt.enableEditing())}}disable(){var w;mt(this,E,!0),this.div.style.pointerEvents="none";const l=new Set;for(const I of t(this,R).values()){if(I.disableEditing(),!I.annotationElementId||I.serialize()!==null){l.add(I.annotationElementId);continue}(w=this.getEditableAnnotation(I.annotationElementId))==null||w.show(),I.remove()}if(t(this,W)){const I=t(this,W).getEditableAnnotations();for(const bt of I){const{id:K}=bt.data;l.has(K)||t(this,H).isDeletedAnnotationElement(K)||bt.show()}}tt(this,C,Ki).call(this),this.isEmpty&&(this.div.hidden=!0),mt(this,E,!1)}getEditableAnnotation(l){var w;return((w=t(this,W))==null?void 0:w.getEditableAnnotation(l))||null}setActiveEditor(l){t(this,H).getActive()!==l&&t(this,H).setActiveEditor(l)}enableClick(){this.div.addEventListener("pointerdown",t(this,_)),this.div.addEventListener("pointerup",t(this,A))}disableClick(){this.div.removeEventListener("pointerdown",t(this,_)),this.div.removeEventListener("pointerup",t(this,A))}attach(l){t(this,R).set(l.id,l);const{annotationElementId:w}=l;w&&t(this,H).isDeletedAnnotationElement(w)&&t(this,H).removeDeletedAnnotationElement(l)}detach(l){var w;t(this,R).delete(l.id),(w=t(this,f))==null||w.removePointerInTextLayer(l.contentDiv),!t(this,E)&&l.annotationElementId&&t(this,H).addDeletedAnnotationElement(l)}remove(l){this.detach(l),t(this,H).removeEditor(l),l.div.contains(document.activeElement)&&setTimeout(()=>{t(this,H).focusMainContainer()},0),l.div.remove(),l.isAttachedToDOM=!1,t(this,m)||this.addInkEditorIfNeeded(!1)}changeParent(l){var w;l.parent!==this&&(l.annotationElementId&&(t(this,H).addDeletedAnnotationElement(l.annotationElementId),k.AnnotationEditor.deleteAnnotationElement(l),l.annotationElementId=null),this.attach(l),(w=l.parent)==null||w.detach(l),l.setParent(this),l.div&&l.isAttachedToDOM&&(l.div.remove(),this.div.append(l.div)))}add(l){if(this.changeParent(l),t(this,H).addEditor(l),this.attach(l),!l.isAttachedToDOM){const w=l.render();this.div.append(w),l.isAttachedToDOM=!0}l.fixAndSetPosition(),l.onceAdded(),t(this,H).addToAnnotationStorage(l)}moveEditorInDOM(l){var I;if(!l.isAttachedToDOM)return;const{activeElement:w}=document;l.div.contains(w)&&(l._focusEventsAllowed=!1,setTimeout(()=>{l.div.contains(document.activeElement)?l._focusEventsAllowed=!0:(l.div.addEventListener("focusin",()=>{l._focusEventsAllowed=!0},{once:!0}),w.focus())},0)),l._structTreeParentId=(I=t(this,f))==null?void 0:I.moveElementInDOM(this.div,l.div,l.contentDiv,!0)}addOrRebuild(l){l.needsToBeRebuilt()?l.rebuild():this.add(l)}addUndoableEditor(l){const w=()=>l._uiManager.rebuild(l),I=()=>{l.remove()};this.addCommands({cmd:w,undo:I,mustExec:!1})}getNextId(){return t(this,H).getId()}pasteEditor(l,w){t(this,H).updateToolbar(l),t(this,H).updateMode(l);const{offsetX:I,offsetY:bt}=tt(this,C,Yi).call(this),K=this.getNextId(),rt=tt(this,C,$i).call(this,{parent:this,id:K,x:I,y:bt,uiManager:t(this,H),isCentered:!0,...w});rt&&this.add(rt)}deserialize(l){switch(l.annotationType??l.annotationEditorType){case g.AnnotationEditorType.FREETEXT:return e.FreeTextEditor.deserialize(l,this,t(this,H));case g.AnnotationEditorType.INK:return it.InkEditor.deserialize(l,this,t(this,H));case g.AnnotationEditorType.STAMP:return G.StampEditor.deserialize(l,this,t(this,H))}return null}addNewEditor(){tt(this,C,hi).call(this,tt(this,C,Yi).call(this),!0)}setSelected(l){t(this,H).setSelected(l)}toggleSelected(l){t(this,H).toggleSelected(l)}isSelected(l){return t(this,H).isSelected(l)}unselect(l){t(this,H).unselect(l)}pointerup(l){const{isMac:w}=g.FeatureTest.platform;if(!(l.button!==0||l.ctrlKey&&w)&&l.target===this.div&&t(this,y)){if(mt(this,y,!1),!t(this,z)){mt(this,z,!0);return}if(t(this,H).getMode()===g.AnnotationEditorType.STAMP){t(this,H).unselectAll();return}tt(this,C,hi).call(this,l,!1)}}pointerdown(l){if(t(this,y)){mt(this,y,!1);return}const{isMac:w}=g.FeatureTest.platform;if(l.button!==0||l.ctrlKey&&w||l.target!==this.div)return;mt(this,y,!0);const I=t(this,H).getActive();mt(this,z,!I||I.isEmpty())}findNewParent(l,w,I){const bt=t(this,H).findParent(w,I);return bt===null||bt===this?!1:(bt.changeParent(l),!0)}destroy(){var l,w;((l=t(this,H).getActive())==null?void 0:l.parent)===this&&(t(this,H).commitOrRemove(),t(this,H).setActiveEditor(null));for(const I of t(this,R).values())(w=t(this,f))==null||w.removePointerInTextLayer(I.contentDiv),I.setParent(null),I.isAttachedToDOM=!1,I.div.remove();this.div=null,t(this,R).clear(),t(this,H).removeLayer(this)}render({viewport:l}){this.viewport=l,(0,Mt.setLayerDimensions)(this.div,l);for(const w of t(this,H).getEditors(this.pageIndex))this.add(w);this.updateMode()}update({viewport:l}){t(this,H).commitOrRemove(),this.viewport=l,(0,Mt.setLayerDimensions)(this.div,{rotation:l.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:l,pageHeight:w}=this.viewport.rawDims;return[l,w]}};f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakMap,E=new WeakMap,H=new WeakMap,C=new WeakSet,$i=function(l){switch(t(this,H).getMode()){case g.AnnotationEditorType.FREETEXT:return new e.FreeTextEditor(l);case g.AnnotationEditorType.INK:return new it.InkEditor(l);case g.AnnotationEditorType.STAMP:return new G.StampEditor(l)}return null},hi=function(l,w){const I=this.getNextId(),bt=tt(this,C,$i).call(this,{parent:this,id:I,x:l.offsetX,y:l.offsetY,uiManager:t(this,H),isCentered:w});return bt&&this.add(bt),bt},Yi=function(){const{x:l,y:w,width:I,height:bt}=this.div.getBoundingClientRect(),K=Math.max(0,l),rt=Math.max(0,w),X=Math.min(window.innerWidth,l+I),_t=Math.min(window.innerHeight,w+bt),x=(K+X)/2-l,$=(rt+_t)/2-w,[ct,T]=this.viewport.rotation%180===0?[x,$]:[$,x];return{offsetX:ct,offsetY:T}},Ki=function(){mt(this,m,!0);for(const l of t(this,R).values())l.isEmpty()&&l.remove();mt(this,m,!1)},Xe(h,"_initialized",!1);let N=h;b.AnnotationEditorLayer=N},(d,b,Et)=>{var G,N,f,z,W,A,_,R,y,m,jr,Wr,zr,Xn,Ji,Vr,Zi;Object.defineProperty(b,"__esModule",{value:!0}),b.FreeTextEditor=void 0;var g=Et(1),k=Et(5),e=Et(4),it=Et(29);const h=class h extends e.AnnotationEditor{constructor(w){super({...w,name:"freeTextEditor"});gt(this,m);gt(this,G,this.editorDivBlur.bind(this));gt(this,N,this.editorDivFocus.bind(this));gt(this,f,this.editorDivInput.bind(this));gt(this,z,this.editorDivKeydown.bind(this));gt(this,W);gt(this,A,"");gt(this,_,`${this.id}-editor`);gt(this,R);gt(this,y,null);mt(this,W,w.color||h._defaultColor||e.AnnotationEditor._defaultLineColor),mt(this,R,w.fontSize||h._defaultFontSize)}static get _keyboardManager(){const w=h.prototype,I=rt=>rt.isEmpty(),bt=k.AnnotationEditorUIManager.TRANSLATE_SMALL,K=k.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,g.shadow)(this,"_keyboardManager",new k.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],w.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],w.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],w._translateEmpty,{args:[-bt,0],checker:I}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],w._translateEmpty,{args:[-K,0],checker:I}],[["ArrowRight","mac+ArrowRight"],w._translateEmpty,{args:[bt,0],checker:I}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],w._translateEmpty,{args:[K,0],checker:I}],[["ArrowUp","mac+ArrowUp"],w._translateEmpty,{args:[0,-bt],checker:I}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],w._translateEmpty,{args:[0,-K],checker:I}],[["ArrowDown","mac+ArrowDown"],w._translateEmpty,{args:[0,bt],checker:I}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],w._translateEmpty,{args:[0,K],checker:I}]]))}static initialize(w){e.AnnotationEditor.initialize(w,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const I=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(I.getPropertyValue("--freetext-padding"))}static updateDefaultParams(w,I){switch(w){case g.AnnotationEditorParamsType.FREETEXT_SIZE:h._defaultFontSize=I;break;case g.AnnotationEditorParamsType.FREETEXT_COLOR:h._defaultColor=I;break}}updateParams(w,I){switch(w){case g.AnnotationEditorParamsType.FREETEXT_SIZE:tt(this,m,jr).call(this,I);break;case g.AnnotationEditorParamsType.FREETEXT_COLOR:tt(this,m,Wr).call(this,I);break}}static get defaultPropertiesToUpdate(){return[[g.AnnotationEditorParamsType.FREETEXT_SIZE,h._defaultFontSize],[g.AnnotationEditorParamsType.FREETEXT_COLOR,h._defaultColor||e.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[g.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,R)],[g.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,W)]]}_translateEmpty(w,I){this._uiManager.translateSelectedEditors(w,I,!0)}getInitialTranslation(){const w=this.parentScale;return[-h._internalPadding*w,-(h._internalPadding+t(this,R))*w]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(g.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,z)),this.editorDiv.addEventListener("focus",t(this,N)),this.editorDiv.addEventListener("blur",t(this,G)),this.editorDiv.addEventListener("input",t(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,_)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,z)),this.editorDiv.removeEventListener("focus",t(this,N)),this.editorDiv.removeEventListener("blur",t(this,G)),this.editorDiv.removeEventListener("input",t(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(w){this._focusEventsAllowed&&(super.focusin(w),w.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var w;if(this.width){tt(this,m,Zi).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(w=this._initialOptions)!=null&&w.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const w=t(this,A),I=mt(this,A,tt(this,m,zr).call(this).trimEnd());if(w===I)return;const bt=K=>{if(mt(this,A,K),!K){this.remove();return}tt(this,m,Ji).call(this),this._uiManager.rebuild(this),tt(this,m,Xn).call(this)};this.addCommands({cmd:()=>{bt(I)},undo:()=>{bt(w)},mustExec:!1}),tt(this,m,Xn).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(w){this.enterInEditMode()}keydown(w){w.target===this.div&&w.key==="Enter"&&(this.enterInEditMode(),w.preventDefault())}editorDivKeydown(w){h._keyboardManager.exec(this,w)}editorDivFocus(w){this.isEditing=!0}editorDivBlur(w){this.isEditing=!1}editorDivInput(w){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let w,I;this.width&&(w=this.x,I=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,_)),this.enableEditing(),e.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(K=>{var rt;return(rt=this.editorDiv)==null?void 0:rt.setAttribute("aria-label",K)}),e.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(K=>{var rt;return(rt=this.editorDiv)==null?void 0:rt.setAttribute("default-content",K)}),this.editorDiv.contentEditable=!0;const{style:bt}=this.editorDiv;if(bt.fontSize=`calc(${t(this,R)}px * var(--scale-factor))`,bt.color=t(this,W),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,k.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[K,rt]=this.parentDimensions;if(this.annotationElementId){const{position:X}=t(this,y);let[_t,x]=this.getInitialTranslation();[_t,x]=this.pageTranslationToScreen(_t,x);const[$,ct]=this.pageDimensions,[T,i]=this.pageTranslation;let r,v;switch(this.rotation){case 0:r=w+(X[0]-T)/$,v=I+this.height-(X[1]-i)/ct;break;case 90:r=w+(X[0]-T)/$,v=I-(X[1]-i)/ct,[_t,x]=[x,-_t];break;case 180:r=w-this.width+(X[0]-T)/$,v=I-(X[1]-i)/ct,[_t,x]=[-_t,-x];break;case 270:r=w+(X[0]-T-this.height*ct)/$,v=I+(X[1]-i-this.width*$)/ct,[_t,x]=[-x,_t];break}this.setAt(r*K,v*rt,_t,x)}else this.setAt(w*K,I*rt,this.width*K,this.height*rt);tt(this,m,Ji).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(w,I,bt){let K=null;if(w instanceof it.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:X,fontColor:_t},rect:x,rotation:$,id:ct},textContent:T,textPosition:i,parent:{page:{pageNumber:r}}}=w;if(!T||T.length===0)return null;K=w={annotationType:g.AnnotationEditorType.FREETEXT,color:Array.from(_t),fontSize:X,value:T.join(`
`),position:i,pageIndex:r-1,rect:x,rotation:$,id:ct,deleted:!1}}const rt=super.deserialize(w,I,bt);return mt(rt,R,w.fontSize),mt(rt,W,g.Util.makeHexColor(...w.color)),mt(rt,A,w.value),rt.annotationElementId=w.id||null,mt(rt,y,K),rt}serialize(w=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const I=h._internalPadding*this.parentScale,bt=this.getRect(I,I),K=e.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,W)),rt={annotationType:g.AnnotationEditorType.FREETEXT,color:K,fontSize:t(this,R),value:t(this,A),pageIndex:this.pageIndex,rect:bt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return w?rt:this.annotationElementId&&!tt(this,m,Vr).call(this,rt)?null:(rt.id=this.annotationElementId,rt)}};G=new WeakMap,N=new WeakMap,f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakSet,jr=function(w){const I=K=>{this.editorDiv.style.fontSize=`calc(${K}px * var(--scale-factor))`,this.translate(0,-(K-t(this,R))*this.parentScale),mt(this,R,K),tt(this,m,Xn).call(this)},bt=t(this,R);this.addCommands({cmd:()=>{I(w)},undo:()=>{I(bt)},mustExec:!0,type:g.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Wr=function(w){const I=t(this,W);this.addCommands({cmd:()=>{mt(this,W,this.editorDiv.style.color=w)},undo:()=>{mt(this,W,this.editorDiv.style.color=I)},mustExec:!0,type:g.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},zr=function(){const w=this.editorDiv.getElementsByTagName("div");if(w.length===0)return this.editorDiv.innerText;const I=[];for(const bt of w)I.push(bt.innerText.replace(/\r\n?|\n/,""));return I.join(`
`)},Xn=function(){const[w,I]=this.parentDimensions;let bt;if(this.isAttachedToDOM)bt=this.div.getBoundingClientRect();else{const{currentLayer:K,div:rt}=this,X=rt.style.display;rt.style.display="hidden",K.div.append(this.div),bt=rt.getBoundingClientRect(),rt.remove(),rt.style.display=X}this.rotation%180===this.parentRotation%180?(this.width=bt.width/w,this.height=bt.height/I):(this.width=bt.height/w,this.height=bt.width/I),this.fixAndSetPosition()},Ji=function(){if(this.editorDiv.replaceChildren(),!!t(this,A))for(const w of t(this,A).split(`
`)){const I=document.createElement("div");I.append(w?document.createTextNode(w):document.createElement("br")),this.editorDiv.append(I)}},Vr=function(w){const{value:I,fontSize:bt,color:K,rect:rt,pageIndex:X}=t(this,y);return w.value!==I||w.fontSize!==bt||w.rect.some((_t,x)=>Math.abs(_t-rt[x])>=1)||w.color.some((_t,x)=>_t!==K[x])||w.pageIndex!==X},Zi=function(w=!1){if(!this.annotationElementId)return;if(tt(this,m,Xn).call(this),!w&&(this.width===0||this.height===0)){setTimeout(()=>tt(this,m,Zi).call(this,!0),0);return}const I=h._internalPadding*this.parentScale;t(this,y).rect=this.getRect(I,I)},Xe(h,"_freeTextDefaultContent",""),Xe(h,"_internalPadding",0),Xe(h,"_defaultColor",null),Xe(h,"_defaultFontSize",10),Xe(h,"_type","freetext");let Mt=h;b.FreeTextEditor=Mt},(d,b,Et)=>{var v,D,xn,qr,vt,St,wt,Tt,Ft,Lt,ht,dt,S,O,nt,ft,Ct,Dt,Rt,et,zt,Ht,Gr,ui,Qi,tr,re,Ae,Ie,kt,st,ot,$t,er,le,U,Pt,Wt,Xr,nr;Object.defineProperty(b,"__esModule",{value:!0}),b.StampAnnotationElement=b.InkAnnotationElement=b.FreeTextAnnotationElement=b.AnnotationLayer=void 0;var g=Et(1),k=Et(6),e=Et(3),it=Et(30),Mt=Et(31),G=Et(32);const N=1e3,f=9,z=new WeakSet;function W(Xt){return{width:Xt[2]-Xt[0],height:Xt[3]-Xt[1]}}class A{static create(M){switch(M.data.annotationType){case g.AnnotationType.LINK:return new R(M);case g.AnnotationType.TEXT:return new y(M);case g.AnnotationType.WIDGET:switch(M.data.fieldType){case"Tx":return new E(M);case"Btn":return M.data.radioButton?new a(M):M.data.checkBox?new C(M):new u(M);case"Ch":return new o(M);case"Sig":return new H(M)}return new m(M);case g.AnnotationType.POPUP:return new c(M);case g.AnnotationType.FREETEXT:return new B(M);case g.AnnotationType.LINE:return new l(M);case g.AnnotationType.SQUARE:return new w(M);case g.AnnotationType.CIRCLE:return new I(M);case g.AnnotationType.POLYLINE:return new bt(M);case g.AnnotationType.CARET:return new rt(M);case g.AnnotationType.INK:return new X(M);case g.AnnotationType.POLYGON:return new K(M);case g.AnnotationType.HIGHLIGHT:return new _t(M);case g.AnnotationType.UNDERLINE:return new x(M);case g.AnnotationType.SQUIGGLY:return new $(M);case g.AnnotationType.STRIKEOUT:return new ct(M);case g.AnnotationType.STAMP:return new T(M);case g.AnnotationType.FILEATTACHMENT:return new i(M);default:return new _(M)}}}const L=class L{constructor(M,{isRenderable:P=!1,ignoreBorder:J=!1,createQuadrilaterals:yt=!1}={}){gt(this,v,!1);this.isRenderable=P,this.data=M.data,this.layer=M.layer,this.linkService=M.linkService,this.downloadManager=M.downloadManager,this.imageResourcesPath=M.imageResourcesPath,this.renderForms=M.renderForms,this.svgFactory=M.svgFactory,this.annotationStorage=M.annotationStorage,this.enableScripting=M.enableScripting,this.hasJSActions=M.hasJSActions,this._fieldObjects=M.fieldObjects,this.parent=M.parent,P&&(this.container=this._createContainer(J)),yt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:M,contentsObj:P,richText:J}){return!!(M!=null&&M.str||P!=null&&P.str||J!=null&&J.str)}get hasPopupData(){return L._hasPopupData(this.data)}_createContainer(M){const{data:P,parent:{page:J,viewport:yt}}=this,At=document.createElement("section");At.setAttribute("data-annotation-id",P.id),this instanceof m||(At.tabIndex=N),At.style.zIndex=this.parent.zIndex++,this.data.popupRef&&At.setAttribute("aria-haspopup","dialog"),P.noRotate&&At.classList.add("norotate");const{pageWidth:xt,pageHeight:Bt,pageX:te,pageY:Kt}=yt.rawDims;if(!P.rect||this instanceof c){const{rotation:fe}=P;return!P.hasOwnCanvas&&fe!==0&&this.setRotation(fe,At),At}const{width:qt,height:_e}=W(P.rect),Jt=g.Util.normalizeRect([P.rect[0],J.view[3]-P.rect[1]+J.view[1],P.rect[2],J.view[3]-P.rect[3]+J.view[1]]);if(!M&&P.borderStyle.width>0){At.style.borderWidth=`${P.borderStyle.width}px`;const fe=P.borderStyle.horizontalCornerRadius,we=P.borderStyle.verticalCornerRadius;if(fe>0||we>0){const je=`calc(${fe}px * var(--scale-factor)) / calc(${we}px * var(--scale-factor))`;At.style.borderRadius=je}else if(this instanceof a){const je=`calc(${qt}px * var(--scale-factor)) / calc(${_e}px * var(--scale-factor))`;At.style.borderRadius=je}switch(P.borderStyle.style){case g.AnnotationBorderStyleType.SOLID:At.style.borderStyle="solid";break;case g.AnnotationBorderStyleType.DASHED:At.style.borderStyle="dashed";break;case g.AnnotationBorderStyleType.BEVELED:(0,g.warn)("Unimplemented border style: beveled");break;case g.AnnotationBorderStyleType.INSET:(0,g.warn)("Unimplemented border style: inset");break;case g.AnnotationBorderStyleType.UNDERLINE:At.style.borderBottomStyle="solid";break}const Fe=P.borderColor||null;Fe?(mt(this,v,!0),At.style.borderColor=g.Util.makeHexColor(Fe[0]|0,Fe[1]|0,Fe[2]|0)):At.style.borderWidth=0}At.style.left=`${100*(Jt[0]-te)/xt}%`,At.style.top=`${100*(Jt[1]-Kt)/Bt}%`;const{rotation:ie}=P;return P.hasOwnCanvas||ie===0?(At.style.width=`${100*qt/xt}%`,At.style.height=`${100*_e/Bt}%`):this.setRotation(ie,At),At}setRotation(M,P=this.container){if(!this.data.rect)return;const{pageWidth:J,pageHeight:yt}=this.parent.viewport.rawDims,{width:At,height:xt}=W(this.data.rect);let Bt,te;M%180===0?(Bt=100*At/J,te=100*xt/yt):(Bt=100*xt/J,te=100*At/yt),P.style.width=`${Bt}%`,P.style.height=`${te}%`,P.setAttribute("data-main-rotation",(360-M)%360)}get _commonActions(){const M=(P,J,yt)=>{const At=yt.detail[P],xt=At[0],Bt=At.slice(1);yt.target.style[J]=it.ColorConverters[`${xt}_HTML`](Bt),this.annotationStorage.setValue(this.data.id,{[J]:it.ColorConverters[`${xt}_rgb`](Bt)})};return(0,g.shadow)(this,"_commonActions",{display:P=>{const{display:J}=P.detail,yt=J%2===1;this.container.style.visibility=yt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:yt,noPrint:J===1||J===2})},print:P=>{this.annotationStorage.setValue(this.data.id,{noPrint:!P.detail.print})},hidden:P=>{const{hidden:J}=P.detail;this.container.style.visibility=J?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:J,noView:J})},focus:P=>{setTimeout(()=>P.target.focus({preventScroll:!1}),0)},userName:P=>{P.target.title=P.detail.userName},readonly:P=>{P.target.disabled=P.detail.readonly},required:P=>{this._setRequired(P.target,P.detail.required)},bgColor:P=>{M("bgColor","backgroundColor",P)},fillColor:P=>{M("fillColor","backgroundColor",P)},fgColor:P=>{M("fgColor","color",P)},textColor:P=>{M("textColor","color",P)},borderColor:P=>{M("borderColor","borderColor",P)},strokeColor:P=>{M("strokeColor","borderColor",P)},rotation:P=>{const J=P.detail.rotation;this.setRotation(J),this.annotationStorage.setValue(this.data.id,{rotation:J})}})}_dispatchEventFromSandbox(M,P){const J=this._commonActions;for(const yt of Object.keys(P.detail)){const At=M[yt]||J[yt];At==null||At(P)}}_setDefaultPropertiesFromJS(M){if(!this.enableScripting)return;const P=this.annotationStorage.getRawValue(this.data.id);if(!P)return;const J=this._commonActions;for(const[yt,At]of Object.entries(P)){const xt=J[yt];if(xt){const Bt={detail:{[yt]:At},target:M};xt(Bt),delete P[yt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:M}=this.data;if(!M)return;const[P,J,yt,At]=this.data.rect;if(M.length===1){const[,{x:we,y:Fe},{x:je,y:an}]=M[0];if(yt===we&&At===Fe&&P===je&&J===an)return}const{style:xt}=this.container;let Bt;if(t(this,v)){const{borderColor:we,borderWidth:Fe}=xt;xt.borderWidth=0,Bt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${we}" stroke-width="${Fe}">`],this.container.classList.add("hasBorder")}const te=yt-P,Kt=At-J,{svgFactory:qt}=this,_e=qt.createElement("svg");_e.classList.add("quadrilateralsContainer"),_e.setAttribute("width",0),_e.setAttribute("height",0);const Jt=qt.createElement("defs");_e.append(Jt);const ie=qt.createElement("clipPath"),fe=`clippath_${this.data.id}`;ie.setAttribute("id",fe),ie.setAttribute("clipPathUnits","objectBoundingBox"),Jt.append(ie);for(const[,{x:we,y:Fe},{x:je,y:an}]of M){const Ze=qt.createElement("rect"),vn=(je-P)/te,_n=(At-Fe)/Kt,yn=(we-je)/te,Kn=(Fe-an)/Kt;Ze.setAttribute("x",vn),Ze.setAttribute("y",_n),Ze.setAttribute("width",yn),Ze.setAttribute("height",Kn),ie.append(Ze),Bt==null||Bt.push(`<rect vector-effect="non-scaling-stroke" x="${vn}" y="${_n}" width="${yn}" height="${Kn}"/>`)}t(this,v)&&(Bt.push("</g></svg>')"),xt.backgroundImage=Bt.join("")),this.container.append(_e),this.container.style.clipPath=`url(#${fe})`}_createPopup(){const{container:M,data:P}=this;M.setAttribute("aria-haspopup","dialog");const J=new c({data:{color:P.color,titleObj:P.titleObj,modificationDate:P.modificationDate,contentsObj:P.contentsObj,richText:P.richText,parentRect:P.rect,borderStyle:0,id:`popup_${P.id}`,rotation:P.rotation},parent:this.parent,elements:[this]});this.parent.div.append(J.render())}render(){(0,g.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(M,P=null){const J=[];if(this._fieldObjects){const yt=this._fieldObjects[M];if(yt)for(const{page:At,id:xt,exportValues:Bt}of yt){if(At===-1||xt===P)continue;const te=typeof Bt=="string"?Bt:null,Kt=document.querySelector(`[data-element-id="${xt}"]`);if(Kt&&!z.has(Kt)){(0,g.warn)(`_getElementsByName - element not allowed: ${xt}`);continue}J.push({id:xt,exportValue:te,domElement:Kt})}return J}for(const yt of document.getElementsByName(M)){const{exportValue:At}=yt,xt=yt.getAttribute("data-element-id");xt!==P&&z.has(yt)&&J.push({id:xt,exportValue:At,domElement:yt})}return J}show(){var M;this.container&&(this.container.hidden=!1),(M=this.popup)==null||M.maybeShow()}hide(){var M;this.container&&(this.container.hidden=!0),(M=this.popup)==null||M.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const M=this.getElementsToTriggerPopup();if(Array.isArray(M))for(const P of M)P.classList.add("highlightArea");else M.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:M,data:{id:P}}=this;this.container.addEventListener("dblclick",()=>{var J;(J=this.linkService.eventBus)==null||J.dispatch("switchannotationeditormode",{source:this,mode:M,editId:P})})}};v=new WeakMap;let _=L;class R extends _{constructor(P,J=null){super(P,{isRenderable:!0,ignoreBorder:!!(J!=null&&J.ignoreBorder),createQuadrilaterals:!0});gt(this,D);this.isTooltipOnly=P.data.isTooltipOnly}render(){const{data:P,linkService:J}=this,yt=document.createElement("a");yt.setAttribute("data-element-id",P.id);let At=!1;return P.url?(J.addLinkAttributes(yt,P.url,P.newWindow),At=!0):P.action?(this._bindNamedAction(yt,P.action),At=!0):P.attachment?(this._bindAttachment(yt,P.attachment),At=!0):P.setOCGState?(tt(this,D,qr).call(this,yt,P.setOCGState),At=!0):P.dest?(this._bindLink(yt,P.dest),At=!0):(P.actions&&(P.actions.Action||P.actions["Mouse Up"]||P.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(yt,P),At=!0),P.resetForm?(this._bindResetFormAction(yt,P.resetForm),At=!0):this.isTooltipOnly&&!At&&(this._bindLink(yt,""),At=!0)),this.container.classList.add("linkAnnotation"),At&&this.container.append(yt),this.container}_bindLink(P,J){P.href=this.linkService.getDestinationHash(J),P.onclick=()=>(J&&this.linkService.goToDestination(J),!1),(J||J==="")&&tt(this,D,xn).call(this)}_bindNamedAction(P,J){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeNamedAction(J),!1),tt(this,D,xn).call(this)}_bindAttachment(P,J){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>{var yt;return(yt=this.downloadManager)==null||yt.openOrDownloadData(this.container,J.content,J.filename),!1},tt(this,D,xn).call(this)}_bindJSAction(P,J){P.href=this.linkService.getAnchorUrl("");const yt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const At of Object.keys(J.actions)){const xt=yt.get(At);xt&&(P[xt]=()=>{var Bt;return(Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:J.id,name:At}}),!1})}P.onclick||(P.onclick=()=>!1),tt(this,D,xn).call(this)}_bindResetFormAction(P,J){const yt=P.onclick;if(yt||(P.href=this.linkService.getAnchorUrl("")),tt(this,D,xn).call(this),!this._fieldObjects){(0,g.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),yt||(P.onclick=()=>!1);return}P.onclick=()=>{var _e;yt==null||yt();const{fields:At,refs:xt,include:Bt}=J,te=[];if(At.length!==0||xt.length!==0){const Jt=new Set(xt);for(const ie of At){const fe=this._fieldObjects[ie]||[];for(const{id:we}of fe)Jt.add(we)}for(const ie of Object.values(this._fieldObjects))for(const fe of ie)Jt.has(fe.id)===Bt&&te.push(fe)}else for(const Jt of Object.values(this._fieldObjects))te.push(...Jt);const Kt=this.annotationStorage,qt=[];for(const Jt of te){const{id:ie}=Jt;switch(qt.push(ie),Jt.type){case"text":{const we=Jt.defaultValue||"";Kt.setValue(ie,{value:we});break}case"checkbox":case"radiobutton":{const we=Jt.defaultValue===Jt.exportValues;Kt.setValue(ie,{value:we});break}case"combobox":case"listbox":{const we=Jt.defaultValue||"";Kt.setValue(ie,{value:we});break}default:continue}const fe=document.querySelector(`[data-element-id="${ie}"]`);if(fe){if(!z.has(fe)){(0,g.warn)(`_bindResetFormAction - element not allowed: ${ie}`);continue}}else continue;fe.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:qt,name:"ResetForm"}})),!1}}}D=new WeakSet,xn=function(){this.container.setAttribute("data-internal-link","")},qr=function(P,J){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeSetOCGState(J),!1),tt(this,D,xn).call(this)};class y extends _{constructor(M){super(M,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const M=document.createElement("img");return M.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",M.alt="[{{type}} Annotation]",M.dataset.l10nId="text_annotation_type",M.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(M),this.container}}class m extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(M){var P;this.data.hasOwnCanvas&&(((P=M.previousSibling)==null?void 0:P.nodeName)==="CANVAS"&&(M.previousSibling.hidden=!0),M.hidden=!1)}_getKeyModifier(M){const{isWin:P,isMac:J}=g.FeatureTest.platform;return P&&M.ctrlKey||J&&M.metaKey}_setEventListener(M,P,J,yt,At){J.includes("mouse")?M.addEventListener(J,xt=>{var Bt;(Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:yt,value:At(xt),shift:xt.shiftKey,modifier:this._getKeyModifier(xt)}})}):M.addEventListener(J,xt=>{var Bt;if(J==="blur"){if(!P.focused||!xt.relatedTarget)return;P.focused=!1}else if(J==="focus"){if(P.focused)return;P.focused=!0}At&&((Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:yt,value:At(xt)}}))})}_setEventListeners(M,P,J,yt){var At,xt,Bt;for(const[te,Kt]of J)(Kt==="Action"||(At=this.data.actions)!=null&&At[Kt])&&((Kt==="Focus"||Kt==="Blur")&&(P||(P={focused:!1})),this._setEventListener(M,P,te,Kt,yt),Kt==="Focus"&&!((xt=this.data.actions)!=null&&xt.Blur)?this._setEventListener(M,P,"blur","Blur",null):Kt==="Blur"&&!((Bt=this.data.actions)!=null&&Bt.Focus)&&this._setEventListener(M,P,"focus","Focus",null))}_setBackgroundColor(M){const P=this.data.backgroundColor||null;M.style.backgroundColor=P===null?"transparent":g.Util.makeHexColor(P[0],P[1],P[2])}_setTextStyle(M){const P=["left","center","right"],{fontColor:J}=this.data.defaultAppearanceData,yt=this.data.defaultAppearanceData.fontSize||f,At=M.style;let xt;const Bt=2,te=Kt=>Math.round(10*Kt)/10;if(this.data.multiLine){const Kt=Math.abs(this.data.rect[3]-this.data.rect[1]-Bt),qt=Math.round(Kt/(g.LINE_FACTOR*yt))||1,_e=Kt/qt;xt=Math.min(yt,te(_e/g.LINE_FACTOR))}else{const Kt=Math.abs(this.data.rect[3]-this.data.rect[1]-Bt);xt=Math.min(yt,te(Kt/g.LINE_FACTOR))}At.fontSize=`calc(${xt}px * var(--scale-factor))`,At.color=g.Util.makeHexColor(J[0],J[1],J[2]),this.data.textAlignment!==null&&(At.textAlign=P[this.data.textAlignment])}_setRequired(M,P){P?M.setAttribute("required",!0):M.removeAttribute("required"),M.setAttribute("aria-required",P)}}class E extends m{constructor(M){const P=M.renderForms||!M.data.hasAppearance&&!!M.data.fieldValue;super(M,{isRenderable:P})}setPropertyOnSiblings(M,P,J,yt){const At=this.annotationStorage;for(const xt of this._getElementsByName(M.name,M.id))xt.domElement&&(xt.domElement[P]=J),At.setValue(xt.id,{[yt]:J})}render(){var yt,At;const M=this.annotationStorage,P=this.data.id;this.container.classList.add("textWidgetAnnotation");let J=null;if(this.renderForms){const xt=M.getValue(P,{value:this.data.fieldValue});let Bt=xt.value||"";const te=M.getValue(P,{charLimit:this.data.maxLen}).charLimit;te&&Bt.length>te&&(Bt=Bt.slice(0,te));let Kt=xt.formattedValue||((yt=this.data.textContent)==null?void 0:yt.join(`
`))||null;Kt&&this.data.comb&&(Kt=Kt.replaceAll(/\s+/g,""));const qt={userValue:Bt,formattedValue:Kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(J=document.createElement("textarea"),J.textContent=Kt??Bt,this.data.doNotScroll&&(J.style.overflowY="hidden")):(J=document.createElement("input"),J.type="text",J.setAttribute("value",Kt??Bt),this.data.doNotScroll&&(J.style.overflowX="hidden")),this.data.hasOwnCanvas&&(J.hidden=!0),z.add(J),J.setAttribute("data-element-id",P),J.disabled=this.data.readOnly,J.name=this.data.fieldName,J.tabIndex=N,this._setRequired(J,this.data.required),te&&(J.maxLength=te),J.addEventListener("input",Jt=>{M.setValue(P,{value:Jt.target.value}),this.setPropertyOnSiblings(J,"value",Jt.target.value,"value"),qt.formattedValue=null}),J.addEventListener("resetform",Jt=>{const ie=this.data.defaultFieldValue??"";J.value=qt.userValue=ie,qt.formattedValue=null});let _e=Jt=>{const{formattedValue:ie}=qt;ie!=null&&(Jt.target.value=ie),Jt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){J.addEventListener("focus",ie=>{if(qt.focused)return;const{target:fe}=ie;qt.userValue&&(fe.value=qt.userValue),qt.lastCommittedValue=fe.value,qt.commitKey=1,qt.focused=!0}),J.addEventListener("updatefromsandbox",ie=>{this.showElementAndHideCanvas(ie.target);const fe={value(we){qt.userValue=we.detail.value??"",M.setValue(P,{value:qt.userValue.toString()}),we.target.value=qt.userValue},formattedValue(we){const{formattedValue:Fe}=we.detail;qt.formattedValue=Fe,Fe!=null&&we.target!==document.activeElement&&(we.target.value=Fe),M.setValue(P,{formattedValue:Fe})},selRange(we){we.target.setSelectionRange(...we.detail.selRange)},charLimit:we=>{var Ze;const{charLimit:Fe}=we.detail,{target:je}=we;if(Fe===0){je.removeAttribute("maxLength");return}je.setAttribute("maxLength",Fe);let an=qt.userValue;!an||an.length<=Fe||(an=an.slice(0,Fe),je.value=qt.userValue=an,M.setValue(P,{value:an}),(Ze=this.linkService.eventBus)==null||Ze.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:an,willCommit:!0,commitKey:1,selStart:je.selectionStart,selEnd:je.selectionEnd}}))}};this._dispatchEventFromSandbox(fe,ie)}),J.addEventListener("keydown",ie=>{var Fe;qt.commitKey=1;let fe=-1;if(ie.key==="Escape"?fe=0:ie.key==="Enter"&&!this.data.multiLine?fe=2:ie.key==="Tab"&&(qt.commitKey=3),fe===-1)return;const{value:we}=ie.target;qt.lastCommittedValue!==we&&(qt.lastCommittedValue=we,qt.userValue=we,(Fe=this.linkService.eventBus)==null||Fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:we,willCommit:!0,commitKey:fe,selStart:ie.target.selectionStart,selEnd:ie.target.selectionEnd}}))});const Jt=_e;_e=null,J.addEventListener("blur",ie=>{var we;if(!qt.focused||!ie.relatedTarget)return;qt.focused=!1;const{value:fe}=ie.target;qt.userValue=fe,qt.lastCommittedValue!==fe&&((we=this.linkService.eventBus)==null||we.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:fe,willCommit:!0,commitKey:qt.commitKey,selStart:ie.target.selectionStart,selEnd:ie.target.selectionEnd}})),Jt(ie)}),(At=this.data.actions)!=null&&At.Keystroke&&J.addEventListener("beforeinput",ie=>{var _n;qt.lastCommittedValue=null;const{data:fe,target:we}=ie,{value:Fe,selectionStart:je,selectionEnd:an}=we;let Ze=je,vn=an;switch(ie.inputType){case"deleteWordBackward":{const yn=Fe.substring(0,je).match(/\w*[^\w]*$/);yn&&(Ze-=yn[0].length);break}case"deleteWordForward":{const yn=Fe.substring(je).match(/^[^\w]*\w*/);yn&&(vn+=yn[0].length);break}case"deleteContentBackward":je===an&&(Ze-=1);break;case"deleteContentForward":je===an&&(vn+=1);break}ie.preventDefault(),(_n=this.linkService.eventBus)==null||_n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Fe,change:fe||"",willCommit:!1,selStart:Ze,selEnd:vn}})}),this._setEventListeners(J,qt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ie=>ie.target.value)}if(_e&&J.addEventListener("blur",_e),this.data.comb){const ie=(this.data.rect[2]-this.data.rect[0])/te;J.classList.add("comb"),J.style.letterSpacing=`calc(${ie}px * var(--scale-factor) - 1ch)`}}else J=document.createElement("div"),J.textContent=this.data.fieldValue,J.style.verticalAlign="middle",J.style.display="table-cell";return this._setTextStyle(J),this._setBackgroundColor(J),this._setDefaultPropertiesFromJS(J),this.container.append(J),this.container}}class H extends m{constructor(M){super(M,{isRenderable:!!M.data.hasOwnCanvas})}}class C extends m{constructor(M){super(M,{isRenderable:M.renderForms})}render(){const M=this.annotationStorage,P=this.data,J=P.id;let yt=M.getValue(J,{value:P.exportValue===P.fieldValue}).value;typeof yt=="string"&&(yt=yt!=="Off",M.setValue(J,{value:yt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const At=document.createElement("input");return z.add(At),At.setAttribute("data-element-id",J),At.disabled=P.readOnly,this._setRequired(At,this.data.required),At.type="checkbox",At.name=P.fieldName,yt&&At.setAttribute("checked",!0),At.setAttribute("exportValue",P.exportValue),At.tabIndex=N,At.addEventListener("change",xt=>{const{name:Bt,checked:te}=xt.target;for(const Kt of this._getElementsByName(Bt,J)){const qt=te&&Kt.exportValue===P.exportValue;Kt.domElement&&(Kt.domElement.checked=qt),M.setValue(Kt.id,{value:qt})}M.setValue(J,{value:te})}),At.addEventListener("resetform",xt=>{const Bt=P.defaultFieldValue||"Off";xt.target.checked=Bt===P.exportValue}),this.enableScripting&&this.hasJSActions&&(At.addEventListener("updatefromsandbox",xt=>{const Bt={value(te){te.target.checked=te.detail.value!=="Off",M.setValue(J,{value:te.target.checked})}};this._dispatchEventFromSandbox(Bt,xt)}),this._setEventListeners(At,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xt=>xt.target.checked)),this._setBackgroundColor(At),this._setDefaultPropertiesFromJS(At),this.container.append(At),this.container}}class a extends m{constructor(M){super(M,{isRenderable:M.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const M=this.annotationStorage,P=this.data,J=P.id;let yt=M.getValue(J,{value:P.fieldValue===P.buttonValue}).value;typeof yt=="string"&&(yt=yt!==P.buttonValue,M.setValue(J,{value:yt}));const At=document.createElement("input");if(z.add(At),At.setAttribute("data-element-id",J),At.disabled=P.readOnly,this._setRequired(At,this.data.required),At.type="radio",At.name=P.fieldName,yt&&At.setAttribute("checked",!0),At.tabIndex=N,At.addEventListener("change",xt=>{const{name:Bt,checked:te}=xt.target;for(const Kt of this._getElementsByName(Bt,J))M.setValue(Kt.id,{value:!1});M.setValue(J,{value:te})}),At.addEventListener("resetform",xt=>{const Bt=P.defaultFieldValue;xt.target.checked=Bt!=null&&Bt===P.buttonValue}),this.enableScripting&&this.hasJSActions){const xt=P.buttonValue;At.addEventListener("updatefromsandbox",Bt=>{const te={value:Kt=>{const qt=xt===Kt.detail.value;for(const _e of this._getElementsByName(Kt.target.name)){const Jt=qt&&_e.id===J;_e.domElement&&(_e.domElement.checked=Jt),M.setValue(_e.id,{value:Jt})}}};this._dispatchEventFromSandbox(te,Bt)}),this._setEventListeners(At,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Bt=>Bt.target.checked)}return this._setBackgroundColor(At),this._setDefaultPropertiesFromJS(At),this.container.append(At),this.container}}class u extends R{constructor(M){super(M,{ignoreBorder:M.data.hasAppearance})}render(){const M=super.render();M.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(M.title=this.data.alternativeText);const P=M.lastChild;return this.enableScripting&&this.hasJSActions&&P&&(this._setDefaultPropertiesFromJS(P),P.addEventListener("updatefromsandbox",J=>{this._dispatchEventFromSandbox({},J)})),M}}class o extends m{constructor(M){super(M,{isRenderable:M.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const M=this.annotationStorage,P=this.data.id,J=M.getValue(P,{value:this.data.fieldValue}),yt=document.createElement("select");z.add(yt),yt.setAttribute("data-element-id",P),yt.disabled=this.data.readOnly,this._setRequired(yt,this.data.required),yt.name=this.data.fieldName,yt.tabIndex=N;let At=this.data.combo&&this.data.options.length>0;this.data.combo||(yt.size=this.data.options.length,this.data.multiSelect&&(yt.multiple=!0)),yt.addEventListener("resetform",qt=>{const _e=this.data.defaultFieldValue;for(const Jt of yt.options)Jt.selected=Jt.value===_e});for(const qt of this.data.options){const _e=document.createElement("option");_e.textContent=qt.displayValue,_e.value=qt.exportValue,J.value.includes(qt.exportValue)&&(_e.setAttribute("selected",!0),At=!1),yt.append(_e)}let xt=null;if(At){const qt=document.createElement("option");qt.value=" ",qt.setAttribute("hidden",!0),qt.setAttribute("selected",!0),yt.prepend(qt),xt=()=>{qt.remove(),yt.removeEventListener("input",xt),xt=null},yt.addEventListener("input",xt)}const Bt=qt=>{const _e=qt?"value":"textContent",{options:Jt,multiple:ie}=yt;return ie?Array.prototype.filter.call(Jt,fe=>fe.selected).map(fe=>fe[_e]):Jt.selectedIndex===-1?null:Jt[Jt.selectedIndex][_e]};let te=Bt(!1);const Kt=qt=>{const _e=qt.target.options;return Array.prototype.map.call(_e,Jt=>({displayValue:Jt.textContent,exportValue:Jt.value}))};return this.enableScripting&&this.hasJSActions?(yt.addEventListener("updatefromsandbox",qt=>{const _e={value(Jt){xt==null||xt();const ie=Jt.detail.value,fe=new Set(Array.isArray(ie)?ie:[ie]);for(const we of yt.options)we.selected=fe.has(we.value);M.setValue(P,{value:Bt(!0)}),te=Bt(!1)},multipleSelection(Jt){yt.multiple=!0},remove(Jt){const ie=yt.options,fe=Jt.detail.remove;ie[fe].selected=!1,yt.remove(fe),ie.length>0&&Array.prototype.findIndex.call(ie,Fe=>Fe.selected)===-1&&(ie[0].selected=!0),M.setValue(P,{value:Bt(!0),items:Kt(Jt)}),te=Bt(!1)},clear(Jt){for(;yt.length!==0;)yt.remove(0);M.setValue(P,{value:null,items:[]}),te=Bt(!1)},insert(Jt){const{index:ie,displayValue:fe,exportValue:we}=Jt.detail.insert,Fe=yt.children[ie],je=document.createElement("option");je.textContent=fe,je.value=we,Fe?Fe.before(je):yt.append(je),M.setValue(P,{value:Bt(!0),items:Kt(Jt)}),te=Bt(!1)},items(Jt){const{items:ie}=Jt.detail;for(;yt.length!==0;)yt.remove(0);for(const fe of ie){const{displayValue:we,exportValue:Fe}=fe,je=document.createElement("option");je.textContent=we,je.value=Fe,yt.append(je)}yt.options.length>0&&(yt.options[0].selected=!0),M.setValue(P,{value:Bt(!0),items:Kt(Jt)}),te=Bt(!1)},indices(Jt){const ie=new Set(Jt.detail.indices);for(const fe of Jt.target.options)fe.selected=ie.has(fe.index);M.setValue(P,{value:Bt(!0)}),te=Bt(!1)},editable(Jt){Jt.target.disabled=!Jt.detail.editable}};this._dispatchEventFromSandbox(_e,qt)}),yt.addEventListener("input",qt=>{var Jt;const _e=Bt(!0);M.setValue(P,{value:_e}),qt.preventDefault(),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:te,changeEx:_e,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(yt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],qt=>qt.target.value)):yt.addEventListener("input",function(qt){M.setValue(P,{value:Bt(!0)})}),this.data.combo&&this._setTextStyle(yt),this._setBackgroundColor(yt),this._setDefaultPropertiesFromJS(yt),this.container.append(yt),this.container}}class c extends _{constructor(M){const{data:P,elements:J}=M;super(M,{isRenderable:_._hasPopupData(P)}),this.elements=J}render(){this.container.classList.add("popupAnnotation");const M=new h({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),P=[];for(const J of this.elements)J.popup=M,P.push(J.data.id),J.addHighlightArea();return this.container.setAttribute("aria-controls",P.map(J=>`${g.AnnotationPrefix}${J}`).join(",")),this.container}}class h{constructor({container:M,color:P,elements:J,titleObj:yt,modificationDate:At,contentsObj:xt,richText:Bt,parent:te,rect:Kt,parentRect:qt,open:_e}){gt(this,Ht);gt(this,vt,null);gt(this,St,tt(this,Ht,Gr).bind(this));gt(this,wt,tt(this,Ht,tr).bind(this));gt(this,Tt,tt(this,Ht,Qi).bind(this));gt(this,Ft,tt(this,Ht,ui).bind(this));gt(this,Lt,null);gt(this,ht,null);gt(this,dt,null);gt(this,S,null);gt(this,O,null);gt(this,nt,null);gt(this,ft,!1);gt(this,Ct,null);gt(this,Dt,null);gt(this,Rt,null);gt(this,et,null);gt(this,zt,!1);var ie;mt(this,ht,M),mt(this,et,yt),mt(this,dt,xt),mt(this,Rt,Bt),mt(this,O,te),mt(this,Lt,P),mt(this,Dt,Kt),mt(this,nt,qt),mt(this,S,J);const Jt=k.PDFDateString.toDateObject(At);Jt&&mt(this,vt,te.l10n.get("annotation_date_string",{date:Jt.toLocaleDateString(),time:Jt.toLocaleTimeString()})),this.trigger=J.flatMap(fe=>fe.getElementsToTriggerPopup());for(const fe of this.trigger)fe.addEventListener("click",t(this,Ft)),fe.addEventListener("mouseenter",t(this,Tt)),fe.addEventListener("mouseleave",t(this,wt)),fe.classList.add("popupTriggerArea");for(const fe of J)(ie=fe.container)==null||ie.addEventListener("keydown",t(this,St));t(this,ht).hidden=!0,_e&&tt(this,Ht,ui).call(this)}render(){if(t(this,Ct))return;const{page:{view:M},viewport:{rawDims:{pageWidth:P,pageHeight:J,pageX:yt,pageY:At}}}=t(this,O),xt=mt(this,Ct,document.createElement("div"));if(xt.className="popup",t(this,Lt)){const Ze=xt.style.outlineColor=g.Util.makeHexColor(...t(this,Lt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?xt.style.backgroundColor=`color-mix(in srgb, ${Ze} 30%, white)`:xt.style.backgroundColor=g.Util.makeHexColor(...t(this,Lt).map(_n=>Math.floor(.7*(255-_n)+_n)))}const Bt=document.createElement("span");Bt.className="header";const te=document.createElement("h1");if(Bt.append(te),{dir:te.dir,str:te.textContent}=t(this,et),xt.append(Bt),t(this,vt)){const Ze=document.createElement("span");Ze.classList.add("popupDate"),t(this,vt).then(vn=>{Ze.textContent=vn}),Bt.append(Ze)}const Kt=t(this,dt),qt=t(this,Rt);if(qt!=null&&qt.str&&(!(Kt!=null&&Kt.str)||Kt.str===qt.str))G.XfaLayer.render({xfaHtml:qt.html,intent:"richText",div:xt}),xt.lastChild.classList.add("richText","popupContent");else{const Ze=this._formatContents(Kt);xt.append(Ze)}let _e=!!t(this,nt),Jt=_e?t(this,nt):t(this,Dt);for(const Ze of t(this,S))if(!Jt||g.Util.intersect(Ze.data.rect,Jt)!==null){Jt=Ze.data.rect,_e=!0;break}const ie=g.Util.normalizeRect([Jt[0],M[3]-Jt[1]+M[1],Jt[2],M[3]-Jt[3]+M[1]]),we=_e?Jt[2]-Jt[0]+5:0,Fe=ie[0]+we,je=ie[1],{style:an}=t(this,ht);an.left=`${100*(Fe-yt)/P}%`,an.top=`${100*(je-At)/J}%`,t(this,ht).append(xt)}_formatContents({str:M,dir:P}){const J=document.createElement("p");J.classList.add("popupContent"),J.dir=P;const yt=M.split(/(?:\r\n?|\n)/);for(let At=0,xt=yt.length;At<xt;++At){const Bt=yt[At];J.append(document.createTextNode(Bt)),At<xt-1&&J.append(document.createElement("br"))}return J}forceHide(){mt(this,zt,this.isVisible),t(this,zt)&&(t(this,ht).hidden=!0)}maybeShow(){t(this,zt)&&(mt(this,zt,!1),t(this,ht).hidden=!1)}get isVisible(){return t(this,ht).hidden===!1}}vt=new WeakMap,St=new WeakMap,wt=new WeakMap,Tt=new WeakMap,Ft=new WeakMap,Lt=new WeakMap,ht=new WeakMap,dt=new WeakMap,S=new WeakMap,O=new WeakMap,nt=new WeakMap,ft=new WeakMap,Ct=new WeakMap,Dt=new WeakMap,Rt=new WeakMap,et=new WeakMap,zt=new WeakMap,Ht=new WeakSet,Gr=function(M){M.altKey||M.shiftKey||M.ctrlKey||M.metaKey||(M.key==="Enter"||M.key==="Escape"&&t(this,ft))&&tt(this,Ht,ui).call(this)},ui=function(){mt(this,ft,!t(this,ft)),t(this,ft)?(tt(this,Ht,Qi).call(this),t(this,ht).addEventListener("click",t(this,Ft)),t(this,ht).addEventListener("keydown",t(this,St))):(tt(this,Ht,tr).call(this),t(this,ht).removeEventListener("click",t(this,Ft)),t(this,ht).removeEventListener("keydown",t(this,St)))},Qi=function(){t(this,Ct)||this.render(),this.isVisible?t(this,ft)&&t(this,ht).classList.add("focused"):(t(this,ht).hidden=!1,t(this,ht).style.zIndex=parseInt(t(this,ht).style.zIndex)+1e3)},tr=function(){t(this,ht).classList.remove("focused"),!(t(this,ft)||!this.isVisible)&&(t(this,ht).hidden=!0,t(this,ht).style.zIndex=parseInt(t(this,ht).style.zIndex)-1e3)};class B extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0}),this.textContent=M.data.textContent,this.textPosition=M.data.textPosition,this.annotationEditorType=g.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const M=document.createElement("div");M.classList.add("annotationTextContent"),M.setAttribute("role","comment");for(const P of this.textContent){const J=document.createElement("span");J.textContent=P,M.append(J)}this.container.append(M)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}b.FreeTextAnnotationElement=B;class l extends _{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});gt(this,re,null)}render(){this.container.classList.add("lineAnnotation");const P=this.data,{width:J,height:yt}=W(P.rect),At=this.svgFactory.create(J,yt,!0),xt=mt(this,re,this.svgFactory.createElement("svg:line"));return xt.setAttribute("x1",P.rect[2]-P.lineCoordinates[0]),xt.setAttribute("y1",P.rect[3]-P.lineCoordinates[1]),xt.setAttribute("x2",P.rect[2]-P.lineCoordinates[2]),xt.setAttribute("y2",P.rect[3]-P.lineCoordinates[3]),xt.setAttribute("stroke-width",P.borderStyle.width||1),xt.setAttribute("stroke","transparent"),xt.setAttribute("fill","transparent"),At.append(xt),this.container.append(At),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,re)}addHighlightArea(){this.container.classList.add("highlightArea")}}re=new WeakMap;class w extends _{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});gt(this,Ae,null)}render(){this.container.classList.add("squareAnnotation");const P=this.data,{width:J,height:yt}=W(P.rect),At=this.svgFactory.create(J,yt,!0),xt=P.borderStyle.width,Bt=mt(this,Ae,this.svgFactory.createElement("svg:rect"));return Bt.setAttribute("x",xt/2),Bt.setAttribute("y",xt/2),Bt.setAttribute("width",J-xt),Bt.setAttribute("height",yt-xt),Bt.setAttribute("stroke-width",xt||1),Bt.setAttribute("stroke","transparent"),Bt.setAttribute("fill","transparent"),At.append(Bt),this.container.append(At),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Ae)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ae=new WeakMap;class I extends _{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});gt(this,Ie,null)}render(){this.container.classList.add("circleAnnotation");const P=this.data,{width:J,height:yt}=W(P.rect),At=this.svgFactory.create(J,yt,!0),xt=P.borderStyle.width,Bt=mt(this,Ie,this.svgFactory.createElement("svg:ellipse"));return Bt.setAttribute("cx",J/2),Bt.setAttribute("cy",yt/2),Bt.setAttribute("rx",J/2-xt/2),Bt.setAttribute("ry",yt/2-xt/2),Bt.setAttribute("stroke-width",xt||1),Bt.setAttribute("stroke","transparent"),Bt.setAttribute("fill","transparent"),At.append(Bt),this.container.append(At),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Ie)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ie=new WeakMap;class bt extends _{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});gt(this,kt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:J,height:yt}=W(P.rect),At=this.svgFactory.create(J,yt,!0);let xt=[];for(const te of P.vertices){const Kt=te.x-P.rect[0],qt=P.rect[3]-te.y;xt.push(Kt+","+qt)}xt=xt.join(" ");const Bt=mt(this,kt,this.svgFactory.createElement(this.svgElementName));return Bt.setAttribute("points",xt),Bt.setAttribute("stroke-width",P.borderStyle.width||1),Bt.setAttribute("stroke","transparent"),Bt.setAttribute("fill","transparent"),At.append(Bt),this.container.append(At),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,kt)}addHighlightArea(){this.container.classList.add("highlightArea")}}kt=new WeakMap;class K extends bt{constructor(M){super(M),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rt extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class X extends _{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});gt(this,st,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=g.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:J,height:yt}=W(P.rect),At=this.svgFactory.create(J,yt,!0);for(const xt of P.inkLists){let Bt=[];for(const Kt of xt){const qt=Kt.x-P.rect[0],_e=P.rect[3]-Kt.y;Bt.push(`${qt},${_e}`)}Bt=Bt.join(" ");const te=this.svgFactory.createElement(this.svgElementName);t(this,st).push(te),te.setAttribute("points",Bt),te.setAttribute("stroke-width",P.borderStyle.width||1),te.setAttribute("stroke","transparent"),te.setAttribute("fill","transparent"),!P.popupRef&&this.hasPopupData&&this._createPopup(),At.append(te)}return this.container.append(At),this.container}getElementsToTriggerPopup(){return t(this,st)}addHighlightArea(){this.container.classList.add("highlightArea")}}st=new WeakMap,b.InkAnnotationElement=X;class _t extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class x extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $ extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ct extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class T extends _{constructor(M){super(M,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}b.StampAnnotationElement=T;class i extends _{constructor(P){var At;super(P,{isRenderable:!0});gt(this,$t);gt(this,ot,null);const{filename:J,content:yt}=this.data.file;this.filename=(0,k.getFilenameFromUrl)(J,!0),this.content=yt,(At=this.linkService.eventBus)==null||At.dispatch("fileattachmentannotation",{source:this,filename:J,content:yt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:P,data:J}=this;let yt;J.hasAppearance||J.fillAlpha===0?yt=document.createElement("div"):(yt=document.createElement("img"),yt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(J.name)?"paperclip":"pushpin"}.svg`,J.fillAlpha&&J.fillAlpha<1&&(yt.style=`filter: opacity(${Math.round(J.fillAlpha*100)}%);`)),yt.addEventListener("dblclick",tt(this,$t,er).bind(this)),mt(this,ot,yt);const{isMac:At}=g.FeatureTest.platform;return P.addEventListener("keydown",xt=>{xt.key==="Enter"&&(At?xt.metaKey:xt.ctrlKey)&&tt(this,$t,er).call(this)}),!J.popupRef&&this.hasPopupData?this._createPopup():yt.classList.add("popupTriggerArea"),P.append(yt),P}getElementsToTriggerPopup(){return t(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap,$t=new WeakSet,er=function(){var P;(P=this.downloadManager)==null||P.openOrDownloadData(this.container,this.content,this.filename)};class r{constructor({div:M,accessibilityManager:P,annotationCanvasMap:J,l10n:yt,page:At,viewport:xt}){gt(this,Wt);gt(this,le,null);gt(this,U,null);gt(this,Pt,new Map);this.div=M,mt(this,le,P),mt(this,U,J),this.l10n=yt,this.page=At,this.viewport=xt,this.zIndex=0,this.l10n||(this.l10n=Mt.NullL10n)}async render(M){const{annotations:P}=M,J=this.div;(0,k.setLayerDimensions)(J,this.viewport);const yt=new Map,At={data:null,layer:J,linkService:M.linkService,downloadManager:M.downloadManager,imageResourcesPath:M.imageResourcesPath||"",renderForms:M.renderForms!==!1,svgFactory:new k.DOMSVGFactory,annotationStorage:M.annotationStorage||new e.AnnotationStorage,enableScripting:M.enableScripting===!0,hasJSActions:M.hasJSActions,fieldObjects:M.fieldObjects,parent:this,elements:null};for(const xt of P){if(xt.noHTML)continue;const Bt=xt.annotationType===g.AnnotationType.POPUP;if(Bt){const qt=yt.get(xt.id);if(!qt)continue;At.elements=qt}else{const{width:qt,height:_e}=W(xt.rect);if(qt<=0||_e<=0)continue}At.data=xt;const te=A.create(At);if(!te.isRenderable)continue;if(!Bt&&xt.popupRef){const qt=yt.get(xt.popupRef);qt?qt.push(te):yt.set(xt.popupRef,[te])}te.annotationEditorType>0&&t(this,Pt).set(te.data.id,te);const Kt=te.render();xt.hidden&&(Kt.style.visibility="hidden"),tt(this,Wt,Xr).call(this,Kt,xt.id)}tt(this,Wt,nr).call(this),await this.l10n.translate(J)}update({viewport:M}){const P=this.div;this.viewport=M,(0,k.setLayerDimensions)(P,{rotation:M.rotation}),tt(this,Wt,nr).call(this),P.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Pt).values())}getEditableAnnotation(M){return t(this,Pt).get(M)}}le=new WeakMap,U=new WeakMap,Pt=new WeakMap,Wt=new WeakSet,Xr=function(M,P){var yt;const J=M.firstChild||M;J.id=`${g.AnnotationPrefix}${P}`,this.div.append(M),(yt=t(this,le))==null||yt.moveElementInDOM(this.div,M,J,!1)},nr=function(){if(!t(this,U))return;const M=this.div;for(const[P,J]of t(this,U)){const yt=M.querySelector(`[data-annotation-id="${P}"]`);if(!yt)continue;const{firstChild:At}=yt;At?At.nodeName==="CANVAS"?At.replaceWith(J):At.before(J):yt.append(J)}t(this,U).clear()},b.AnnotationLayer=r},(d,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ColorConverters=void 0;function Et(e){return Math.floor(Math.max(0,Math.min(1,e))*255).toString(16).padStart(2,"0")}function g(e){return Math.max(0,Math.min(255,255*e))}class k{static CMYK_G([it,Mt,G,N]){return["G",1-Math.min(1,.3*it+.59*G+.11*Mt+N)]}static G_CMYK([it]){return["CMYK",0,0,0,1-it]}static G_RGB([it]){return["RGB",it,it,it]}static G_rgb([it]){return it=g(it),[it,it,it]}static G_HTML([it]){const Mt=Et(it);return`#${Mt}${Mt}${Mt}`}static RGB_G([it,Mt,G]){return["G",.3*it+.59*Mt+.11*G]}static RGB_rgb(it){return it.map(g)}static RGB_HTML(it){return`#${it.map(Et).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([it,Mt,G,N]){return["RGB",1-Math.min(1,it+N),1-Math.min(1,G+N),1-Math.min(1,Mt+N)]}static CMYK_rgb([it,Mt,G,N]){return[g(1-Math.min(1,it+N)),g(1-Math.min(1,G+N)),g(1-Math.min(1,Mt+N))]}static CMYK_HTML(it){const Mt=this.CMYK_RGB(it).slice(1);return this.RGB_HTML(Mt)}static RGB_CMYK([it,Mt,G]){const N=1-it,f=1-Mt,z=1-G,W=Math.min(N,f,z);return["CMYK",N,f,z,W]}}b.ColorConverters=k},(d,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NullL10n=void 0,b.getL10nFallback=g;const Et={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};Et.print_progress_percent="{{progress}}%";function g(it,Mt){switch(it){case"find_match_count":it=`find_match_count[${Mt.total===1?"one":"other"}]`;break;case"find_match_count_limit":it=`find_match_count_limit[${Mt.limit===1?"one":"other"}]`;break}return Et[it]||""}function k(it,Mt){return Mt?it.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(G,N)=>N in Mt?Mt[N]:"{{"+N+"}}"):it}const e={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(it,Mt=null,G=g(it,Mt)){return k(G,Mt)},async translate(it){}};b.NullL10n=e},(d,b,Et)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.XfaLayer=void 0;var g=Et(25);class k{static setupStorage(it,Mt,G,N,f){const z=N.getValue(Mt,{value:null});switch(G.name){case"textarea":if(z.value!==null&&(it.textContent=z.value),f==="print")break;it.addEventListener("input",W=>{N.setValue(Mt,{value:W.target.value})});break;case"input":if(G.attributes.type==="radio"||G.attributes.type==="checkbox"){if(z.value===G.attributes.xfaOn?it.setAttribute("checked",!0):z.value===G.attributes.xfaOff&&it.removeAttribute("checked"),f==="print")break;it.addEventListener("change",W=>{N.setValue(Mt,{value:W.target.checked?W.target.getAttribute("xfaOn"):W.target.getAttribute("xfaOff")})})}else{if(z.value!==null&&it.setAttribute("value",z.value),f==="print")break;it.addEventListener("input",W=>{N.setValue(Mt,{value:W.target.value})})}break;case"select":if(z.value!==null){it.setAttribute("value",z.value);for(const W of G.children)W.attributes.value===z.value?W.attributes.selected=!0:W.attributes.hasOwnProperty("selected")&&delete W.attributes.selected}it.addEventListener("input",W=>{const A=W.target.options,_=A.selectedIndex===-1?"":A[A.selectedIndex].value;N.setValue(Mt,{value:_})});break}}static setAttributes({html:it,element:Mt,storage:G=null,intent:N,linkService:f}){const{attributes:z}=Mt,W=it instanceof HTMLAnchorElement;z.type==="radio"&&(z.name=`${z.name}-${N}`);for(const[A,_]of Object.entries(z))if(_!=null)switch(A){case"class":_.length&&it.setAttribute(A,_.join(" "));break;case"dataId":break;case"id":it.setAttribute("data-element-id",_);break;case"style":Object.assign(it.style,_);break;case"textContent":it.textContent=_;break;default:(!W||A!=="href"&&A!=="newWindow")&&it.setAttribute(A,_)}W&&f.addLinkAttributes(it,z.href,z.newWindow),G&&z.dataId&&this.setupStorage(it,z.dataId,Mt,G)}static render(it){var R;const Mt=it.annotationStorage,G=it.linkService,N=it.xfaHtml,f=it.intent||"display",z=document.createElement(N.name);N.attributes&&this.setAttributes({html:z,element:N,intent:f,linkService:G});const W=[[N,-1,z]],A=it.div;if(A.append(z),it.viewport){const y=`matrix(${it.viewport.transform.join(",")})`;A.style.transform=y}f!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const _=[];for(;W.length>0;){const[y,m,E]=W.at(-1);if(m+1===y.children.length){W.pop();continue}const H=y.children[++W.at(-1)[1]];if(H===null)continue;const{name:C}=H;if(C==="#text"){const u=document.createTextNode(H.value);_.push(u),E.append(u);continue}const a=(R=H==null?void 0:H.attributes)!=null&&R.xmlns?document.createElementNS(H.attributes.xmlns,C):document.createElement(C);if(E.append(a),H.attributes&&this.setAttributes({html:a,element:H,storage:Mt,intent:f,linkService:G}),H.children&&H.children.length>0)W.push([H,-1,a]);else if(H.value){const u=document.createTextNode(H.value);g.XfaText.shouldBuildText(C)&&_.push(u),a.append(u)}}for(const y of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:_}}static update(it){const Mt=`matrix(${it.viewport.transform.join(",")})`;it.div.style.transform=Mt,it.div.hidden=!1}}b.XfaLayer=k},(d,b,Et)=>{var N,f,z,W,A,_,R,y,m,E,H,C,a,u,o,$r,Yr,Kr,Jr,ir,Zr,rr,Qr,ts,es,ns,is,En,sr,di,fi,Bn,ar,pi,D,rs,or,ss,as,lr,gi,Hn;Object.defineProperty(b,"__esModule",{value:!0}),b.InkEditor=void 0;var g=Et(1),k=Et(4),e=Et(29),it=Et(6),Mt=Et(5);const Lt=class Lt extends k.AnnotationEditor{constructor(S){super({...S,name:"inkEditor"});gt(this,o);gt(this,N,0);gt(this,f,0);gt(this,z,this.canvasPointermove.bind(this));gt(this,W,this.canvasPointerleave.bind(this));gt(this,A,this.canvasPointerup.bind(this));gt(this,_,this.canvasPointerdown.bind(this));gt(this,R,new Path2D);gt(this,y,!1);gt(this,m,!1);gt(this,E,!1);gt(this,H,null);gt(this,C,0);gt(this,a,0);gt(this,u,null);this.color=S.color||null,this.thickness=S.thickness||null,this.opacity=S.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(S){k.AnnotationEditor.initialize(S,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(S,O){switch(S){case g.AnnotationEditorParamsType.INK_THICKNESS:Lt._defaultThickness=O;break;case g.AnnotationEditorParamsType.INK_COLOR:Lt._defaultColor=O;break;case g.AnnotationEditorParamsType.INK_OPACITY:Lt._defaultOpacity=O/100;break}}updateParams(S,O){switch(S){case g.AnnotationEditorParamsType.INK_THICKNESS:tt(this,o,$r).call(this,O);break;case g.AnnotationEditorParamsType.INK_COLOR:tt(this,o,Yr).call(this,O);break;case g.AnnotationEditorParamsType.INK_OPACITY:tt(this,o,Kr).call(this,O);break}}static get defaultPropertiesToUpdate(){return[[g.AnnotationEditorParamsType.INK_THICKNESS,Lt._defaultThickness],[g.AnnotationEditorParamsType.INK_COLOR,Lt._defaultColor||k.AnnotationEditor._defaultLineColor],[g.AnnotationEditorParamsType.INK_OPACITY,Math.round(Lt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[g.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Lt._defaultThickness],[g.AnnotationEditorParamsType.INK_COLOR,this.color||Lt._defaultColor||k.AnnotationEditor._defaultLineColor],[g.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Lt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(tt(this,o,di).call(this),tt(this,o,fi).call(this)),this.isAttachedToDOM||(this.parent.add(this),tt(this,o,Bn).call(this)),tt(this,o,Hn).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,H).disconnect(),mt(this,H,null),super.remove())}setParent(S){!this.parent&&S?this._uiManager.removeShouldRescale(this):this.parent&&S===null&&this._uiManager.addShouldRescale(this),super.setParent(S)}onScaleChanging(){const[S,O]=this.parentDimensions,nt=this.width*S,ft=this.height*O;this.setDimensions(nt,ft)}enableEditMode(){t(this,y)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,_)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,_)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,y)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),mt(this,y,!0),this.div.classList.add("disabled"),tt(this,o,Hn).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(S){this._focusEventsAllowed&&(super.focusin(S),this.enableEditMode())}canvasPointerdown(S){S.button!==0||!this.isInEditMode()||t(this,y)||(this.setInForeground(),S.preventDefault(),S.type!=="mouse"&&this.div.focus(),tt(this,o,Zr).call(this,S.offsetX,S.offsetY))}canvasPointermove(S){S.preventDefault(),tt(this,o,rr).call(this,S.offsetX,S.offsetY)}canvasPointerup(S){S.preventDefault(),tt(this,o,sr).call(this,S)}canvasPointerleave(S){tt(this,o,sr).call(this,S)}get isResizable(){return!this.isEmpty()&&t(this,y)}render(){if(this.div)return this.div;let S,O;this.width&&(S=this.x,O=this.y),super.render(),k.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Rt=>{var et;return(et=this.div)==null?void 0:et.setAttribute("aria-label",Rt)});const[nt,ft,Ct,Dt]=tt(this,o,Jr).call(this);if(this.setAt(nt,ft,0,0),this.setDims(Ct,Dt),tt(this,o,di).call(this),this.width){const[Rt,et]=this.parentDimensions;this.setAspectRatio(this.width*Rt,this.height*et),this.setAt(S*Rt,O*et,this.width*Rt,this.height*et),mt(this,E,!0),tt(this,o,Bn).call(this),this.setDims(this.width*Rt,this.height*et),tt(this,o,En).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return tt(this,o,fi).call(this),this.div}setDimensions(S,O){const nt=Math.round(S),ft=Math.round(O);if(t(this,C)===nt&&t(this,a)===ft)return;mt(this,C,nt),mt(this,a,ft),this.canvas.style.visibility="hidden";const[Ct,Dt]=this.parentDimensions;this.width=S/Ct,this.height=O/Dt,this.fixAndSetPosition(),t(this,y)&&tt(this,o,ar).call(this,S,O),tt(this,o,Bn).call(this),tt(this,o,En).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(S,O,nt){var re,Ae,Ie;if(S instanceof e.InkAnnotationElement)return null;const ft=super.deserialize(S,O,nt);ft.thickness=S.thickness,ft.color=g.Util.makeHexColor(...S.color),ft.opacity=S.opacity;const[Ct,Dt]=ft.pageDimensions,Rt=ft.width*Ct,et=ft.height*Dt,zt=ft.parentScale,Ht=S.thickness/2;mt(ft,y,!0),mt(ft,C,Math.round(Rt)),mt(ft,a,Math.round(et));const{paths:me,rect:ce,rotation:Te}=S;for(let{bezier:kt}of me){kt=tt(re=Lt,D,ss).call(re,kt,ce,Te);const st=[];ft.paths.push(st);let ot=zt*(kt[0]-Ht),$t=zt*(kt[1]-Ht);for(let le=2,U=kt.length;le<U;le+=6){const Pt=zt*(kt[le]-Ht),Wt=zt*(kt[le+1]-Ht),Qt=zt*(kt[le+2]-Ht),ne=zt*(kt[le+3]-Ht),Xt=zt*(kt[le+4]-Ht),M=zt*(kt[le+5]-Ht);st.push([[ot,$t],[Pt,Wt],[Qt,ne],[Xt,M]]),ot=Xt,$t=M}const Zt=tt(this,D,rs).call(this,st);ft.bezierPath2D.push(Zt)}const Yt=tt(Ae=ft,o,lr).call(Ae);return mt(ft,f,Math.max(k.AnnotationEditor.MIN_SIZE,Yt[2]-Yt[0])),mt(ft,N,Math.max(k.AnnotationEditor.MIN_SIZE,Yt[3]-Yt[1])),tt(Ie=ft,o,ar).call(Ie,Rt,et),ft}serialize(){if(this.isEmpty())return null;const S=this.getRect(0,0),O=k.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:g.AnnotationEditorType.INK,color:O,thickness:this.thickness,opacity:this.opacity,paths:tt(this,o,as).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,S),pageIndex:this.pageIndex,rect:S,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};N=new WeakMap,f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakMap,E=new WeakMap,H=new WeakMap,C=new WeakMap,a=new WeakMap,u=new WeakMap,o=new WeakSet,$r=function(S){const O=this.thickness;this.addCommands({cmd:()=>{this.thickness=S,tt(this,o,Hn).call(this)},undo:()=>{this.thickness=O,tt(this,o,Hn).call(this)},mustExec:!0,type:g.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Yr=function(S){const O=this.color;this.addCommands({cmd:()=>{this.color=S,tt(this,o,En).call(this)},undo:()=>{this.color=O,tt(this,o,En).call(this)},mustExec:!0,type:g.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Kr=function(S){S/=100;const O=this.opacity;this.addCommands({cmd:()=>{this.opacity=S,tt(this,o,En).call(this)},undo:()=>{this.opacity=O,tt(this,o,En).call(this)},mustExec:!0,type:g.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Jr=function(){const{parentRotation:S,parentDimensions:[O,nt]}=this;switch(S){case 90:return[0,nt,nt,O];case 180:return[O,nt,O,nt];case 270:return[O,0,nt,O];default:return[0,0,O,nt]}},ir=function(){const{ctx:S,color:O,opacity:nt,thickness:ft,parentScale:Ct,scaleFactor:Dt}=this;S.lineWidth=ft*Ct/Dt,S.lineCap="round",S.lineJoin="round",S.miterLimit=10,S.strokeStyle=`${O}${(0,Mt.opacityToHex)(nt)}`},Zr=function(S,O){this.canvas.addEventListener("contextmenu",it.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,W)),this.canvas.addEventListener("pointermove",t(this,z)),this.canvas.addEventListener("pointerup",t(this,A)),this.canvas.removeEventListener("pointerdown",t(this,_)),this.isEditing=!0,t(this,E)||(mt(this,E,!0),tt(this,o,Bn).call(this),this.thickness||(this.thickness=Lt._defaultThickness),this.color||(this.color=Lt._defaultColor||k.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Lt._defaultOpacity)),this.currentPath.push([S,O]),mt(this,m,!1),tt(this,o,ir).call(this),mt(this,u,()=>{tt(this,o,es).call(this),t(this,u)&&window.requestAnimationFrame(t(this,u))}),window.requestAnimationFrame(t(this,u))},rr=function(S,O){const[nt,ft]=this.currentPath.at(-1);if(this.currentPath.length>1&&S===nt&&O===ft)return;const Ct=this.currentPath;let Dt=t(this,R);if(Ct.push([S,O]),mt(this,m,!0),Ct.length<=2){Dt.moveTo(...Ct[0]),Dt.lineTo(S,O);return}Ct.length===3&&(mt(this,R,Dt=new Path2D),Dt.moveTo(...Ct[0])),tt(this,o,ns).call(this,Dt,...Ct.at(-3),...Ct.at(-2),S,O)},Qr=function(){if(this.currentPath.length===0)return;const S=this.currentPath.at(-1);t(this,R).lineTo(...S)},ts=function(S,O){mt(this,u,null),S=Math.min(Math.max(S,0),this.canvas.width),O=Math.min(Math.max(O,0),this.canvas.height),tt(this,o,rr).call(this,S,O),tt(this,o,Qr).call(this);let nt;if(this.currentPath.length!==1)nt=tt(this,o,is).call(this);else{const et=[S,O];nt=[[et,et.slice(),et.slice(),et]]}const ft=t(this,R),Ct=this.currentPath;this.currentPath=[],mt(this,R,new Path2D);const Dt=()=>{this.allRawPaths.push(Ct),this.paths.push(nt),this.bezierPath2D.push(ft),this.rebuild()},Rt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(tt(this,o,di).call(this),tt(this,o,fi).call(this)),tt(this,o,Hn).call(this))};this.addCommands({cmd:Dt,undo:Rt,mustExec:!0})},es=function(){if(!t(this,m))return;mt(this,m,!1);const S=Math.ceil(this.thickness*this.parentScale),O=this.currentPath.slice(-3),nt=O.map(Dt=>Dt[0]),ft=O.map(Dt=>Dt[1]);Math.min(...nt)-S,Math.max(...nt)+S,Math.min(...ft)-S,Math.max(...ft)+S;const{ctx:Ct}=this;Ct.save(),Ct.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Dt of this.bezierPath2D)Ct.stroke(Dt);Ct.stroke(t(this,R)),Ct.restore()},ns=function(S,O,nt,ft,Ct,Dt,Rt){const et=(O+ft)/2,zt=(nt+Ct)/2,Ht=(ft+Dt)/2,me=(Ct+Rt)/2;S.bezierCurveTo(et+2*(ft-et)/3,zt+2*(Ct-zt)/3,Ht+2*(ft-Ht)/3,me+2*(Ct-me)/3,Ht,me)},is=function(){const S=this.currentPath;if(S.length<=2)return[[S[0],S[0],S.at(-1),S.at(-1)]];const O=[];let nt,[ft,Ct]=S[0];for(nt=1;nt<S.length-2;nt++){const[ce,Te]=S[nt],[Yt,re]=S[nt+1],Ae=(ce+Yt)/2,Ie=(Te+re)/2,kt=[ft+2*(ce-ft)/3,Ct+2*(Te-Ct)/3],st=[Ae+2*(ce-Ae)/3,Ie+2*(Te-Ie)/3];O.push([[ft,Ct],kt,st,[Ae,Ie]]),[ft,Ct]=[Ae,Ie]}const[Dt,Rt]=S[nt],[et,zt]=S[nt+1],Ht=[ft+2*(Dt-ft)/3,Ct+2*(Rt-Ct)/3],me=[et+2*(Dt-et)/3,zt+2*(Rt-zt)/3];return O.push([[ft,Ct],Ht,me,[et,zt]]),O},En=function(){if(this.isEmpty()){tt(this,o,pi).call(this);return}tt(this,o,ir).call(this);const{canvas:S,ctx:O}=this;O.setTransform(1,0,0,1,0,0),O.clearRect(0,0,S.width,S.height),tt(this,o,pi).call(this);for(const nt of this.bezierPath2D)O.stroke(nt)},sr=function(S){this.canvas.removeEventListener("pointerleave",t(this,W)),this.canvas.removeEventListener("pointermove",t(this,z)),this.canvas.removeEventListener("pointerup",t(this,A)),this.canvas.addEventListener("pointerdown",t(this,_)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",it.noContextMenu)},10),tt(this,o,ts).call(this,S.offsetX,S.offsetY),this.addToAnnotationStorage(),this.setInBackground()},di=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",k.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(S=>{var O;return(O=this.canvas)==null?void 0:O.setAttribute("aria-label",S)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},fi=function(){mt(this,H,new ResizeObserver(S=>{const O=S[0].contentRect;O.width&&O.height&&this.setDimensions(O.width,O.height)})),t(this,H).observe(this.div)},Bn=function(){if(!t(this,E))return;const[S,O]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*S),this.canvas.height=Math.ceil(this.height*O),tt(this,o,pi).call(this)},ar=function(S,O){const nt=tt(this,o,gi).call(this),ft=(S-nt)/t(this,f),Ct=(O-nt)/t(this,N);this.scaleFactor=Math.min(ft,Ct)},pi=function(){const S=tt(this,o,gi).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+S,this.translationY*this.scaleFactor+S)},D=new WeakSet,rs=function(S){const O=new Path2D;for(let nt=0,ft=S.length;nt<ft;nt++){const[Ct,Dt,Rt,et]=S[nt];nt===0&&O.moveTo(...Ct),O.bezierCurveTo(Dt[0],Dt[1],Rt[0],Rt[1],et[0],et[1])}return O},or=function(S,O,nt){const[ft,Ct,Dt,Rt]=O;switch(nt){case 0:for(let et=0,zt=S.length;et<zt;et+=2)S[et]+=ft,S[et+1]=Rt-S[et+1];break;case 90:for(let et=0,zt=S.length;et<zt;et+=2){const Ht=S[et];S[et]=S[et+1]+ft,S[et+1]=Ht+Ct}break;case 180:for(let et=0,zt=S.length;et<zt;et+=2)S[et]=Dt-S[et],S[et+1]+=Ct;break;case 270:for(let et=0,zt=S.length;et<zt;et+=2){const Ht=S[et];S[et]=Dt-S[et+1],S[et+1]=Rt-Ht}break;default:throw new Error("Invalid rotation")}return S},ss=function(S,O,nt){const[ft,Ct,Dt,Rt]=O;switch(nt){case 0:for(let et=0,zt=S.length;et<zt;et+=2)S[et]-=ft,S[et+1]=Rt-S[et+1];break;case 90:for(let et=0,zt=S.length;et<zt;et+=2){const Ht=S[et];S[et]=S[et+1]-Ct,S[et+1]=Ht-ft}break;case 180:for(let et=0,zt=S.length;et<zt;et+=2)S[et]=Dt-S[et],S[et+1]-=Ct;break;case 270:for(let et=0,zt=S.length;et<zt;et+=2){const Ht=S[et];S[et]=Rt-S[et+1],S[et+1]=Dt-Ht}break;default:throw new Error("Invalid rotation")}return S},as=function(S,O,nt,ft){var zt,Ht;const Ct=[],Dt=this.thickness/2,Rt=S*O+Dt,et=S*nt+Dt;for(const me of this.paths){const ce=[],Te=[];for(let Yt=0,re=me.length;Yt<re;Yt++){const[Ae,Ie,kt,st]=me[Yt],ot=S*Ae[0]+Rt,$t=S*Ae[1]+et,Zt=S*Ie[0]+Rt,le=S*Ie[1]+et,U=S*kt[0]+Rt,Pt=S*kt[1]+et,Wt=S*st[0]+Rt,Qt=S*st[1]+et;Yt===0&&(ce.push(ot,$t),Te.push(ot,$t)),ce.push(Zt,le,U,Pt,Wt,Qt),Te.push(Zt,le),Yt===re-1&&Te.push(Wt,Qt)}Ct.push({bezier:tt(zt=Lt,D,or).call(zt,ce,ft,this.rotation),points:tt(Ht=Lt,D,or).call(Ht,Te,ft,this.rotation)})}return Ct},lr=function(){let S=1/0,O=-1/0,nt=1/0,ft=-1/0;for(const Ct of this.paths)for(const[Dt,Rt,et,zt]of Ct){const Ht=g.Util.bezierBoundingBox(...Dt,...Rt,...et,...zt);S=Math.min(S,Ht[0]),nt=Math.min(nt,Ht[1]),O=Math.max(O,Ht[2]),ft=Math.max(ft,Ht[3])}return[S,nt,O,ft]},gi=function(){return t(this,y)?Math.ceil(this.thickness*this.parentScale):0},Hn=function(S=!1){if(this.isEmpty())return;if(!t(this,y)){tt(this,o,En).call(this);return}const O=tt(this,o,lr).call(this),nt=tt(this,o,gi).call(this);mt(this,f,Math.max(k.AnnotationEditor.MIN_SIZE,O[2]-O[0])),mt(this,N,Math.max(k.AnnotationEditor.MIN_SIZE,O[3]-O[1]));const ft=Math.ceil(nt+t(this,f)*this.scaleFactor),Ct=Math.ceil(nt+t(this,N)*this.scaleFactor),[Dt,Rt]=this.parentDimensions;this.width=ft/Dt,this.height=Ct/Rt,this.setAspectRatio(ft,Ct);const et=this.translationX,zt=this.translationY;this.translationX=-O[0],this.translationY=-O[1],tt(this,o,Bn).call(this),tt(this,o,En).call(this),mt(this,C,ft),mt(this,a,Ct),this.setDims(ft,Ct);const Ht=S?nt/this.scaleFactor/2:0;this.translate(et-this.translationX-Ht,zt-this.translationY-Ht)},gt(Lt,D),Xe(Lt,"_defaultColor",null),Xe(Lt,"_defaultOpacity",1),Xe(Lt,"_defaultThickness",1),Xe(Lt,"_type","ink");let G=Lt;b.InkEditor=G},(d,b,Et)=>{var G,N,f,z,W,A,_,R,y,m,E,$n,Yn,mi,cr,os,ls,hr,vi,cs;Object.defineProperty(b,"__esModule",{value:!0}),b.StampEditor=void 0;var g=Et(1),k=Et(4),e=Et(6),it=Et(29);const w=class w extends k.AnnotationEditor{constructor(K){super({...K,name:"stampEditor"});gt(this,E);gt(this,G,null);gt(this,N,null);gt(this,f,null);gt(this,z,null);gt(this,W,null);gt(this,A,null);gt(this,_,null);gt(this,R,null);gt(this,y,!1);gt(this,m,!1);mt(this,z,K.bitmapUrl),mt(this,W,K.bitmapFile)}static initialize(K){k.AnnotationEditor.initialize(K)}static get supportedTypes(){const K=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,g.shadow)(this,"supportedTypes",K.map(rt=>`image/${rt}`))}static get supportedTypesStr(){return(0,g.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(K){return this.supportedTypes.includes(K)}static paste(K,rt){rt.pasteEditor(g.AnnotationEditorType.STAMP,{bitmapFile:K.getAsFile()})}remove(){var K,rt;t(this,N)&&(mt(this,G,null),this._uiManager.imageManager.deleteId(t(this,N)),(K=t(this,A))==null||K.remove(),mt(this,A,null),(rt=t(this,_))==null||rt.disconnect(),mt(this,_,null)),super.remove()}rebuild(){if(!this.parent){t(this,N)&&tt(this,E,mi).call(this);return}super.rebuild(),this.div!==null&&(t(this,N)&&tt(this,E,mi).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,f)||t(this,G)||t(this,z)||t(this,W))}get isResizable(){return!0}render(){if(this.div)return this.div;let K,rt;if(this.width&&(K=this.x,rt=this.y),super.render(),this.div.hidden=!0,t(this,G)?tt(this,E,cr).call(this):tt(this,E,mi).call(this),this.width){const[X,_t]=this.parentDimensions;this.setAt(K*X,rt*_t,this.width*X,this.height*_t)}return this.div}static deserialize(K,rt,X){if(K instanceof it.StampAnnotationElement)return null;const _t=super.deserialize(K,rt,X),{rect:x,bitmapUrl:$,bitmapId:ct,isSvg:T,accessibilityData:i}=K;ct&&X.imageManager.isValidId(ct)?mt(_t,N,ct):mt(_t,z,$),mt(_t,y,T);const[r,v]=_t.pageDimensions;return _t.width=(x[2]-x[0])/r,_t.height=(x[3]-x[1])/v,i&&(_t.altTextData=i),_t}serialize(K=!1,rt=null){if(this.isEmpty())return null;const X={annotationType:g.AnnotationEditorType.STAMP,bitmapId:t(this,N),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,y),structTreeParentId:this._structTreeParentId};if(K)return X.bitmapUrl=tt(this,E,vi).call(this,!0),X.accessibilityData=this.altTextData,X;const{decorative:_t,altText:x}=this.altTextData;if(!_t&&x&&(X.accessibilityData={type:"Figure",alt:x}),rt===null)return X;rt.stamps||(rt.stamps=new Map);const $=t(this,y)?(X.rect[2]-X.rect[0])*(X.rect[3]-X.rect[1]):null;if(!rt.stamps.has(t(this,N)))rt.stamps.set(t(this,N),{area:$,serialized:X}),X.bitmap=tt(this,E,vi).call(this,!1);else if(t(this,y)){const ct=rt.stamps.get(t(this,N));$>ct.area&&(ct.area=$,ct.serialized.bitmap.close(),ct.serialized.bitmap=tt(this,E,vi).call(this,!1))}return X}};G=new WeakMap,N=new WeakMap,f=new WeakMap,z=new WeakMap,W=new WeakMap,A=new WeakMap,_=new WeakMap,R=new WeakMap,y=new WeakMap,m=new WeakMap,E=new WeakSet,$n=function(K,rt=!1){if(!K){this.remove();return}mt(this,G,K.bitmap),rt||(mt(this,N,K.id),mt(this,y,K.isSvg)),tt(this,E,cr).call(this)},Yn=function(){mt(this,f,null),this._uiManager.enableWaiting(!1),t(this,A)&&this.div.focus()},mi=function(){if(t(this,N)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,N)).then(rt=>tt(this,E,$n).call(this,rt,!0)).finally(()=>tt(this,E,Yn).call(this));return}if(t(this,z)){const rt=t(this,z);mt(this,z,null),this._uiManager.enableWaiting(!0),mt(this,f,this._uiManager.imageManager.getFromUrl(rt).then(X=>tt(this,E,$n).call(this,X)).finally(()=>tt(this,E,Yn).call(this)));return}if(t(this,W)){const rt=t(this,W);mt(this,W,null),this._uiManager.enableWaiting(!0),mt(this,f,this._uiManager.imageManager.getFromFile(rt).then(X=>tt(this,E,$n).call(this,X)).finally(()=>tt(this,E,Yn).call(this)));return}const K=document.createElement("input");K.type="file",K.accept=w.supportedTypesStr,mt(this,f,new Promise(rt=>{K.addEventListener("change",async()=>{if(!K.files||K.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const X=await this._uiManager.imageManager.getFromFile(K.files[0]);tt(this,E,$n).call(this,X)}rt()}),K.addEventListener("cancel",()=>{this.remove(),rt()})}).finally(()=>tt(this,E,Yn).call(this))),K.click()},cr=function(){const{div:K}=this;let{width:rt,height:X}=t(this,G);const[_t,x]=this.pageDimensions,$=.75;if(this.width)rt=this.width*_t,X=this.height*x;else if(rt>$*_t||X>$*x){const r=Math.min($*_t/rt,$*x/X);rt*=r,X*=r}const[ct,T]=this.parentDimensions;this.setDims(rt*ct/_t,X*T/x),this._uiManager.enableWaiting(!1);const i=mt(this,A,document.createElement("canvas"));K.append(i),K.hidden=!1,tt(this,E,hr).call(this,rt,X),tt(this,E,cs).call(this),t(this,m)||(this.parent.addUndoableEditor(this),mt(this,m,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},os=function(K,rt){var $;const[X,_t]=this.parentDimensions;this.width=K/X,this.height=rt/_t,this.setDims(K,rt),($=this._initialOptions)!=null&&$.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,R)!==null&&clearTimeout(t(this,R)),mt(this,R,setTimeout(()=>{mt(this,R,null),tt(this,E,hr).call(this,K,rt)},200))},ls=function(K,rt){const{width:X,height:_t}=t(this,G);let x=X,$=_t,ct=t(this,G);for(;x>2*K||$>2*rt;){const T=x,i=$;x>2*K&&(x=x>=16384?Math.floor(x/2)-1:Math.ceil(x/2)),$>2*rt&&($=$>=16384?Math.floor($/2)-1:Math.ceil($/2));const r=new OffscreenCanvas(x,$);r.getContext("2d").drawImage(ct,0,0,T,i,0,0,x,$),ct=r.transferToImageBitmap()}return ct},hr=function(K,rt){K=Math.ceil(K),rt=Math.ceil(rt);const X=t(this,A);if(!X||X.width===K&&X.height===rt)return;X.width=K,X.height=rt;const _t=t(this,y)?t(this,G):tt(this,E,ls).call(this,K,rt),x=X.getContext("2d");x.filter=this._uiManager.hcmFilter,x.drawImage(_t,0,0,_t.width,_t.height,0,0,K,rt)},vi=function(K){if(K){if(t(this,y)){const _t=this._uiManager.imageManager.getSvgUrl(t(this,N));if(_t)return _t}const rt=document.createElement("canvas");return{width:rt.width,height:rt.height}=t(this,G),rt.getContext("2d").drawImage(t(this,G),0,0),rt.toDataURL()}if(t(this,y)){const[rt,X]=this.pageDimensions,_t=Math.round(this.width*rt*e.PixelsPerInch.PDF_TO_CSS_UNITS),x=Math.round(this.height*X*e.PixelsPerInch.PDF_TO_CSS_UNITS),$=new OffscreenCanvas(_t,x);return $.getContext("2d").drawImage(t(this,G),0,0,t(this,G).width,t(this,G).height,0,0,_t,x),$.transferToImageBitmap()}return structuredClone(t(this,G))},cs=function(){mt(this,_,new ResizeObserver(K=>{const rt=K[0].contentRect;rt.width&&rt.height&&tt(this,E,os).call(this,rt.width,rt.height)})),t(this,_).observe(this.div)},Xe(w,"_type","stamp");let Mt=w;b.StampEditor=Mt}],__webpack_module_cache__={};function __w_pdfjs_require__(d){var b=__webpack_module_cache__[d];if(b!==void 0)return b.exports;var Et=__webpack_module_cache__[d]={exports:{}};return __webpack_modules__[d](Et,Et.exports,__w_pdfjs_require__),Et.exports}var __webpack_exports__={};return(()=>{var d=__webpack_exports__;Object.defineProperty(d,"__esModule",{value:!0}),Object.defineProperty(d,"AbortException",{enumerable:!0,get:function(){return b.AbortException}}),Object.defineProperty(d,"AnnotationEditorLayer",{enumerable:!0,get:function(){return e.AnnotationEditorLayer}}),Object.defineProperty(d,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return b.AnnotationEditorParamsType}}),Object.defineProperty(d,"AnnotationEditorType",{enumerable:!0,get:function(){return b.AnnotationEditorType}}),Object.defineProperty(d,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return it.AnnotationEditorUIManager}}),Object.defineProperty(d,"AnnotationLayer",{enumerable:!0,get:function(){return Mt.AnnotationLayer}}),Object.defineProperty(d,"AnnotationMode",{enumerable:!0,get:function(){return b.AnnotationMode}}),Object.defineProperty(d,"CMapCompressionType",{enumerable:!0,get:function(){return b.CMapCompressionType}}),Object.defineProperty(d,"DOMSVGFactory",{enumerable:!0,get:function(){return g.DOMSVGFactory}}),Object.defineProperty(d,"FeatureTest",{enumerable:!0,get:function(){return b.FeatureTest}}),Object.defineProperty(d,"GlobalWorkerOptions",{enumerable:!0,get:function(){return G.GlobalWorkerOptions}}),Object.defineProperty(d,"ImageKind",{enumerable:!0,get:function(){return b.ImageKind}}),Object.defineProperty(d,"InvalidPDFException",{enumerable:!0,get:function(){return b.InvalidPDFException}}),Object.defineProperty(d,"MissingPDFException",{enumerable:!0,get:function(){return b.MissingPDFException}}),Object.defineProperty(d,"OPS",{enumerable:!0,get:function(){return b.OPS}}),Object.defineProperty(d,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Et.PDFDataRangeTransport}}),Object.defineProperty(d,"PDFDateString",{enumerable:!0,get:function(){return g.PDFDateString}}),Object.defineProperty(d,"PDFWorker",{enumerable:!0,get:function(){return Et.PDFWorker}}),Object.defineProperty(d,"PasswordResponses",{enumerable:!0,get:function(){return b.PasswordResponses}}),Object.defineProperty(d,"PermissionFlag",{enumerable:!0,get:function(){return b.PermissionFlag}}),Object.defineProperty(d,"PixelsPerInch",{enumerable:!0,get:function(){return g.PixelsPerInch}}),Object.defineProperty(d,"PromiseCapability",{enumerable:!0,get:function(){return b.PromiseCapability}}),Object.defineProperty(d,"RenderingCancelledException",{enumerable:!0,get:function(){return g.RenderingCancelledException}}),Object.defineProperty(d,"SVGGraphics",{enumerable:!0,get:function(){return Et.SVGGraphics}}),Object.defineProperty(d,"UnexpectedResponseException",{enumerable:!0,get:function(){return b.UnexpectedResponseException}}),Object.defineProperty(d,"Util",{enumerable:!0,get:function(){return b.Util}}),Object.defineProperty(d,"VerbosityLevel",{enumerable:!0,get:function(){return b.VerbosityLevel}}),Object.defineProperty(d,"XfaLayer",{enumerable:!0,get:function(){return N.XfaLayer}}),Object.defineProperty(d,"build",{enumerable:!0,get:function(){return Et.build}}),Object.defineProperty(d,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return b.createValidAbsoluteUrl}}),Object.defineProperty(d,"getDocument",{enumerable:!0,get:function(){return Et.getDocument}}),Object.defineProperty(d,"getFilenameFromUrl",{enumerable:!0,get:function(){return g.getFilenameFromUrl}}),Object.defineProperty(d,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return g.getPdfFilenameFromUrl}}),Object.defineProperty(d,"getXfaPageViewport",{enumerable:!0,get:function(){return g.getXfaPageViewport}}),Object.defineProperty(d,"isDataScheme",{enumerable:!0,get:function(){return g.isDataScheme}}),Object.defineProperty(d,"isPdfFile",{enumerable:!0,get:function(){return g.isPdfFile}}),Object.defineProperty(d,"loadScript",{enumerable:!0,get:function(){return g.loadScript}}),Object.defineProperty(d,"noContextMenu",{enumerable:!0,get:function(){return g.noContextMenu}}),Object.defineProperty(d,"normalizeUnicode",{enumerable:!0,get:function(){return b.normalizeUnicode}}),Object.defineProperty(d,"renderTextLayer",{enumerable:!0,get:function(){return k.renderTextLayer}}),Object.defineProperty(d,"setLayerDimensions",{enumerable:!0,get:function(){return g.setLayerDimensions}}),Object.defineProperty(d,"shadow",{enumerable:!0,get:function(){return b.shadow}}),Object.defineProperty(d,"updateTextLayer",{enumerable:!0,get:function(){return k.updateTextLayer}}),Object.defineProperty(d,"version",{enumerable:!0,get:function(){return Et.version}});var b=__w_pdfjs_require__(1),Et=__w_pdfjs_require__(2),g=__w_pdfjs_require__(6),k=__w_pdfjs_require__(26),e=__w_pdfjs_require__(27),it=__w_pdfjs_require__(5),Mt=__w_pdfjs_require__(29),G=__w_pdfjs_require__(14),N=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var hasRequiredCore_min;function requireCore_min(){return hasRequiredCore_min||(hasRequiredCore_min=1,function(d){var b=requireReact(),Et=requirePdf();function g(n){var p=Object.create(null);return n&&Object.keys(n).forEach(function(j){if(j!=="default"){var V=Object.getOwnPropertyDescriptor(n,j);Object.defineProperty(p,j,V.get?V:{enumerable:!0,get:function(){return n[j]}})}}),p.default=n,Object.freeze(p)}var k,e=g(b),it=g(Et);d.AnnotationType=void 0,(k=d.AnnotationType||(d.AnnotationType={}))[k.Text=1]="Text",k[k.Link=2]="Link",k[k.FreeText=3]="FreeText",k[k.Line=4]="Line",k[k.Square=5]="Square",k[k.Circle=6]="Circle",k[k.Polygon=7]="Polygon",k[k.Polyline=8]="Polyline",k[k.Highlight=9]="Highlight",k[k.Underline=10]="Underline",k[k.Squiggly=11]="Squiggly",k[k.StrikeOut=12]="StrikeOut",k[k.Stamp=13]="Stamp",k[k.Caret=14]="Caret",k[k.Ink=15]="Ink",k[k.Popup=16]="Popup",k[k.FileAttachment=17]="FileAttachment";var Mt=function(n,p){return Mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,V){j.__proto__=V}||function(j,V){for(var Y in V)Object.prototype.hasOwnProperty.call(V,Y)&&(j[Y]=V[Y])},Mt(n,p)};function G(n,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");function j(){this.constructor=n}Mt(n,p),n.prototype=p===null?Object.create(p):(j.prototype=p.prototype,new j)}var N,f=function(){return f=Object.assign||function(n){for(var p,j=1,V=arguments.length;j<V;j++)for(var Y in p=arguments[j])Object.prototype.hasOwnProperty.call(p,Y)&&(n[Y]=p[Y]);return n},f.apply(this,arguments)};d.TextDirection=void 0,(N=d.TextDirection||(d.TextDirection={})).RightToLeft="RTL",N.LeftToRight="LTR";var z,W=e.createContext({currentTheme:"light",direction:d.TextDirection.LeftToRight,setCurrentTheme:function(){}}),A=function(n){var p=[];return Object.keys(n).forEach(function(j){j&&n[j]&&p.push(j)}),p.join(" ")},_=typeof window<"u"?e.useLayoutEffect:e.useEffect,R=function(n){var p=e.useRef(null),j=n.once,V=n.threshold,Y=n.onVisibilityChanged;return _(function(){var Z=p.current;if(Z){var pt=new IntersectionObserver(function(at){at.forEach(function(q){var ut=q.isIntersecting,lt=q.intersectionRatio;Y({isVisible:ut,ratio:lt}),ut&&j&&(pt.unobserve(Z),pt.disconnect())})},{threshold:V||0});return pt.observe(Z),function(){pt.unobserve(Z),pt.disconnect()}}},[]),p},y=function(n){var p=n.children,j=n.ignoreDirection,V=j!==void 0&&j,Y=n.size,Z=Y===void 0?24:Y,pt=e.useContext(W).direction,at=!V&&pt===d.TextDirection.RightToLeft,q="".concat(Z||24,"px");return e.createElement("svg",{"aria-hidden":"true",className:A({"rpv-core__icon":!0,"rpv-core__icon--rtl":at}),focusable:"false",height:q,viewBox:"0 0 24 24",width:q},p)},m=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},E=function(n){var p=n.children,j=n.testId,V=n.onClick,Y=e.useContext(W).direction===d.TextDirection.RightToLeft,Z=j?{"data-testid":j}:{};return e.createElement("button",f({className:A({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":Y}),type:"button",onClick:V},Z),p)},H=function(n){var p=n.size,j=p===void 0?"4rem":p,V=n.testId,Y=e.useState(!1),Z=Y[0],pt=Y[1],at=V?{"data-testid":V}:{},q=R({onVisibilityChanged:function(ut){pt(ut.isVisible)}});return e.createElement("div",f({},at,{className:A({"rpv-core__spinner":!0,"rpv-core__spinner--animating":Z}),ref:q,style:{height:j,width:j}}))},C=function(n){var p=n.ariaLabel,j=p===void 0?"":p,V=n.autoFocus,Y=V!==void 0&&V,Z=n.placeholder,pt=Z===void 0?"":Z,at=n.testId,q=n.type,ut=q===void 0?"text":q,lt=n.value,Nt=lt===void 0?"":lt,Ot=n.onChange,It=n.onKeyDown,Gt=It===void 0?function(){}:It,Vt=e.useContext(W).direction,jt=e.useRef(),Me=Vt===d.TextDirection.RightToLeft,de={ref:jt,"data-testid":"","aria-label":j,className:A({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":Me}),placeholder:pt,value:Nt,onChange:function(pe){return Ot(pe.target.value)},onKeyDown:Gt};return at&&(de["data-testid"]=at),_(function(){if(Y){var pe=jt.current;if(pe){var ye=window.scrollX,se=window.scrollY;pe.focus(),window.scrollTo(ye,se)}}},[]),ut==="text"?e.createElement("input",f({type:"text"},de)):e.createElement("input",f({type:"password"},de))};(function(n){n[n.ExitFullScreen=0]="ExitFullScreen",n[n.FullScreenChange=1]="FullScreenChange",n[n.FullScreenElement=2]="FullScreenElement",n[n.FullScreenEnabled=3]="FullScreenEnabled",n[n.RequestFullScreen=4]="RequestFullScreen"})(z||(z={}));var a,u={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},o={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},c={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},h=typeof window<"u",B=h&&(z.FullScreenEnabled in document&&u||o.FullScreenEnabled in document&&o||c.FullScreenEnabled in document&&c)||u,l=function(){return h&&B.FullScreenEnabled in document&&document[B.FullScreenEnabled]===!0},w=function(n){return h?n[B.ExitFullScreen]():Promise.resolve({})},I=function(){return h?document[B.FullScreenElement]:null},bt=function(n,p){var j=e.useRef(),V=function(){j.current&&clearTimeout(j.current)};return e.useEffect(function(){return function(){return V()}},[]),e.useCallback(function(){for(var Y=[],Z=0;Z<arguments.length;Z++)Y[Z]=arguments[Z];V(),j.current=setTimeout(function(){n.apply(void 0,Y)},p)},[n,p])},K=function(){var n=e.useRef(!1);return e.useEffect(function(){return n.current=!0,function(){n.current=!1}},[]),n},rt=function(n){var p=e.useRef(n);return e.useEffect(function(){p.current=n},[n]),p.current};(function(n){n.NotRenderedYet="NotRenderedYet",n.Rendering="Rendering",n.Rendered="Rendered"})(a||(a={}));var X,_t=-9999,x=function(n){var p=n.doc,j=p.numPages,V=p.loadingTask.docId,Y=e.useMemo(function(){return Array(j).fill(null).map(function(at,q){return{pageIndex:q,renderStatus:a.NotRenderedYet,visibility:_t}})},[V]),Z=e.useRef({currentRenderingPage:-1,startRange:0,endRange:j-1,visibilities:Y}),pt=function(at,q){Z.current.visibilities[at].visibility=q};return{getHighestPriorityPage:function(){var at=Z.current.visibilities.slice(Z.current.startRange,Z.current.endRange+1).filter(function(Ot){return Ot.visibility>_t});if(!at.length)return-1;for(var q=at[0].pageIndex,ut=at[at.length-1].pageIndex,lt=at.length,Nt=0;Nt<lt;Nt++){if(at[Nt].renderStatus===a.Rendering)return-1;if(at[Nt].renderStatus===a.NotRenderedYet)return at[Nt].pageIndex}return ut+1<j&&Z.current.visibilities[ut+1].renderStatus!==a.Rendered?ut+1:q-1>=0&&Z.current.visibilities[q-1].renderStatus!==a.Rendered?q-1:-1},isInRange:function(at){return at>=Z.current.startRange&&at<=Z.current.endRange},markNotRendered:function(){for(var at=0;at<j;at++)Z.current.visibilities[at].renderStatus=a.NotRenderedYet},markRendered:function(at){Z.current.visibilities[at].renderStatus=a.Rendered},markRendering:function(at){Z.current.currentRenderingPage!==-1&&Z.current.currentRenderingPage!==at&&Z.current.visibilities[Z.current.currentRenderingPage].renderStatus===a.Rendering&&(Z.current.visibilities[Z.current.currentRenderingPage].renderStatus=a.NotRenderedYet),Z.current.visibilities[at].renderStatus=a.Rendering,Z.current.currentRenderingPage=at},setOutOfRange:function(at){pt(at,_t)},setRange:function(at,q){Z.current.startRange=at,Z.current.endRange=q;for(var ut=0;ut<j;ut++)(ut<at||ut>q)&&(Z.current.visibilities[ut].visibility=_t,Z.current.visibilities[ut].renderStatus=a.NotRenderedYet)},setVisibility:pt}},$={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},ct=e.createContext({l10n:$,setL10n:function(){}}),T=0,i=function(){return T++},r=function(n,p,j){var V=function(Y){var Z=p.current;if(Z){var pt=Y.target;if(pt instanceof Element&&pt.shadowRoot){var at=Y.composedPath();at.length>0&&!Z.contains(at[0])&&j()}else Z.contains(pt)||j()}};e.useEffect(function(){if(n){var Y={capture:!0};return document.addEventListener("click",V,Y),function(){document.removeEventListener("click",V,Y)}}},[])},v=function(n){var p=function(j){j.key==="Escape"&&n()};e.useEffect(function(){return document.addEventListener("keyup",p),function(){document.removeEventListener("keyup",p)}},[])},L=function(n){var p=n.ariaControlsSuffix,j=n.children,V=n.closeOnClickOutside,Y=n.closeOnEscape,Z=n.onToggle,pt=e.useRef(),at=e.useContext(W).direction===d.TextDirection.RightToLeft;return e.useEffect(function(){var q=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=q}},[]),v(function(){pt.current&&Y&&Z()}),r(V,pt,Z),_(function(){var q=pt.current;if(q){var ut=.75*document.body.clientHeight;q.getBoundingClientRect().height>=ut&&(q.style.overflow="auto",q.style.maxHeight="".concat(ut,"px"))}},[]),e.createElement("div",{"aria-modal":"true",className:A({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":at}),id:"rpv-core__modal-body-".concat(p),ref:pt,role:"dialog",tabIndex:-1},j)},D=function(n){var p=n.children;return e.createElement("div",{className:"rpv-core__modal-overlay"},p)};d.ToggleStatus=void 0,(X=d.ToggleStatus||(d.ToggleStatus={})).Close="Close",X.Open="Open",X.Toggle="Toggle";var F,Q=function(n){var p=e.useState(n),j=p[0],V=p[1];return{opened:j,toggle:function(Y){switch(Y){case d.ToggleStatus.Close:V(!1);break;case d.ToggleStatus.Open:V(!0);break;case d.ToggleStatus.Toggle:default:V(function(Z){return!Z})}}}},vt=function(n){var p=n.content,j=n.isOpened,V=j!==void 0&&j,Y=n.target,Z=Q(V),pt=Z.opened,at=Z.toggle;return e.createElement(e.Fragment,null,Y&&Y(at,pt),pt&&p(at))};d.Position=void 0,(F=d.Position||(d.Position={})).TopLeft="TOP_LEFT",F.TopCenter="TOP_CENTER",F.TopRight="TOP_RIGHT",F.RightTop="RIGHT_TOP",F.RightCenter="RIGHT_CENTER",F.RightBottom="RIGHT_BOTTOM",F.BottomLeft="BOTTOM_LEFT",F.BottomCenter="BOTTOM_CENTER",F.BottomRight="BOTTOM_RIGHT",F.LeftTop="LEFT_TOP",F.LeftCenter="LEFT_CENTER",F.LeftBottom="LEFT_BOTTOM";var St,wt,Tt,Ft,Lt,ht,dt,S,O=function(n,p,j,V,Y){_(function(){var Z=p.current,pt=n.current,at=j.current;if(pt&&Z&&at){var q=at.getBoundingClientRect(),ut=function(Ot,It,Gt,Vt){var jt=It.getBoundingClientRect(),Me=Ot.getBoundingClientRect(),de=Me.height,pe=Me.width,ye=0,se=0;switch(Gt){case d.Position.TopLeft:ye=jt.top-de,se=jt.left;break;case d.Position.TopCenter:ye=jt.top-de,se=jt.left+jt.width/2-pe/2;break;case d.Position.TopRight:ye=jt.top-de,se=jt.left+jt.width-pe;break;case d.Position.RightTop:ye=jt.top,se=jt.left+jt.width;break;case d.Position.RightCenter:ye=jt.top+jt.height/2-de/2,se=jt.left+jt.width;break;case d.Position.RightBottom:ye=jt.top+jt.height-de,se=jt.left+jt.width;break;case d.Position.BottomLeft:ye=jt.top+jt.height,se=jt.left;break;case d.Position.BottomCenter:ye=jt.top+jt.height,se=jt.left+jt.width/2-pe/2;break;case d.Position.BottomRight:ye=jt.top+jt.height,se=jt.left+jt.width-pe;break;case d.Position.LeftTop:ye=jt.top,se=jt.left-pe;break;case d.Position.LeftCenter:ye=jt.top+jt.height/2-de/2,se=jt.left-pe;break;case d.Position.LeftBottom:ye=jt.top+jt.height-de,se=jt.left-pe}return{left:se+(Vt.left||0),top:ye+(Vt.top||0)}}(pt,Z,V,Y),lt=ut.top,Nt=ut.left;pt.style.top="".concat(lt-q.top,"px"),pt.style.left="".concat(Nt-q.left,"px")}},[])},nt=function(n){var p,j=n.customClassName,V=n.position;return e.createElement("div",{className:A((p={"rpv-core__arrow":!0,"rpv-core__arrow--tl":V===d.Position.TopLeft,"rpv-core__arrow--tc":V===d.Position.TopCenter,"rpv-core__arrow--tr":V===d.Position.TopRight,"rpv-core__arrow--rt":V===d.Position.RightTop,"rpv-core__arrow--rc":V===d.Position.RightCenter,"rpv-core__arrow--rb":V===d.Position.RightBottom,"rpv-core__arrow--bl":V===d.Position.BottomLeft,"rpv-core__arrow--bc":V===d.Position.BottomCenter,"rpv-core__arrow--br":V===d.Position.BottomRight,"rpv-core__arrow--lt":V===d.Position.LeftTop,"rpv-core__arrow--lc":V===d.Position.LeftCenter,"rpv-core__arrow--lb":V===d.Position.LeftBottom},p["".concat(j)]=j!=="",p))})},ft=function(n){var p=n.ariaControlsSuffix,j=n.children,V=n.closeOnClickOutside,Y=n.offset,Z=n.position,pt=n.targetRef,at=n.onClose,q=e.useRef(),ut=e.useRef(),lt=e.useRef(),Nt=e.useContext(W).direction===d.TextDirection.RightToLeft;r(V,q,at),O(q,pt,lt,Z,Y),_(function(){var It=ut.current;if(It){var Gt=.75*document.body.clientHeight;It.getBoundingClientRect().height>=Gt&&(It.style.overflow="auto",It.style.maxHeight="".concat(Gt,"px"))}},[]);var Ot="rpv-core__popover-body-inner-".concat(p);return e.createElement(e.Fragment,null,e.createElement("div",{ref:lt,style:{left:0,position:"absolute",top:0}}),e.createElement("div",{"aria-describedby":Ot,className:A({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":Nt}),id:"rpv-core__popover-body-".concat(p),ref:q,role:"dialog",tabIndex:-1},e.createElement(nt,{customClassName:"rpv-core__popover-body-arrow",position:Z}),e.createElement("div",{id:Ot,ref:ut},j)))},Ct=function(n){var p=n.closeOnEscape,j=n.onClose,V=e.useRef();return v(function(){V.current&&p&&j()}),e.createElement("div",{className:"rpv-core__popover-overlay",ref:V})},Dt=function(n){var p=n.ariaControlsSuffix,j=n.children,V=n.contentRef,Y=n.offset,Z=n.position,pt=n.targetRef,at=e.useRef(),q=e.useContext(W).direction===d.TextDirection.RightToLeft;return O(V,pt,at,Z,Y),e.createElement(e.Fragment,null,e.createElement("div",{ref:at,style:{left:0,position:"absolute",top:0}}),e.createElement("div",{className:A({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":q}),id:"rpv-core__tooltip-body-".concat(p),ref:V,role:"tooltip"},e.createElement(nt,{customClassName:"rpv-core__tooltip-body-arrow",position:Z}),e.createElement("div",{className:"rpv-core__tooltip-body-content"},j)))};d.FullScreenMode=void 0,(St=d.FullScreenMode||(d.FullScreenMode={})).Normal="Normal",St.Entering="Entering",St.Entered="Entered",St.EnteredCompletely="EnteredCompletely",St.Exitting="Exitting",St.Exited="Exited",d.LayerRenderStatus=void 0,(wt=d.LayerRenderStatus||(d.LayerRenderStatus={}))[wt.PreRender=0]="PreRender",wt[wt.DidRender=1]="DidRender",d.PageMode=void 0,(Tt=d.PageMode||(d.PageMode={})).Attachments="UseAttachments",Tt.Bookmarks="UseOutlines",Tt.ContentGroup="UseOC",Tt.Default="UserNone",Tt.FullScreen="FullScreen",Tt.Thumbnails="UseThumbs",d.PasswordStatus=void 0,(Ft=d.PasswordStatus||(d.PasswordStatus={})).RequiredPassword="RequiredPassword",Ft.WrongPassword="WrongPassword",d.RotateDirection=void 0,(Lt=d.RotateDirection||(d.RotateDirection={})).Backward="Backward",Lt.Forward="Forward",d.ScrollMode=void 0,(ht=d.ScrollMode||(d.ScrollMode={})).Page="Page",ht.Horizontal="Horizontal",ht.Vertical="Vertical",ht.Wrapped="Wrapped",d.SpecialZoomLevel=void 0,(dt=d.SpecialZoomLevel||(d.SpecialZoomLevel={})).ActualSize="ActualSize",dt.PageFit="PageFit",dt.PageWidth="PageWidth",d.ViewMode=void 0,(S=d.ViewMode||(d.ViewMode={})).DualPage="DualPage",S.DualPageWithCover="DualPageWithCover",S.SinglePage="SinglePage";var Rt,et=function(n,p){return n.reduce(function(j,V,Y){return Y%p?j[j.length-1].push(V):j.push([V]),j},[])},zt=function(n,p){switch(p[1].name){case"XYZ":return{bottomOffset:function(j,V){return p[3]===null?V:p[3]},leftOffset:function(j,V){return p[2]===null?0:p[2]},pageIndex:n,scaleTo:p[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:n,scaleTo:d.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:p[2],leftOffset:0,pageIndex:n,scaleTo:d.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:n,scaleTo:1}}},Ht=new Map,me=new Map,ce=function(n,p){return"".concat(n.loadingTask.docId,"___").concat(p.num,"R").concat(p.gen===0?"":p.gen)},Te=function(n,p,j){Ht.set(ce(n,p),j)},Yt=function(n,p){if(!n)return Promise.reject("The document is not loaded yet");var j="".concat(n.loadingTask.docId,"___").concat(p),V=me.get(j);return V?Promise.resolve(V):new Promise(function(Y,Z){n.getPage(p+1).then(function(pt){me.set(j,pt),pt.ref&&Te(n,pt.ref,p),Y(pt)})})},re=function(n,p){return new Promise(function(j){new Promise(function(V){typeof p=="string"?n.getDestination(p).then(function(Y){V(Y)}):V(p)}).then(function(V){if(typeof V[0]=="object"&&V[0]!==null){var Y=V[0],Z=function(at,q){var ut=ce(at,q);return Ht.has(ut)?Ht.get(ut):null}(n,Y);Z===null?n.getPageIndex(Y).then(function(at){Te(n,Y,at),re(n,p).then(function(q){return j(q)})}):j(zt(Z,V))}else{var pt=zt(V[0],V);j(pt)}})})};(function(n){n[n.Solid=1]="Solid",n[n.Dashed=2]="Dashed",n[n.Beveled=3]="Beveled",n[n.Inset=4]="Inset",n[n.Underline=5]="Underline"})(Rt||(Rt={}));var Ae,Ie=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),kt=function(n,p,j,V){var Y=parseInt(n,10);return Y>=p&&Y<=j?Y:V},st=function(n){return n.contentsObj?n.contentsObj.str:n.contents||""},ot=function(n){return n.titleObj?n.titleObj.str:n.title||""},$t=function(n){var p=n.annotation,j=e.useContext(W).direction,V=ot(p),Y=st(p),Z=j===d.TextDirection.RightToLeft,pt=e.useRef(),at="";if(p.modificationDate){var q=function(ut){var lt=Ie.exec(ut);if(!lt)return null;var Nt=parseInt(lt[1],10),Ot=kt(lt[2],1,12,1)-1,It=kt(lt[3],1,31,1),Gt=kt(lt[4],0,23,0),Vt=kt(lt[5],0,59,0),jt=kt(lt[6],0,59,0),Me=lt[7]||"Z",de=kt(lt[8],0,23,0),pe=kt(lt[9],0,59,0);switch(Me){case"-":Gt+=de,Vt+=pe;break;case"+":Gt-=de,Vt-=pe}return new Date(Date.UTC(Nt,Ot,It,Gt,Vt,jt))}(p.modificationDate);at=q?"".concat(q.toLocaleDateString(),", ").concat(q.toLocaleTimeString()):""}return e.useLayoutEffect(function(){if(pt.current){var ut=document.querySelector('[data-annotation-id="'.concat(p.id,'"]'));if(ut){var lt=ut;return lt.style.zIndex+=1,function(){lt.style.zIndex="".concat(parseInt(lt.style.zIndex,10)-1)}}}},[]),e.createElement("div",{ref:pt,className:A({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":Z}),style:{top:p.annotationType===d.AnnotationType.Popup?"":"100%"}},V&&e.createElement(e.Fragment,null,e.createElement("div",{className:A({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!Z,"rpv-core__annotation-popup-title--rtl":Z})},V),e.createElement("div",{className:"rpv-core__annotation-popup-date"},at)),Y&&e.createElement("div",{className:"rpv-core__annotation-popup-content"},Y.split(`
`).map(function(ut,lt){return e.createElement(e.Fragment,{key:lt},ut,e.createElement("br",null))})))};(function(n){n.Click="Click",n.Hover="Hover"})(Ae||(Ae={}));var Zt,le=function(n){var p,j=n.annotation,V=n.children,Y=n.ignoreBorder,Z=n.hasPopup,pt=n.isRenderable,at=n.page,q=n.viewport,ut=j.rect,lt=function(){var ve=Q(!1),Ne=ve.opened,Oe=ve.toggle,Be=e.useState(Ae.Hover),He=Be[0],We=Be[1];return{opened:Ne,closeOnHover:function(){He===Ae.Hover&&Oe(d.ToggleStatus.Close)},openOnHover:function(){He===Ae.Hover&&Oe(d.ToggleStatus.Open)},toggleOnClick:function(){switch(He){case Ae.Click:Ne&&We(Ae.Hover),Oe(d.ToggleStatus.Toggle);break;case Ae.Hover:We(Ae.Click),Oe(d.ToggleStatus.Open)}}}}(),Nt=lt.closeOnHover,Ot=lt.opened,It=lt.openOnHover,Gt=lt.toggleOnClick,Vt=(p=[ut[0],at.view[3]+at.view[1]-ut[1],ut[2],at.view[3]+at.view[1]-ut[3]],[Math.min(p[0],p[2]),Math.min(p[1],p[3]),Math.max(p[0],p[2]),Math.max(p[1],p[3])]),jt=ut[2]-ut[0],Me=ut[3]-ut[1],de={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!Y&&j.borderStyle.width>0){switch(j.borderStyle.style){case Rt.Dashed:de.borderStyle="dashed";break;case Rt.Solid:de.borderStyle="solid";break;case Rt.Underline:de=Object.assign({borderBottomStyle:"solid"},de);case Rt.Beveled:case Rt.Inset:}var pe=j.borderStyle.width;de.borderWidth="".concat(pe,"px"),j.borderStyle.style!==Rt.Underline&&(jt-=2*pe,Me-=2*pe);var ye=j.borderStyle,se=ye.horizontalCornerRadius,Se=ye.verticalCornerRadius;(se>0||Se>0)&&(de.borderRadius="".concat(se,"px / ").concat(Se,"px")),j.color?de.borderColor="rgb(".concat(0|j.color[0],", ").concat(0|j.color[1],", ").concat(0|j.color[2],")"):de.borderWidth="0"}return e.createElement(e.Fragment,null,pt&&V({popup:{opened:Ot,closeOnHover:Nt,openOnHover:It,toggleOnClick:Gt},slot:{attrs:{style:Object.assign({height:"".concat(Me,"px"),left:"".concat(Vt[0],"px"),top:"".concat(Vt[1],"px"),transform:"matrix(".concat(q.transform.join(","),")"),transformOrigin:"-".concat(Vt[0],"px -").concat(Vt[1],"px"),width:"".concat(jt,"px")},de)},children:e.createElement(e.Fragment,null,Z&&Ot&&e.createElement($t,{annotation:j}))}}))},U=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},Pt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},e.createElement("circle",{cy:lt/2,fill:"none",rx:ut/2-Nt/2,ry:lt/2-Nt/2,stroke:"transparent",strokeWidth:Nt||1})),Ot.slot.children)})},Wt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=ot(p),Z=st(p),pt=!(p.hasPopup!==!1||!Y&&!Z),at=function(){var q,ut,lt,Nt,Ot=p.file;Ot&&(q=Ot.filename,ut=Ot.content,lt=typeof ut=="string"?"":URL.createObjectURL(new Blob([ut],{type:""})),(Nt=document.createElement("a")).style.display="none",Nt.href=lt||q,Nt.setAttribute("download",function(It){var Gt=It.split("/").pop();return Gt?Gt.split("#")[0].split("?")[0]:It}(q)),document.body.appendChild(Nt),Nt.click(),document.body.removeChild(Nt),lt&&URL.revokeObjectURL(lt))};return e.createElement(le,{annotation:p,hasPopup:pt,ignoreBorder:!0,isRenderable:!0,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onDoubleClick:at,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},Qt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},ne=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=ot(p),Z=st(p),pt=!(!Y&&!Z),at=!p.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(p.parentType)!==-1;return _(function(){if(p.parentId){var q=document.querySelector('[data-annotation-id="'.concat(p.parentId,'"]')),ut=document.querySelector('[data-annotation-id="'.concat(p.id,'"]'));if(q&&ut){var lt=parseFloat(q.style.left),Nt=parseFloat(q.style.top)+parseFloat(q.style.height);ut.style.left="".concat(lt,"px"),ut.style.top="".concat(Nt,"px"),ut.style.transformOrigin="-".concat(lt,"px -").concat(Nt,"px")}}},[]),e.createElement(le,{annotation:p,hasPopup:at,ignoreBorder:!1,isRenderable:pt,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":p.id}),e.createElement($t,{annotation:p}))})},Xt=function(n){var p=n.annotation,j=n.childAnnotation,V=n.page,Y=n.viewport,Z=p.hasPopup===!1,pt=ot(p),at=st(p),q=!!(p.hasPopup||pt||at);if(p.quadPoints&&p.quadPoints.length>0){var ut=p.quadPoints.map(function(lt){return Object.assign({},p,{rect:[lt[2].x,lt[2].y,lt[1].x,lt[1].y],quadPoints:[]})});return e.createElement(e.Fragment,null,ut.map(function(lt,Nt){return e.createElement(Xt,{key:Nt,annotation:lt,childAnnotation:j,page:V,viewport:Y})}))}return e.createElement(le,{annotation:p,hasPopup:Z,ignoreBorder:!0,isRenderable:q,page:V,viewport:Y},function(lt){return e.createElement(e.Fragment,null,e.createElement("div",f({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":p.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),lt.slot.children),j&&j.annotationType===d.AnnotationType.Popup&&lt.popup.opened&&e.createElement(ne,{annotation:j,page:V,viewport:Y}))})},M=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),p.inkLists&&p.inkLists.length&&e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},p.inkLists.map(function(It,Gt){return e.createElement("polyline",{key:Gt,fill:"none",stroke:"transparent",strokeWidth:Nt||1,points:It.map(function(Vt){return"".concat(Vt.x-q[0],",").concat(q[3]-Vt.y)}).join(" ")})})),Ot.slot.children)})},P=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},e.createElement("line",{stroke:"transparent",strokeWidth:Nt||1,x1:q[2]-p.lineCoordinates[0],x2:q[2]-p.lineCoordinates[2],y1:q[3]-p.lineCoordinates[1],y2:q[3]-p.lineCoordinates[3]})),Ot.slot.children)})},J=/^([^\w]*)(javascript|data|vbscript)/im,yt=/&#(\w+)(^\w|;)?/g,At=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,xt=/^([^:]+):/gm,Bt=function(n,p){var j,V=(j=n||"",j.replace(yt,function(at,q){return String.fromCharCode(q)})).replace(At,"").trim();if(!V)return p;var Y=V[0];if(Y==="."||Y==="/")return V;var Z=V.match(xt);if(!Z)return V;var pt=Z[0];return J.test(pt)?p:V},te=function(n){var p,j=n.annotation,V=n.annotationContainerRef,Y=n.doc,Z=n.outlines,pt=n.page,at=n.pageIndex,q=n.scale,ut=n.viewport,lt=n.onExecuteNamedAction,Nt=n.onJumpFromLinkAnnotation,Ot=n.onJumpToDest,It=e.useRef(),Gt=Z&&Z.length&&j.dest&&typeof j.dest=="string"?(p=Z.find(function(de){return de.dest===j.dest}))===null||p===void 0?void 0:p.title:"",Vt=!!(j.url||j.dest||j.action||j.unsafeUrl),jt={};if(j.url||j.unsafeUrl){var Me=Bt(j.url||j.unsafeUrl,"");Me?jt={"data-target":"external",href:Me,rel:"noopener noreferrer nofollow",target:j.newWindow?"_blank":"",title:Me}:Vt=!1}else jt={href:"","data-annotation-link":j.id,onClick:function(de){de.preventDefault(),j.action?lt(j.action):re(Y,j.dest).then(function(pe){var ye=It.current,se=V.current;if(ye&&se){var Se=ye.getBoundingClientRect();se.style.setProperty("height","100%"),se.style.setProperty("width","100%");var ve=se.getBoundingClientRect();se.style.removeProperty("height"),se.style.removeProperty("width");var Ne=(Se.left-ve.left)/q,Oe=(ve.bottom-Se.bottom+Se.height)/q;Nt({bottomOffset:Oe,label:Gt,leftOffset:Ne,pageIndex:at})}Ot(pe)})}};return Gt&&(jt=Object.assign({},jt,{title:Gt,"aria-label":Gt})),e.createElement(le,{annotation:j,hasPopup:!1,ignoreBorder:!1,isRenderable:Vt,page:pt,viewport:ut},function(de){return e.createElement("div",f({},de.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":j.id,"data-testid":"core__annotation--link-".concat(j.id)}),e.createElement("a",f({ref:It},jt)))})},Kt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),p.vertices&&p.vertices.length&&e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},e.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:Nt||1,points:p.vertices.map(function(It){return"".concat(It.x-q[0],",").concat(q[3]-It.y)}).join(" ")})),Ot.slot.children)})},qt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),p.vertices&&p.vertices.length&&e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},e.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:Nt||1,points:p.vertices.map(function(It){return"".concat(It.x-q[0],",").concat(q[3]-It.y)}).join(" ")})),Ot.slot.children)})},_e=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt),q=p.rect,ut=q[2]-q[0],lt=q[3]-q[1],Nt=p.borderStyle.width;return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(Ot){return e.createElement("div",f({},Ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":p.id,onClick:Ot.popup.toggleOnClick,onMouseEnter:Ot.popup.openOnHover,onMouseLeave:Ot.popup.closeOnHover}),e.createElement("svg",{height:"".concat(lt,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(ut," ").concat(lt),width:"".concat(ut,"px")},e.createElement("rect",{height:lt-Nt,fill:"none",stroke:"transparent",strokeWidth:Nt||1,x:Nt/2,y:Nt/2,width:ut-Nt})),Ot.slot.children)})},Jt=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},ie=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},fe=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},we=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),e.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),e.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),e.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},Fe=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),e.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),e.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),e.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),e.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),e.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),e.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),e.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),e.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),e.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},je=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),e.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},an=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),e.createElement("path",{d:"M6 4.5L6 0.5"}),e.createElement("path",{d:"M18 4.5L18 0.5"}),e.createElement("path",{d:"M10 4.5L10 0.5"}),e.createElement("path",{d:"M14 4.5L14 0.5"}))},Ze=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),e.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),e.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},vn=function(){return e.createElement(y,{size:16},e.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},_n=function(n){var p=n.annotation,j=n.childAnnotation,V=n.page,Y=n.viewport,Z=p.hasPopup===!1,pt=ot(p),at=st(p),q=!!(p.hasPopup||pt||at),ut=p.name?p.name.toLowerCase():"";return e.createElement(le,{annotation:p,hasPopup:Z,ignoreBorder:!1,isRenderable:q,page:V,viewport:Y},function(lt){return e.createElement(e.Fragment,null,e.createElement("div",f({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":p.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),ut&&e.createElement("div",{className:"rpv-core__annotation-text-icon"},ut==="check"&&e.createElement(m,null),ut==="comment"&&e.createElement(we,null),ut==="help"&&e.createElement(Fe,null),ut==="insert"&&e.createElement(vn,null),ut==="key"&&e.createElement(je,null),ut==="note"&&e.createElement(an,null),(ut==="newparagraph"||ut==="paragraph")&&e.createElement(Ze,null)),lt.slot.children),j&&j.annotationType===d.AnnotationType.Popup&&lt.popup.opened&&e.createElement(ne,{annotation:j,page:V,viewport:Y}))})},yn=function(n){var p=n.annotation,j=n.page,V=n.viewport,Y=p.hasPopup===!1,Z=ot(p),pt=st(p),at=!!(p.hasPopup||Z||pt);return e.createElement(le,{annotation:p,hasPopup:Y,ignoreBorder:!0,isRenderable:at,page:j,viewport:V},function(q){return e.createElement("div",f({},q.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":p.id,onClick:q.popup.toggleOnClick,onMouseEnter:q.popup.openOnHover,onMouseLeave:q.popup.closeOnHover}),q.slot.children)})},Kn=function(n){var p=n.annotations,j=n.doc,V=n.outlines,Y=n.page,Z=n.pageIndex,pt=n.plugins,at=n.rotation,q=n.scale,ut=n.onExecuteNamedAction,lt=n.onJumpFromLinkAnnotation,Nt=n.onJumpToDest,Ot=e.useRef(),It=Y.getViewport({rotation:at,scale:q}).clone({dontFlip:!0}),Gt=p.filter(function(Vt){return!Vt.parentId});return _(function(){var Vt=Ot.current;Vt&&pt.forEach(function(jt){jt.onAnnotationLayerRender&&jt.onAnnotationLayerRender({annotations:Gt,container:Vt,pageIndex:Z,rotation:at,scale:q})})},[]),e.createElement("div",{ref:Ot,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(Z)},Gt.map(function(Vt){var jt=p.find(function(Me){return Me.parentId===Vt.id});switch(Vt.annotationType){case d.AnnotationType.Caret:return e.createElement(U,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Circle:return e.createElement(Pt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.FileAttachment:return e.createElement(Wt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.FreeText:return e.createElement(Qt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Highlight:return e.createElement(Xt,{key:Vt.id,annotation:Vt,childAnnotation:jt,page:Y,viewport:It});case d.AnnotationType.Ink:return e.createElement(M,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Line:return e.createElement(P,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Link:return e.createElement(te,{key:Vt.id,annotation:Vt,annotationContainerRef:Ot,doc:j,outlines:V,page:Y,pageIndex:Z,scale:q,viewport:It,onExecuteNamedAction:ut,onJumpFromLinkAnnotation:lt,onJumpToDest:Nt});case d.AnnotationType.Polygon:return e.createElement(Kt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Polyline:return e.createElement(qt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Popup:return e.createElement(ne,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Square:return e.createElement(_e,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Squiggly:return e.createElement(Jt,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Stamp:return e.createElement(ie,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.StrikeOut:return e.createElement(fe,{key:Vt.id,annotation:Vt,page:Y,viewport:It});case d.AnnotationType.Text:return e.createElement(_n,{key:Vt.id,annotation:Vt,childAnnotation:jt,page:Y,viewport:It});case d.AnnotationType.Underline:return e.createElement(yn,{key:Vt.id,annotation:Vt,page:Y,viewport:It});default:return e.createElement(e.Fragment,{key:Vt.id})}}))},hs=function(n){var p=n.page,j=n.renderAnnotations,V=K(),Y=e.useState({loading:!0,annotations:[]}),Z=Y[0],pt=Y[1];return e.useEffect(function(){p.getAnnotations({intent:"display"}).then(function(at){V.current&&pt({loading:!1,annotations:at})})},[]),Z.loading?e.createElement(e.Fragment,null):j(Z.annotations)},us=function(n){var p=n.doc,j=n.outlines,V=n.page,Y=n.pageIndex,Z=n.plugins,pt=n.rotation,at=n.scale,q=n.onExecuteNamedAction,ut=n.onJumpFromLinkAnnotation,lt=n.onJumpToDest;return e.createElement(hs,{page:V,renderAnnotations:function(Nt){return e.createElement(Kn,{annotations:Nt,doc:p,outlines:j,page:V,pageIndex:Y,plugins:Z,rotation:pt,scale:at,onExecuteNamedAction:q,onJumpFromLinkAnnotation:ut,onJumpToDest:lt})}})},Jn=function(n,p){var j=n%p;return j===0?n:Math.floor(n-j)},ds=function(n){var p=n.canvasLayerRef,j=n.height,V=n.page,Y=n.pageIndex,Z=n.plugins,pt=n.rotation,at=n.scale,q=n.width,ut=n.onRenderCanvasCompleted,lt=e.useRef();return _(function(){var Nt=lt.current;Nt&&Nt.cancel();var Ot=p.current;Ot.removeAttribute("data-testid"),Z.forEach(function(ve){ve.onCanvasLayerRender&&ve.onCanvasLayerRender({ele:Ot,pageIndex:Y,rotation:pt,scale:at,status:d.LayerRenderStatus.PreRender})});var It=V.getViewport({rotation:pt,scale:at}),Gt=window.devicePixelRatio||1,Vt=Math.sqrt(16777216/(It.width*It.height)),jt=Gt>Vt;jt?Ot.style.transform="scale(1, 1)":Ot.style.removeProperty("transform");var Me=Math.min(Vt,Gt),de=function(ve,Ne){var Oe,Be;if(Math.floor(ve)===ve)return[ve,1];var He=1/ve;if(He>Ne)return[1,Ne];if(Math.floor(He)===He)return[1,He];for(var We=ve>1?He:ve,rn=0,Ke=1,sn=1,Qe=1;;){var en=rn+sn,nn=Ke+Qe;if(nn>Ne)break;We<=en/nn?(sn=(Oe=[en,nn])[0],Qe=Oe[1]):(rn=(Be=[en,nn])[0],Ke=Be[1])}return We<(rn/Ke+sn/Qe)/2?We===ve?[rn,Ke]:[Ke,rn]:We===ve?[sn,Qe]:[Qe,sn]}(Me,8),pe=de[0],ye=de[1];Ot.width=Jn(It.width*Me,pe),Ot.height=Jn(It.height*Me,pe),Ot.style.width="".concat(Jn(It.width,ye),"px"),Ot.style.height="".concat(Jn(It.height,ye),"px"),Ot.hidden=!0;var se=Ot.getContext("2d",{alpha:!1}),Se=jt||Gt!==1?[Me,0,0,Me,0,0]:null;return lt.current=V.render({canvasContext:se,transform:Se,viewport:It}),lt.current.promise.then(function(){Ot.hidden=!1,Ot.setAttribute("data-testid","core__canvas-layer-".concat(Y)),Z.forEach(function(ve){ve.onCanvasLayerRender&&ve.onCanvasLayerRender({ele:Ot,pageIndex:Y,rotation:pt,scale:at,status:d.LayerRenderStatus.DidRender})}),ut()},function(){ut()}),function(){Ot&&(Ot.width=0,Ot.height=0)}},[]),e.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(j,"px"),width:"".concat(q,"px")}},e.createElement("canvas",{ref:p}))},fs=function(n){var p=n.height,j=n.page,V=n.rotation,Y=n.scale,Z=n.width,pt=e.useRef();return _(function(){var at=pt.current,q=j.getViewport({rotation:V,scale:Y});j.getOperatorList().then(function(ut){(function(){var lt=pt.current;lt&&(lt.innerHTML="")})(),new it.SVGGraphics(j.commonObjs,j.objs).getSVG(ut,q).then(function(lt){lt.style.height="".concat(p,"px"),lt.style.width="".concat(Z,"px"),at.appendChild(lt)})})},[]),e.createElement("div",{className:"rpv-core__svg-layer",ref:pt})},ps=function(n){var p=n.containerRef,j=n.page,V=n.pageIndex,Y=n.plugins,Z=n.rotation,pt=n.scale,at=n.onRenderTextCompleted,q=e.useRef(),ut=function(){var lt=p.current;lt&&([].slice.call(lt.querySelectorAll(".rpv-core__text-layer-text")).forEach(function(Nt){return lt.removeChild(Nt)}),[].slice.call(lt.querySelectorAll('br[role="presentation"]')).forEach(function(Nt){return lt.removeChild(Nt)}))};return _(function(){var lt=q.current;lt&&lt.cancel();var Nt=p.current;if(Nt){Nt.removeAttribute("data-testid");var Ot=j.getViewport({rotation:Z,scale:pt});return Y.forEach(function(It){It.onTextLayerRender&&It.onTextLayerRender({ele:Nt,pageIndex:V,scale:pt,status:d.LayerRenderStatus.PreRender})}),j.getTextContent().then(function(It){ut(),q.current=it.renderTextLayer({container:Nt,textContent:It,textContentSource:It,viewport:Ot}),q.current.promise.then(function(){Nt.setAttribute("data-testid","core__text-layer-".concat(V)),[].slice.call(Nt.children).forEach(function(Gt){Gt.classList.contains("rpv-core__text-layer-text--not")||Gt.classList.add("rpv-core__text-layer-text")}),Y.forEach(function(Gt){Gt.onTextLayerRender&&Gt.onTextLayerRender({ele:Nt,pageIndex:V,scale:pt,status:d.LayerRenderStatus.DidRender})}),at()},function(){Nt.removeAttribute("data-testid"),at()})}),function(){var It;ut(),(It=q.current)===null||It===void 0||It.cancel()}}},[]),e.createElement("div",{className:"rpv-core__text-layer",ref:p})},gs=function(n){var p=n.doc,j=n.measureRef,V=n.outlines,Y=n.pageIndex,Z=n.pageRotation,pt=n.pageSize,at=n.plugins,q=n.renderPage,ut=n.renderQueueKey,lt=n.rotation,Nt=n.scale,Ot=n.shouldRender,It=n.viewMode,Gt=n.onExecuteNamedAction,Vt=n.onJumpFromLinkAnnotation,jt=n.onJumpToDest,Me=n.onRenderCompleted,de=n.onRotatePage,pe=K(),ye=e.useState(null),se=ye[0],Se=ye[1],ve=e.useState(!1),Ne=ve[0],Oe=ve[1],Be=e.useState(!1),He=Be[0],We=Be[1],rn=e.useRef(),Ke=e.useRef(),sn=Math.abs(lt+Z)%180==0,Qe=pt.pageWidth*Nt,en=pt.pageHeight*Nt,nn=sn?Qe:en,tn=sn?en:Qe,dn=(pt.rotation+lt+Z)%360,An=e.useRef(0),bn=q||function(cn){return e.createElement(e.Fragment,null,cn.canvasLayer.children,cn.textLayer.children,cn.annotationLayer.children)};return e.useEffect(function(){Se(null),Oe(!1),We(!1)},[Z,lt,Nt]),e.useEffect(function(){Ot&&pe.current&&!se&&Yt(p,Y).then(function(cn){pe.current&&(An.current=ut,Se(cn))})},[Ot,se]),e.useEffect(function(){Ne&&He&&(ut!==An.current?(Se(null),Oe(!1),We(!1)):Me(Y))},[Ne,He]),e.createElement("div",{className:A({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":It===d.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":It===d.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":It===d.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(Y),ref:j,style:{height:"".concat(tn,"px"),width:"".concat(nn,"px")}},se?e.createElement(e.Fragment,null,bn({annotationLayer:{attrs:{},children:e.createElement(us,{doc:p,outlines:V,page:se,pageIndex:Y,plugins:at,rotation:dn,scale:Nt,onExecuteNamedAction:Gt,onJumpFromLinkAnnotation:Vt,onJumpToDest:jt})},canvasLayer:{attrs:{},children:e.createElement(ds,{canvasLayerRef:rn,height:tn,page:se,pageIndex:Y,plugins:at,rotation:dn,scale:Nt,width:nn,onRenderCanvasCompleted:function(){pe.current&&Oe(!0)}})},canvasLayerRendered:Ne,doc:p,height:tn,pageIndex:Y,rotation:dn,scale:Nt,svgLayer:{attrs:{},children:e.createElement(fs,{height:tn,page:se,rotation:dn,scale:Nt,width:nn})},textLayer:{attrs:{},children:e.createElement(ps,{containerRef:Ke,page:se,pageIndex:Y,plugins:at,rotation:dn,scale:Nt,onRenderTextCompleted:function(){pe.current&&We(!0)}})},textLayerRendered:He,width:nn,markRendered:Me,onRotatePage:function(cn){return de(Y,cn)}}),at.map(function(cn,fn){return cn.renderPageLayer?e.createElement(e.Fragment,{key:fn},cn.renderPageLayer({canvasLayerRef:rn,canvasLayerRendered:Ne,doc:p,height:tn,pageIndex:Y,rotation:dn,scale:Nt,textLayerRef:Ke,textLayerRendered:He,width:nn})):e.createElement(e.Fragment,{key:fn})})):e.createElement(H,{testId:"core__page-layer-loading-".concat(Y)}))},ms=function(n,p){var j=p.rect;return n.height!==j.height||n.width!==j.width?j:n};(function(n){n.Horizontal="Horizontal",n.Vertical="Vertical",n.Both="Both"})(Zt||(Zt={}));var vs=function(n){return 1-Math.pow(1-n,4)},Zn=1e-4,ur={left:0,top:0},dr={capture:!1,passive:!0},bs=function(n){var p=n.elementRef,j=n.enableSmoothScroll,V=n.isRtl,Y=n.scrollDirection,Z=n.onSmoothScroll,pt=e.useState(ur),at=pt[0],q=pt[1],ut=e.useState(p.current),lt=ut[0],Nt=ut[1],Ot=V?-1:1,It=e.useRef(Y);It.current=Y;var Gt=e.useRef(ur),Vt=e.useRef(!0),jt=e.useCallback(function(){Vt.current=!0,j&&q(Gt.current),Z(!1)},[]),Me=e.useCallback(function(){if(lt){switch(It.current){case Zt.Horizontal:Gt.current={left:Ot*lt.scrollLeft,top:0};break;case Zt.Both:Gt.current={left:Ot*lt.scrollLeft,top:lt.scrollTop};break;case Zt.Vertical:default:Gt.current={left:0,top:lt.scrollTop}}j&&!Vt.current||q(Gt.current)}},[lt]);_(function(){Nt(p.current)}),_(function(){if(lt)return lt.addEventListener("scroll",Me,dr),function(){lt.removeEventListener("scroll",Me,dr)}},[lt]);var de=e.useCallback(function(pe,ye){var se=p.current;if(!se)return Promise.resolve();var Se={left:0,top:0};switch(It.current){case Zt.Horizontal:Se.left=Ot*pe.left;break;case Zt.Both:Se.left=Ot*pe.left,Se.top=pe.top;break;case Zt.Vertical:default:Se.top=pe.top}return ye?(Vt.current=!1,Z(!0),new Promise(function(ve,Ne){(function(Oe,Be,He,We,rn,Ke){rn===void 0&&(rn=function(fn){return fn}),Ke===void 0&&(Ke=function(){});var sn=0,Qe=0,en=!1;switch(Be){case Zt.Horizontal:Qe=Oe.scrollLeft,sn=0;case Zt.Both:Qe=Oe.scrollLeft,sn=Oe.scrollTop;break;case Zt.Vertical:default:Qe=0,sn=Oe.scrollTop}var nn=function(){en||(en=!0,Oe.scrollLeft=He.left,Oe.scrollTop=He.top,Ke())};if(Math.abs(sn-He.top)<=Zn&&Be===Zt.Vertical)nn();else if(Math.abs(Qe-He.left)<=Zn&&Be===Zt.Horizontal)nn();else{var tn,dn=-1,An=Qe-He.left,bn=sn-He.top,cn=function(fn){dn===-1&&(dn=fn);var Sn=fn-dn,be=Math.min(Sn/We,1),ge=rn(be),ae={left:Qe-An*ge,top:sn-bn*ge};switch(Be){case Zt.Horizontal:Oe.scrollLeft=ae.left;break;case Zt.Both:Oe.scrollLeft=ae.left,Oe.scrollTop=ae.top;break;case Zt.Vertical:default:Oe.scrollTop=ae.top}Math.abs(ae.top-He.top)<=Zn&&Math.abs(ae.left-He.left)<=Zn&&!en&&(window.cancelAnimationFrame(tn),nn()),Sn<We?tn=window.requestAnimationFrame(cn):window.cancelAnimationFrame(tn)};tn=window.requestAnimationFrame(cn)}})(se,It.current,Se,400,vs,function(){jt(),ve()})})):new Promise(function(ve,Ne){switch(It.current){case Zt.Horizontal:se.scrollLeft=Se.left;break;case Zt.Both:se.scrollLeft=Se.left,se.scrollTop=Se.top;break;case Zt.Vertical:default:se.scrollTop=Se.top}ve()})},[p]);return{scrollOffset:at,scrollTo:de}},Un=function(n,p,j){return Math.max(n,Math.min(j,p))},_s=function(n,p){if(p!==d.ViewMode.DualPageWithCover)return 0;if(!function(Y){var Z=Y.length;if(Z===1)return!1;for(var pt=1;pt<Z;pt++)if(Y[pt].height!==Y[0].height||Y[pt].width!==Y[0].width)return!0;return!1}(n))return 2*n[0].width;var j=et(n.slice(1),2).map(function(Y){return Y.length===2?Y[0].width+Y[1].width:Y[0].width}),V=[n[0].width].concat(j);return Math.max.apply(Math,V)},ys={left:0,top:0},As={left:0,top:0},bi={left:0,top:0},Ss={left:0,top:0},Es={height:0,width:0},fr={left:0,top:0},pr="data-virtual-index",ws=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Cs=function(n){var p=n.enableSmoothScroll,j=n.isRtl,V=n.numberOfItems,Y=n.parentRef,Z=n.setRenderRange,pt=n.sizes,at=n.scrollMode,q=n.viewMode,ut=e.useState(!1),lt=ut[0],Nt=ut[1],Ot=e.useCallback(function(be){return Nt(be)},[]),It=e.useRef(at);It.current=at;var Gt=e.useRef(q);Gt.current=q;var Vt=at===d.ScrollMode.Wrapped||q===d.ViewMode.DualPageWithCover||q===d.ViewMode.DualPage?Zt.Both:at===d.ScrollMode.Horizontal?Zt.Horizontal:Zt.Vertical,jt=bs({elementRef:Y,enableSmoothScroll:p,isRtl:j,scrollDirection:Vt,onSmoothScroll:Ot}),Me=jt.scrollOffset,de=jt.scrollTo,pe=function(be){var ge=be.elementRef,ae=e.useState(ge.current),he=ae[0],oe=ae[1],Ee=e.useRef(!1),Ce=e.useReducer(ms,{height:0,width:0}),ue=Ce[0],ee=Ce[1];return _(function(){ge.current!==he&&oe(ge.current)}),_(function(){if(he&&!Ee.current){Ee.current=!0;var ke=he.getBoundingClientRect(),xe=ke.height,$e=ke.width;ee({rect:{height:xe,width:$e}})}},[he]),e.useEffect(function(){if(he){var ke=new ResizeObserver(function(xe,$e){xe.forEach(function(qe){if(qe.target===he){var hn=qe.contentRect,pn=hn.height,Re=hn.width;ee({rect:{height:pn,width:Re}})}})});return ke.observe(he),function(){ke.unobserve(he)}}},[he]),ue}({elementRef:Y}),ye=e.useRef({scrollOffset:fr,measurements:[]});ye.current.scrollOffset=Me;var se=e.useMemo(function(){return Array(V).fill(-1)},[]),Se=e.useState(se),ve=Se[0],Ne=Se[1],Oe=e.useMemo(function(){var be=new IntersectionObserver(function(ge){ge.forEach(function(ae){var he=ae.isIntersecting?ae.intersectionRatio:-1,oe=ae.target.getAttribute(pr);if(oe){var Ee=parseInt(oe,10);0<=Ee&&Ee<V&&Ne(function(Ce){return Ce[Ee]=he,function(ue,ee,ke){for(var xe,$e=0,qe=ee.length;$e<qe;$e++)!xe&&$e in ee||(xe||(xe=Array.prototype.slice.call(ee,0,$e)),xe[$e]=ee[$e]);return ue.concat(xe||Array.prototype.slice.call(ee))}([],Ce)})}})},{threshold:ws});return be},[]),Be=e.useMemo(function(){return at===d.ScrollMode.Page&&q===d.ViewMode.SinglePage?function(be,ge,ae){for(var he=[],oe=0;oe<be;oe++){var Ee={height:Math.max(ge.height,ae[oe].height),width:Math.max(ge.width,ae[oe].width)},Ce=oe===0?Ss:he[oe-1].end,ue={left:Ce.left+Ee.width,top:Ce.top+Ee.height};he[oe]={index:oe,start:Ce,size:Ee,end:ue,visibility:-1}}return he}(V,pe,pt):q===d.ViewMode.DualPageWithCover?function(be,ge,ae,he){for(var oe=[],Ee=0,Ce=0,ue=bi,ee=0;ee<be;ee++){var ke=ee===0?{height:he===d.ScrollMode.Page?Math.max(ge.height,ae[ee].height):ae[ee].height,width:he===d.ScrollMode.Page?Math.max(ge.width,ae[ee].width):ae[ee].width}:{height:he===d.ScrollMode.Page?Math.max(ge.height,ae[ee].height):ae[ee].height,width:Math.max(ge.width/2,ae[ee].width)};he===d.ScrollMode.Page?ue=ee===0?bi:{left:ee%2==0?ke.width:0,top:Math.floor((ee-1)/2)*ke.height+oe[0].end.top}:ee===0?(ue=bi,Ee=ae[0].height,Ce=0):ee%2==1?(ue={left:0,top:Ee+=Ce},Ce=ee===be-1?ae[ee].height:Math.max(ae[ee].height,ae[ee+1].height)):ue={left:oe[ee-1].end.left,top:Ee};var xe={left:ue.left+ke.width,top:ue.top+ke.height};oe[ee]={index:ee,start:ue,size:ke,end:xe,visibility:-1}}return oe}(V,pe,pt,at):q===d.ViewMode.DualPage?function(be,ge,ae,he){for(var oe=[],Ee=0,Ce=0,ue=As,ee=0;ee<be;ee++){var ke={height:he===d.ScrollMode.Page?Math.max(ge.height,ae[ee].height):ae[ee].height,width:Math.max(ge.width/2,ae[ee].width)};he===d.ScrollMode.Page?ue={left:ee%2==0?0:ke.width,top:Math.floor(ee/2)*ke.height}:ee%2==0?(ue={left:0,top:Ee+=Ce},Ce=ee===be-1?ae[ee].height:Math.max(ae[ee].height,ae[ee+1].height)):ue={left:oe[ee-1].end.left,top:Ee};var xe={left:ue.left+ke.width,top:ue.top+ke.height};oe[ee]={index:ee,start:ue,size:ke,end:xe,visibility:-1}}return oe}(V,pe,pt,at):function(be,ge,ae,he){for(var oe=[],Ee=0,Ce={left:0,top:0},ue=0,ee=ys,ke=0;ke<be;ke++){var xe=ae[ke];if(ke===0)Ee=xe.width,Ce={left:0,top:0},ue=xe.height;else switch(he){case d.ScrollMode.Wrapped:(Ee+=xe.width)<ge.width?(ee={left:oe[ke-1].end.left,top:Ce.top},ue=Math.max(ue,xe.height)):(Ee=xe.width,Ce={left:(ee={left:Ce.left,top:Ce.top+ue}).left,top:ee.top},ue=xe.height);break;case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:ee=oe[ke-1].end}var $e={left:ee.left+xe.width,top:ee.top+xe.height};oe[ke]={index:ke,start:ee,size:xe,end:$e,visibility:-1}}return oe}(V,pe,pt,at)},[at,pt,q,pe]),He=Be[V-1]?{height:Be[V-1].end.top,width:Be[V-1].end.left}:Es;ye.current.measurements=Be;var We=e.useMemo(function(){var be=function(ke,xe,$e,qe){var hn=0;switch(ke){case Zt.Horizontal:hn=qe.left;break;case Zt.Vertical:default:hn=qe.top}var pn=xe.length-1,Re=function(Ve,wn,Ln,ti){for(;Ve<=wn;){var Rn=(Ve+wn)/2|0,jn=ti(Rn);if(jn<Ln)Ve=Rn+1;else{if(!(jn>Ln))return Rn;wn=Rn-1}}return Ve>0?Ve-1:0}(0,pn,hn,function(Ve){switch(ke){case Zt.Horizontal:return xe[Ve].start.left;case Zt.Both:case Zt.Vertical:default:return xe[Ve].start.top}});if(ke===Zt.Both)for(var un=xe[Re].start.top;Re-1>=0&&xe[Re-1].start.top===un&&xe[Re-1].start.left>=qe.left;)Re--;for(var Ye=Re;Ye<=pn;){var Je={top:xe[Ye].start.top-qe.top,left:xe[Ye].start.left-qe.left},on={height:$e.height-Je.top,width:$e.width-Je.left};if(ke===Zt.Horizontal&&on.width<0||ke===Zt.Vertical&&on.height<0||ke===Zt.Both&&(on.width<0||on.height<0))break;Ye++}return{start:Re,end:Ye}}(Vt,Be,pe,Me),ge=be.start,ae=be.end,he=ve.slice(Un(0,V,ge),Un(0,V,ae)),oe=ge+he.reduce(function(ke,xe,$e,qe){return xe>qe[ke]?$e:ke},0),Ee=oe=Un(0,V-1,oe),Ce=Z({endPage:ae,numPages:V,startPage:ge}),ue=Ce.startPage,ee=Ce.endPage;switch(ue=Math.max(ue,0),ee=Math.min(ee,V-1),q){case d.ViewMode.DualPageWithCover:oe>0&&(Ee=oe%2==1?oe:oe-1),ue=ue===0?0:ue%2==1?ue:ue-1,V-(ee=ee%2==1?ee-1:ee)<=2&&(ee=V-1);break;case d.ViewMode.DualPage:Ee=oe%2==0?oe:oe-1,ue=ue%2==0?ue:ue-1,ee=ee%2==1?ee:ee-1;break;case d.ViewMode.SinglePage:default:Ee=oe}return{startPage:ue,endPage:ee,maxVisbilityIndex:Ee}},[Be,pe,Me,q,ve]),rn=We.startPage,Ke=We.endPage,sn=We.maxVisbilityIndex,Qe=e.useMemo(function(){for(var be=[],ge=function(he){var oe=Be[he],Ee=f(f({},oe),{visibility:ve[he]!==void 0?ve[he]:-1,measureRef:function(Ce){Ce&&(Ce.setAttribute(pr,"".concat(he)),Oe.observe(Ce))}});be.push(Ee)},ae=rn;ae<=Ke;ae++)ge(ae);return be},[rn,Ke,ve,Be]),en=e.useCallback(function(be,ge){var ae=ye.current.measurements[Un(0,V-1,be)],he=It.current===d.ScrollMode.Page?fr:ge;return ae?de({left:he.left+ae.start.left,top:he.top+ae.start.top},p):Promise.resolve()},[de,p]),nn=e.useCallback(function(be,ge){var ae=ye.current.measurements,he=ae[be].start,oe=ae.find(function(Ce){return Ce.start.top-he.top>1e-12});if(!oe)return Promise.resolve();var Ee=oe.index;switch(Gt.current){case d.ViewMode.DualPage:Ee=Ee%2==0?Ee:Ee+1;break;case d.ViewMode.DualPageWithCover:Ee=Ee%2==1?Ee:Ee+1}return en(Ee,ge)},[]),tn=e.useCallback(function(be,ge){for(var ae=ye.current.measurements,he=ae[be].start,oe=be,Ee=!1,Ce=V-1;Ce>=0;Ce--)if(he.top-ae[Ce].start.top>1e-12){Ee=!0,oe=ae[Ce].index;break}if(!Ee)return Promise.resolve();switch(Gt.current){case d.ViewMode.DualPage:oe=oe%2==0?oe:oe-1;break;case d.ViewMode.DualPageWithCover:oe=oe%2==0?oe-1:oe}return oe===be&&(oe=be-1),en(oe,ge)},[]),dn=e.useCallback(function(be,ge){if(Gt.current===d.ViewMode.DualPageWithCover||Gt.current===d.ViewMode.DualPage)return nn(be,ge);switch(It.current){case d.ScrollMode.Wrapped:return nn(be,ge);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return en(be+1,ge)}},[]),An=e.useCallback(function(be,ge){if(Gt.current===d.ViewMode.DualPageWithCover||Gt.current===d.ViewMode.DualPage)return tn(be,ge);switch(It.current){case d.ScrollMode.Wrapped:return tn(be,ge);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return en(be-1,ge)}},[]),bn=e.useCallback(function(){return function(be,ge){switch(ge){case d.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(be.width,"px")};case d.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(be.height,"px"),width:"100%"}}}(He,It.current)},[He]),cn=e.useCallback(function(be){return function(ge,ae,he){return he!==d.ScrollMode.Page?{}:{height:"".concat(ae.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(ge.start.top,"px)")}}(be,pe,It.current)},[pe]),fn=e.useCallback(function(be){return function(ge,ae,he,oe,Ee){var Ce,ue,ee,ke,xe,$e,qe,hn=ae?"right":"left",pn=ae?-1:1,Re=he.length,un=ge.start.left*pn,Ye=ge.size,Je=Ye.height,on=Ye.width;if(oe===d.ViewMode.DualPageWithCover){var Ve=Ee===d.ScrollMode.Page?0:ge.start.top;return ge.index===0||Re%2==0&&ge.index===Re-1?((Ce={height:"".concat(Je,"px"),minWidth:"".concat(_s(he,oe),"px"),width:"100%"})[hn]=0,Ce.position="absolute",Ce.top=0,Ce.transform="translate(".concat(un,"px, ").concat(Ve,"px)"),Ce):((ue={height:"".concat(Je,"px"),width:"".concat(on,"px")})[hn]=0,ue.position="absolute",ue.top=0,ue.transform="translate(".concat(un,"px, ").concat(Ve,"px)"),ue)}if(oe===d.ViewMode.DualPage)return(ee={height:"".concat(Je,"px"),width:"".concat(on,"px")})[hn]=0,ee.position="absolute",ee.top=0,ee.transform="translate(".concat(un,"px, ").concat(Ee===d.ScrollMode.Page?0:ge.start.top,"px)"),ee;switch(Ee){case d.ScrollMode.Horizontal:return(ke={height:"100%",width:"".concat(on,"px")})[hn]=0,ke.position="absolute",ke.top=0,ke.transform="translateX(".concat(un,"px)"),ke;case d.ScrollMode.Page:return(xe={height:"".concat(Je,"px"),width:"".concat(on,"px")})[hn]=0,xe.position="absolute",xe.top=0,xe;case d.ScrollMode.Wrapped:return($e={height:"".concat(Je,"px"),width:"".concat(on,"px")})[hn]=0,$e.position="absolute",$e.top=0,$e.transform="translate(".concat(un,"px, ").concat(ge.start.top,"px)"),$e;case d.ScrollMode.Vertical:default:return(qe={height:"".concat(Je,"px"),width:"100%"})[hn]=0,qe.position="absolute",qe.top=0,qe.transform="translateY(".concat(ge.start.top,"px)"),qe}}(be,j,pt,Gt.current,It.current)},[j,pt]),Sn=e.useCallback(function(be,ge){var ae=ye.current,he=ae.measurements,oe=ae.scrollOffset,Ee=he[Un(0,V-1,ge)];if(Ee){var Ce=It.current===d.ScrollMode.Page?{left:Ee.start.left,top:Ee.start.top}:{left:oe.left*be,top:oe.top*be};return de(Ce,!1)}return Promise.resolve()},[]);return e.useEffect(function(){return function(){Oe.disconnect()}},[]),{boundingClientRect:pe,isSmoothScrolling:lt,startPage:rn,endPage:Ke,maxVisbilityIndex:sn,virtualItems:Qe,getContainerStyles:bn,getItemContainerStyles:cn,getItemStyles:fn,scrollToItem:en,scrollToNextItem:dn,scrollToPreviousItem:An,zoom:Sn}},_i=function(n,p,j,V,Y,Z){var pt=j;switch(!0){case(Y===d.ViewMode.DualPageWithCover&&Z>=3):case(Y===d.ViewMode.DualPage&&Z>=3):pt=2*j;break;default:pt=j}switch(V){case d.SpecialZoomLevel.ActualSize:return 1;case d.SpecialZoomLevel.PageFit:return Math.min((n.clientWidth-17)/pt,(n.clientHeight-16)/p);case d.SpecialZoomLevel.PageWidth:return(n.clientWidth-17)/pt}},Ps=function(n){var p,j,V=n.getCurrentPage,Y=(p=50,j=e.useRef([]),e.useEffect(function(){return function(){j.current=[]}},[]),{push:function(ut){var lt=j.current;lt.length+1>p&&lt.shift(),lt.push(ut),j.current=lt},map:function(ut){return j.current.map(function(lt){return ut(lt)})},pop:function(){var ut=j.current;if(ut.length===0)return null;var lt=ut.pop();return j.current=ut,lt}}),Z=function(ut){var lt=e.useRef([]);return e.useEffect(function(){return function(){lt.current=[]}},[]),{dequeue:function(){var Nt=lt.current;if(Nt.length===0)return null;var Ot=Nt.shift();return lt.current=Nt,Ot||null},enqueue:function(Nt){var Ot=lt.current;Ot.length+1>ut&&Ot.pop(),lt.current=[Nt].concat(Ot)},map:function(Nt){return lt.current.map(function(Ot){return Nt(Ot)})}}}(50),pt=function(){var ut=Z.dequeue();return ut&&Y.push(ut),ut&&ut.pageIndex===V()?pt():ut},at=function(){var ut=Y.pop();return ut&&Z.enqueue(ut),ut&&ut.pageIndex===V()?at():ut},q=e.useCallback(function(ut){Y.push(ut)},[]);return{getNextDestination:pt,getPreviousDestination:at,markVisitedDestination:q}},gr=function(n){var p=[];return n.map(function(j){p=p.concat(j).concat(function(V){var Y=[];return V.items&&V.items.length>0&&(Y=Y.concat(gr(V.items))),Y}(j))}),p},mr={capture:!1,passive:!0},Ts={height:0,width:0},yi={height:0,width:0},ks=function(n){var p=n.getCurrentPage,j=n.getCurrentScrollMode,V=n.jumpToPage,Y=n.targetRef,Z=e.useState(d.FullScreenMode.Normal),pt=Z[0],at=Z[1],q=function(){var ve=e.useState(Ts),Ne=ve[0],Oe=ve[1],Be=bt(function(){Oe({height:window.innerHeight,width:window.innerWidth})},100);return _(function(){return window.addEventListener("resize",Be,mr),function(){window.removeEventListener("resize",Be,mr)}},[]),Ne}(),ut=e.useState(yi),lt=ut[0],Nt=ut[1],Ot=e.useRef(yi),It=e.useRef(p()),Gt=e.useRef(yi),Vt=e.useState(Y.current),jt=Vt[0],Me=Vt[1],de=e.useRef();_(function(){Y.current!==jt&&Me(Y.current)},[]),_(function(){if(jt){var ve=new ResizeObserver(function(Ne){Ne.forEach(function(Oe){var Be=Oe.target.getBoundingClientRect(),He=Be.height,We=Be.width;Nt({height:He,width:We})})});return ve.observe(jt),function(){ve.unobserve(jt),ve.disconnect()}}},[jt]);var pe=e.useCallback(function(ve){var Ne=I();return Ne&&Ne!==ve?(at(d.FullScreenMode.Normal),w(Ne)):Promise.resolve()},[]),ye=e.useCallback(function(ve){ve&&l()&&(Me(ve),pe(ve).then(function(){de.current=ve,at(d.FullScreenMode.Entering),function(Ne){h&&Ne[B.RequestFullScreen]()}(ve)}))},[]),se=e.useCallback(function(){I()&&(at(d.FullScreenMode.Exitting),w(document))},[]),Se=e.useCallback(function(){jt&&I()!==jt&&at(d.FullScreenMode.Exitting)},[jt]);return e.useEffect(function(){switch(pt){case d.FullScreenMode.Entering:de.current&&(de.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),It.current=p(),Ot.current={height:window.innerHeight,width:window.innerWidth};break;case d.FullScreenMode.Entered:j()===d.ScrollMode.Page?V(It.current).then(function(){at(d.FullScreenMode.EnteredCompletely)}):at(d.FullScreenMode.EnteredCompletely);break;case d.FullScreenMode.Exitting:de.current&&(de.current.style.backgroundColor="",de.current=null),It.current=p();break;case d.FullScreenMode.Exited:at(d.FullScreenMode.Normal),j()===d.ScrollMode.Page&&V(It.current)}},[pt]),e.useEffect(function(){if(pt!==d.FullScreenMode.Normal)return pt===d.FullScreenMode.Entering&&q.height===lt.height&&q.width===lt.width&&q.height>0&&q.width>0&&(Gt.current.height===0||q.height==Gt.current.height)?(Gt.current={height:window.innerHeight,width:window.innerWidth},void at(d.FullScreenMode.Entered)):void(pt===d.FullScreenMode.Exitting&&Ot.current.height===q.height&&Ot.current.width===q.width&&q.height>0&&q.width>0&&at(d.FullScreenMode.Exited))},[pt,q,lt]),e.useEffect(function(){var ve;return ve=Se,h&&document.addEventListener(B.FullScreenChange,ve),function(){(function(Ne){h&&document.removeEventListener(B.FullScreenChange,Ne)})(Se)}},[jt]),{enterFullScreenMode:ye,exitFullScreenMode:se,fullScreenMode:pt}},Rs={buildPageStyles:function(){return{}},transformSize:function(n){return n.size}},Fn={left:0,top:0},Ms=function(n){var p=n.currentFile,j=n.defaultScale,V=n.doc,Y=n.enableSmoothScroll,Z=n.initialPage,pt=n.initialRotation,at=n.initialScale,q=n.pageLayout,ut=n.pageSizes,lt=n.plugins,Nt=n.renderPage,Ot=n.scrollMode,It=n.setRenderRange,Gt=n.viewMode,Vt=n.viewerState,jt=n.onDocumentLoad,Me=n.onOpenFile,de=n.onPageChange,pe=n.onRotate,ye=n.onRotatePage,se=n.onZoom,Se=V.numPages,ve=V.loadingTask.docId,Ne=e.useContext(ct).l10n,Oe=e.useContext(W),Be=Oe.direction===d.TextDirection.RightToLeft,He=e.useRef(),We=e.useRef(),rn=e.useState(Z),Ke=rn[0],sn=rn[1],Qe=e.useRef(null),en=Ps({getCurrentPage:function(){return Re.current.pageIndex}}),nn=e.useState(pt),tn=nn[0],dn=nn[1],An=rt(tn),bn=e.useState(!1),cn=bn[0],fn=bn[1],Sn=e.useState(new Map),be=Sn[0],ge=Sn[1],ae=e.useState(Ot),he=ae[0],oe=ae[1],Ee=rt(he),Ce=e.useState(Gt),ue=Ce[0],ee=Ce[1],ke=rt(ue),xe=function(Ut){var Pe=K(),Le=e.useState([]),ze=Le[0],Ue=Le[1];return e.useEffect(function(){Ut.getOutline().then(function(De){if(Pe.current&&De!==null){var ln=gr(De);Ue(ln)}})},[]),ze}(V),$e=e.useState(at),qe=$e[0],hn=$e[1],pn=rt(qe),Re=e.useRef(Vt),un=e.useRef(typeof j=="string"?j:null),Ye=e.useRef(-1),Je=e.useRef(-1),on=e.useRef(Z),Ve=ks({getCurrentPage:function(){return Re.current.pageIndex},getCurrentScrollMode:function(){return Re.current.scrollMode},jumpToPage:function(Ut){return Pn(Ut)},targetRef:We}),wn=e.useState(-1),Ln=wn[0],ti=wn[1],Rn=e.useState(0),jn=Rn[0],Os=Rn[1],gn=x({doc:V});e.useEffect(function(){return function(){Ht.clear(),me.clear()}},[ve]);var yr=e.useMemo(function(){return Object.assign({},Rs,q)},[]),Ns=e.useMemo(function(){return Array(Se).fill(0).map(function(Ut,Pe){var Le=[ut[Pe].pageHeight,ut[Pe].pageWidth],ze=Math.abs(tn)%180==0?{height:Le[0],width:Le[1]}:{height:Le[1],width:Le[0]},Ue={height:ze.height*qe,width:ze.width*qe};return yr.transformSize({numPages:Se,pageIndex:Pe,size:Ue})})},[tn,qe]),Ge=Cs({enableSmoothScroll:Y,isRtl:Be,numberOfItems:Se,parentRef:We,scrollMode:he,setRenderRange:It,sizes:Ns,viewMode:ue}),Bs=bt(function(){!un.current||Re.current.fullScreenMode!==d.FullScreenMode.Normal||Z>0&&on.current===Z||Mn(un.current)},200);(function(Ut){var Pe=Ut.targetRef,Le=Ut.onResize;_(function(){var ze=new ResizeObserver(function(De){De.forEach(function(ln){Le(ln.target)})}),Ue=Pe.current;if(Ue)return ze.observe(Ue),function(){ze.unobserve(Ue)}},[])})({targetRef:We,onResize:Bs});var Cn=function(Ut){var Pe=Ut;lt.forEach(function(Le){Le.onViewerStateChange&&(Pe=Le.onViewerStateChange(Pe))}),Re.current=Pe},Hs=function(){return We.current},Us=function(){return Re.current},js=e.useCallback(function(Ut){en.markVisitedDestination(Ut)},[]),Ei=e.useCallback(function(Ut){var Pe=Ut.pageIndex,Le=Ut.bottomOffset,ze=Ut.leftOffset,Ue=Ut.scaleTo,De=We.current,ln=Re.current;return De&&ln?new Promise(function(Tn,Ri){Yt(V,Pe).then(function(ei){var kn=ei.getViewport({scale:1}),ni=0,kr=(typeof Le=="function"?Le(kn.width,kn.height):Le)||0,ii=(typeof ze=="function"?ze(kn.width,kn.height):ze)||0,Dn=ln.scale;switch(Ue){case d.SpecialZoomLevel.PageFit:ni=0,ii=0,Mn(d.SpecialZoomLevel.PageFit);break;case d.SpecialZoomLevel.PageWidth:Dn=_i(De,ut[Pe].pageHeight,ut[Pe].pageWidth,d.SpecialZoomLevel.PageWidth,Gt,Se),ni=(kn.height-kr)*Dn,ii*=Dn,Mn(Dn);break;default:ni=(kn.height-kr)*Dn,ii*=Dn}switch(ln.scrollMode){case d.ScrollMode.Horizontal:Ge.scrollToItem(Pe,{left:ii,top:0}).then(function(){Tn()});break;case d.ScrollMode.Vertical:default:Ge.scrollToItem(Pe,{left:0,top:ni}).then(function(){Tn()})}})}):Promise.resolve()},[]),Ar=e.useCallback(function(Ut){return en.markVisitedDestination(Ut),Ei(Ut)},[]),Ws=e.useCallback(function(){var Ut=en.getNextDestination();return Ut?Ei(Ut):Promise.resolve()},[]),zs=e.useCallback(function(){var Ut=en.getPreviousDestination();return Ut?Ei(Ut):Promise.resolve()},[]),Vs=e.useCallback(function(){return Ge.scrollToNextItem(Re.current.pageIndex,Fn)},[]),Pn=e.useCallback(function(Ut){return 0<=Ut&&Ut<Se?Ge.scrollToItem(Ut,Fn):Promise.resolve()},[]),qs=e.useCallback(function(){return Ge.scrollToPreviousItem(Re.current.pageIndex,Fn)},[]),Sr=e.useCallback(function(Ut){var Pe,Le;(Pe=Ut.name,Le=Pe.split(/\./).pop(),Le?Le.toLowerCase():"").toLowerCase()==="pdf"&&new Promise(function(ze){var Ue=new FileReader;Ue.readAsArrayBuffer(Ut),Ue.onload=function(){var De=new Uint8Array(Ue.result);ze(De)}}).then(function(ze){Me(Ut.name,ze)})},[Me]),Er=e.useCallback(function(Ut){var Pe=Ut===d.RotateDirection.Backward?-90:90,Le=Re.current.rotation,ze=Le===360||Le===-360?Pe:Le+Pe;gn.markNotRendered(),dn(ze),Cn(f(f({},Re.current),{rotation:ze})),pe({direction:Ut,doc:V,rotation:ze})},[]),wi=e.useCallback(function(Ut,Pe){var Le=Pe===d.RotateDirection.Backward?-90:90,ze=Re.current.pagesRotation,Ue=(ze.has(Ut)?ze.get(Ut):pt)+Le,De=ze.set(Ut,Ue);ge(De),fn(function(ln){return!ln}),Cn(f(f({},Re.current),{pagesRotation:De,rotatedPage:Ut})),ye({direction:Pe,doc:V,pageIndex:Ut,rotation:Ue}),gn.markRendering(Ut),ti(Ut)},[]),wr=e.useCallback(function(Ut){Cn(f(f({},Re.current),{scrollMode:Ut})),oe(Ut)},[]),Cr=e.useCallback(function(Ut){Cn(f(f({},Re.current),{viewMode:Ut})),ee(Ut)},[]),Mn=e.useCallback(function(Ut){var Pe=We.current,Le=Re.current.pageIndex;if(!(Le<0||Le>=Se)){var ze=ut[Le].pageHeight,Ue=ut[Le].pageWidth,De=Pe?typeof Ut=="string"?_i(Pe,ze,Ue,Ut,Re.current.viewMode,Se):Ut:1;un.current=typeof Ut=="string"?Ut:null,De!==Re.current.scale&&(Os(function(ln){return ln+1}),gn.markNotRendered(),hn(De),se({doc:V,scale:De}),Cn(f(f({},Re.current),{scale:De})))}},[]),Gs=e.useCallback(function(Ut){Ve.enterFullScreenMode(Ut)},[]),Xs=e.useCallback(function(){Ve.exitFullScreenMode()},[]);e.useEffect(function(){Cn(f(f({},Re.current),{fullScreenMode:Ve.fullScreenMode}))},[Ve.fullScreenMode]),e.useEffect(function(){var Ut={enterFullScreenMode:Gs,exitFullScreenMode:Xs,getPagesContainer:Hs,getViewerState:Us,jumpToDestination:Ar,jumpToNextDestination:Ws,jumpToPreviousDestination:zs,jumpToNextPage:Vs,jumpToPreviousPage:qs,jumpToPage:Pn,openFile:Sr,rotate:Er,rotatePage:wi,setViewerState:Cn,switchScrollMode:wr,switchViewMode:Cr,zoom:Mn};return lt.forEach(function(Pe){Pe.install&&Pe.install(Ut)}),function(){lt.forEach(function(Pe){Pe.uninstall&&Pe.uninstall(Ut)})}},[ve]),e.useEffect(function(){jt({doc:V,file:p}),lt.forEach(function(Ut){Ut.onDocumentLoad&&Ut.onDocumentLoad({doc:V,file:p})})},[ve]);var Ci,Pi,Ti,Pr=Ge.boundingClientRect;Ci=function(){Z&&Pn(Z)},Pi=Pr.height>0&&Pr.width>0,Ti=e.useRef(!1),_(function(){Pi&&!Ti.current&&(Ti.current=!0,Ci())},[Ci,Pi]),_(function(){var Ut=Re.current.pageIndex;Ut>-1&&Ee!==he&&Ge.scrollToItem(Ut,Fn).then(function(){Ve.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(Y||gn.markNotRendered(),Ye.current=-1)})},[he]),_(function(){var Ut=Re.current.pageIndex;Ut>-1&&An!==tn&&Ge.scrollToItem(Ut,Fn)},[tn]),_(function(){pn!=0&&pn!=Re.current.scale&&Ge.zoom(Re.current.scale/pn,Re.current.pageIndex).then(function(){Ve.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(Je.current=-1)})},[qe]),_(function(){if(ke!==Re.current.viewMode){var Ut=Ge.startPage,Pe=Ge.endPage,Le=Ge.virtualItems;gn.markNotRendered(),gn.setRange(Ut,Pe);for(var ze=function(De){var ln=Le.find(function(Tn){return Tn.index===De});ln&&gn.setVisibility(De,ln.visibility)},Ue=Ut;Ue<=Pe;Ue++)ze(Ue);ki()}},[ue]),_(function(){var Ut=Re.current.pageIndex;Ut>-1&&ke!==ue&&Ge.scrollToItem(Ut,Fn)},[ue]),_(function(){var Ut=Re.current.pageIndex;Ut>0&&Ut===Z&&on.current===Z&&un.current&&(on.current=-1,Mn(un.current))},[Ke]),e.useEffect(function(){Ge.isSmoothScrolling||Qe.current!==null&&Qe.current===Ke||(Qe.current=Ke,de({currentPage:Ke,doc:V}))},[Ke,Ge.isSmoothScrolling]),e.useEffect(function(){Ve.fullScreenMode===d.FullScreenMode.Entering&&Re.current.scrollMode===d.ScrollMode.Page&&(Ye.current=Re.current.pageIndex),Ve.fullScreenMode===d.FullScreenMode.EnteredCompletely&&Re.current.scrollMode===d.ScrollMode.Page&&Y&&(Ye.current=-1),Ve.fullScreenMode===d.FullScreenMode.EnteredCompletely&&un.current&&(Je.current=Re.current.pageIndex,Mn(un.current))},[Ve.fullScreenMode]),e.useEffect(function(){if(Ve.fullScreenMode!==d.FullScreenMode.Entering&&Ve.fullScreenMode!==d.FullScreenMode.Exitting&&!Ge.isSmoothScrolling){var Ut=Ge.startPage,Pe=Ge.endPage,Le=Ge.maxVisbilityIndex,ze=Ge.virtualItems,Ue=Le,De=Ve.fullScreenMode===d.FullScreenMode.Entered||Ve.fullScreenMode===d.FullScreenMode.EnteredCompletely;if(!(De&&Ue!==Ye.current&&Ye.current>-1||De&&Ue!==Je.current&&Je.current>-1)){sn(Ue),Cn(f(f({},Re.current),{pageIndex:Ue})),gn.setRange(Ut,Pe);for(var ln=function(Ri){var ei=ze.find(function(kn){return kn.index===Ri});ei&&gn.setVisibility(Ri,ei.visibility)},Tn=Ut;Tn<=Pe;Tn++)ln(Tn);ki()}}},[Ge.startPage,Ge.endPage,Ge.isSmoothScrolling,Ge.maxVisbilityIndex,Ve.fullScreenMode,cn,tn,qe]);var $s=e.useCallback(function(Ut){gn.markRendered(Ut),ki()},[jn]),ki=function(){var Ut=gn.getHighestPriorityPage();Ut>-1&&gn.isInRange(Ut)&&(gn.markRendering(Ut),ti(Ut))},Ys=function(Ut){var Pe=Ke-1,Le=Ke+1;switch(Ut){case"FirstPage":Pn(0);break;case"LastPage":Pn(Se-1);break;case"NextPage":Le<Se&&Pn(Le);break;case"PrevPage":Pe>=0&&Pn(Pe)}},Ks=e.useCallback(function(){var Ut=Ge.virtualItems,Pe=[];switch(ue){case d.ViewMode.DualPage:Pe=et(Ut,2);break;case d.ViewMode.DualPageWithCover:Ut.length&&(Pe=Ut[0].index===0?[[Ut[0]]].concat(et(Ut.slice(1),2)):et(Ut,2));break;case d.ViewMode.SinglePage:default:Pe=et(Ut,1)}var Le=Ne&&Ne.core?Ne.core.pageLabel:"Page {{pageIndex}}",ze={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:He,style:{height:"100%"}},children:e.createElement(e.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:A({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":he===d.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":Be,"rpv-core__inner-pages--single":he===d.ScrollMode.Page,"rpv-core__inner-pages--vertical":he===d.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":he===d.ScrollMode.Wrapped}),ref:We,style:{height:"100%",position:"relative"}},children:e.createElement("div",{"data-testid":"core__inner-current-page-".concat(Ke),style:Object.assign({"--scale-factor":qe},Ge.getContainerStyles())},Pe.map(function(Ue){return e.createElement("div",{className:A({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":he===d.ScrollMode.Page}),style:Ge.getItemContainerStyles(Ue[0]),key:"".concat(Ue[0].index,"-").concat(ue)},Ue.map(function(De){var ln=ue===d.ViewMode.DualPageWithCover&&(De.index===0||Se%2==0&&De.index===Se-1);return e.createElement("div",{"aria-label":Le.replace("{{pageIndex}}","".concat(De.index+1)),className:A({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":ue===d.ViewMode.DualPage&&De.index%2==0,"rpv-core__inner-page--dual-odd":ue===d.ViewMode.DualPage&&De.index%2==1,"rpv-core__inner-page--dual-cover":ln,"rpv-core__inner-page--dual-cover-even":ue===d.ViewMode.DualPageWithCover&&!ln&&De.index%2==0,"rpv-core__inner-page--dual-cover-odd":ue===d.ViewMode.DualPageWithCover&&!ln&&De.index%2==1,"rpv-core__inner-page--single":ue===d.ViewMode.SinglePage&&he===d.ScrollMode.Page}),role:"region",key:"".concat(De.index,"-").concat(ue),style:Object.assign({},Ge.getItemStyles(De),yr.buildPageStyles({numPages:Se,pageIndex:De.index,scrollMode:he,viewMode:ue}))},e.createElement(gs,{doc:V,measureRef:De.measureRef,outlines:xe,pageIndex:De.index,pageRotation:be.has(De.index)?be.get(De.index):0,pageSize:ut[De.index],plugins:lt,renderPage:Nt,renderQueueKey:jn,rotation:tn,scale:qe,shouldRender:Ln===De.index,viewMode:ue,onExecuteNamedAction:Ys,onJumpFromLinkAnnotation:js,onJumpToDest:Ar,onRenderCompleted:$s,onRotatePage:wi}))}))}))}};return lt.forEach(function(Ue){Ue.renderViewer&&(ze=Ue.renderViewer({containerRef:He,doc:V,pagesContainerRef:We,pagesRotation:be,pageSizes:ut,rotation:tn,slot:ze,themeContext:Oe,jumpToPage:Pn,openFile:Sr,rotate:Er,rotatePage:wi,switchScrollMode:wr,switchViewMode:Cr,zoom:Mn}))}),ze},[lt,Ge]),Tr=e.useCallback(function(Ut){return e.createElement("div",f({},Ut.attrs,{style:Ut.attrs&&Ut.attrs.style?Ut.attrs.style:{}}),Ut.children,Ut.subSlot&&Tr(Ut.subSlot))},[]);return Tr(Ks())},vr=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],xs=function(n){var p=n.defaultScale,j=n.doc,V=n.render,Y=n.scrollMode,Z=n.viewMode,pt=e.useRef(),at=e.useState({pageSizes:[],scale:0}),q=at[0],ut=at[1];return e.useLayoutEffect(function(){var lt=Array(j.numPages).fill(0).map(function(Nt,Ot){return new Promise(function(It,Gt){Yt(j,Ot).then(function(Vt){var jt=Vt.getViewport({scale:1});It({pageHeight:jt.height,pageWidth:jt.width,rotation:jt.rotation})})})});Promise.all(lt).then(function(Nt){var Ot=pt.current;if(Ot&&Nt.length!==0){var It=Nt[0].pageWidth,Gt=Nt[0].pageHeight,Vt=Ot.parentElement,jt=(Vt.clientWidth-45)/It,Me=(Vt.clientHeight-45)/Gt,de=jt;switch(Y){case d.ScrollMode.Horizontal:de=Math.min(jt,Me);break;case d.ScrollMode.Vertical:default:de=jt}var pe,ye,se=p?typeof p=="string"?_i(Vt,Gt,It,p,Z,j.numPages):p:(pe=de,(ye=vr.findIndex(function(Se){return Se>=pe}))===-1||ye===0?pe:vr[ye-1]);ut({pageSizes:Nt,scale:se})}})},[j.loadingTask.docId]),q.pageSizes.length===0||q.scale===0?e.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:pt},e.createElement(H,null)):V(q.pageSizes,q.scale)},Qn=function(){},Ai=function(n){function p(j,V){var Y=n.call(this)||this;return Y.verifyPassword=j,Y.passwordStatus=V,Y}return G(p,n),p}(Qn),Fs=function(n){var p=n.passwordStatus,j=n.renderProtectedView,V=n.verifyPassword,Y=n.onDocumentAskPassword,Z=e.useContext(ct).l10n,pt=e.useState(""),at=pt[0],q=pt[1],ut=e.useContext(W).direction===d.TextDirection.RightToLeft,lt=function(){return V(at)};return e.useEffect(function(){Y&&Y({verifyPassword:V})},[]),j?j({passwordStatus:p,verifyPassword:V}):e.createElement("div",{className:"rpv-core__asking-password-wrapper"},e.createElement("div",{className:A({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":ut})},e.createElement("div",{className:"rpv-core__asking-password-message"},p===d.PasswordStatus.RequiredPassword&&Z.core.askingPassword.requirePasswordToOpen,p===d.PasswordStatus.WrongPassword&&Z.core.wrongPassword.tryAgain),e.createElement("div",{className:"rpv-core__asking-password-body"},e.createElement("div",{className:A({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!ut,"rpv-core__asking-password-input--rtl":ut})},e.createElement(C,{testId:"core__asking-password-input",type:"password",value:at,onChange:q,onKeyDown:function(Nt){Nt.key==="Enter"&&lt()}})),e.createElement(E,{onClick:lt},Z.core.askingPassword.submit))))},br=function(n){function p(j){var V=n.call(this)||this;return V.doc=j,V}return G(p,n),p}(Qn),_r=function(n){function p(j){var V=n.call(this)||this;return V.error=j,V}return G(p,n),p}(Qn),Si=function(n){function p(j){var V=n.call(this)||this;return V.percentages=j,V}return G(p,n),p}(Qn),Ls=function(n){var p=n.characterMap,j=n.file,V=n.httpHeaders,Y=n.render,Z=n.renderError,pt=n.renderLoader,at=n.renderProtectedView,q=n.transformGetDocumentParams,ut=n.withCredentials,lt=n.onDocumentAskPassword,Nt=e.useContext(W).direction===d.TextDirection.RightToLeft,Ot=e.useState(new Si(0)),It=Ot[0],Gt=Ot[1],Vt=e.useRef(""),jt=K();return e.useEffect(function(){Vt.current="",Gt(new Si(0));var Me=new it.PDFWorker({name:"PDFWorker_".concat(Date.now())}),de=Object.assign({httpHeaders:V,withCredentials:ut,worker:Me},typeof j=="string"?{url:j}:{data:j},p?{cMapUrl:p.url,cMapPacked:p.isCompressed}:{}),pe=q?q(de):de,ye=it.getDocument(pe);return ye.onPassword=function(se,Se){switch(Se){case it.PasswordResponses.NEED_PASSWORD:jt.current&&Gt(new Ai(se,d.PasswordStatus.RequiredPassword));break;case it.PasswordResponses.INCORRECT_PASSWORD:jt.current&&Gt(new Ai(se,d.PasswordStatus.WrongPassword))}},ye.onProgress=function(se){var Se=se.total>0?Math.min(100,100*se.loaded/se.total):100;jt.current&&Vt.current===""&&Gt(new Si(Se))},ye.promise.then(function(se){Vt.current=se.loadingTask.docId,jt.current&&Gt(new br(se))},function(se){return jt.current&&!Me.destroyed&&Gt(new _r({message:se.message||"Cannot load document",name:se.name}))}),function(){ye.destroy(),Me.destroy()}},[j]),It instanceof Ai?e.createElement(Fs,{passwordStatus:It.passwordStatus,renderProtectedView:at,verifyPassword:It.verifyPassword,onDocumentAskPassword:lt}):It instanceof br?Y(It.doc):It instanceof _r?Z?Z(It.error):e.createElement("div",{className:A({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":Nt})},e.createElement("div",{className:"rpv-core__doc-error-text"},It.error.message)):e.createElement("div",{"data-testid":"core__doc-loading",className:A({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":Nt})},pt?pt(It.percentages):e.createElement(H,null))},Ds=function(n,p){var j=e.useMemo(function(){return n==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n},[]),V=e.useState(j),Y=V[0],Z=V[1],pt=rt(Y);return e.useEffect(function(){if(n==="auto"){var at=window.matchMedia("(prefers-color-scheme: dark)"),q=function(ut){Z(ut.matches?"dark":"light")};return at.addEventListener("change",q),function(){return at.removeEventListener("change",q)}}},[]),e.useEffect(function(){Y!==pt&&p&&p(Y)},[Y]),e.useEffect(function(){n!==Y&&Z(n)},[n]),{currentTheme:Y,setCurrentTheme:Z}},Is=function(n){return{startPage:n.startPage-3,endPage:n.endPage+3}};d.Button=function(n){var p=n.children,j=n.testId,V=n.onClick,Y=e.useContext(W).direction===d.TextDirection.RightToLeft,Z=j?{"data-testid":j}:{};return e.createElement("button",f({className:A({"rpv-core__button":!0,"rpv-core__button--rtl":Y}),type:"button",onClick:V},Z),p)},d.Icon=y,d.LazyRender=function(n){var p=n.attrs,j=n.children,V=n.testId,Y=e.useState(!1),Z=Y[0],pt=Y[1],at=V?f(f({},p),{"data-testid":V}):p,q=R({once:!0,onVisibilityChanged:function(ut){ut.isVisible&&pt(!0)}});return e.createElement("div",f({ref:q},at),Z&&j)},d.LocalizationContext=ct,d.Menu=function(n){var p=n.children,j=e.useRef(),V=e.useRef([]),Y=e.useContext(W).direction===d.TextDirection.RightToLeft,Z=function(at){if(j.current)switch(at.key){case"Tab":at.preventDefault();break;case"ArrowDown":at.preventDefault(),pt(function(q,ut){return ut+1});break;case"ArrowUp":at.preventDefault(),pt(function(q,ut){return ut-1});break;case"End":at.preventDefault(),pt(function(q,ut){return q.length-1});break;case"Home":at.preventDefault(),pt(function(q,ut){return 0})}},pt=function(at){if(j.current){var q=V.current,ut=q.findIndex(function(Nt){return Nt.getAttribute("tabindex")==="0"}),lt=Math.min(q.length-1,Math.max(0,at(q,ut)));ut>=0&&ut<=q.length-1&&q[ut].setAttribute("tabindex","-1"),q[lt].setAttribute("tabindex","0"),q[lt].focus()}};return _(function(){var at=j.current;if(at){var q=function(ut){var lt=[];return ut.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach(function(Nt){if(Nt instanceof HTMLElement){var Ot=Nt.parentElement;(Ot===ut||window.getComputedStyle(Ot).display!=="none")&&lt.push(Nt)}}),lt}(at);V.current=q}},[]),_(function(){return document.addEventListener("keydown",Z),function(){document.removeEventListener("keydown",Z)}},[]),e.createElement("div",{ref:j,"aria-orientation":"vertical",className:A({"rpv-core__menu":!0,"rpv-core__menu--rtl":Y}),role:"menu",tabIndex:0},p)},d.MenuDivider=function(){return e.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},d.MenuItem=function(n){var p=n.checked,j=p!==void 0&&p,V=n.children,Y=n.icon,Z=Y===void 0?null:Y,pt=n.isDisabled,at=pt!==void 0&&pt,q=n.testId,ut=n.onClick,lt=e.useContext(W).direction===d.TextDirection.RightToLeft,Nt=q?{"data-testid":q}:{};return e.createElement("button",f({className:A({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":at,"rpv-core__menu-item--ltr":!lt,"rpv-core__menu-item--rtl":lt}),role:"menuitem",tabIndex:-1,type:"button",onClick:ut},Nt),e.createElement("div",{className:A({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!lt,"rpv-core__menu-item-icon--rtl":lt})},Z),e.createElement("div",{className:A({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!lt,"rpv-core__menu-item-label--rtl":lt})},V),e.createElement("div",{className:A({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!lt,"rpv-core__menu-item-check--rtl":lt})},j&&e.createElement(m,null)))},d.MinimalButton=function(n){var p=n.ariaLabel,j=p===void 0?"":p,V=n.ariaKeyShortcuts,Y=V===void 0?"":V,Z=n.children,pt=n.isDisabled,at=pt!==void 0&&pt,q=n.isSelected,ut=q!==void 0&&q,lt=n.testId,Nt=n.onClick,Ot=e.useContext(W).direction===d.TextDirection.RightToLeft,It=lt?{"data-testid":lt}:{};return e.createElement("button",f({"aria-label":j},Y&&{"aria-keyshortcuts":Y},at&&{"aria-disabled":!0},{className:A({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":at,"rpv-core__minimal-button--rtl":Ot,"rpv-core__minimal-button--selected":ut}),type:"button",onClick:Nt},It),Z)},d.Modal=function(n){var p=n.ariaControlsSuffix,j=n.closeOnClickOutside,V=n.closeOnEscape,Y=n.content,Z=n.isOpened,pt=Z!==void 0&&Z,at=n.target,q=p||"".concat(i());return e.createElement(vt,{target:at?function(ut,lt){return e.createElement("div",{"aria-expanded":lt?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(q)},at(ut,lt))}:null,content:function(ut){return e.createElement(D,null,e.createElement(L,{ariaControlsSuffix:q,closeOnClickOutside:j,closeOnEscape:V,onToggle:ut},Y(ut)))},isOpened:pt})},d.Popover=function(n){var p=n.ariaHasPopup,j=p===void 0?"dialog":p,V=n.ariaControlsSuffix,Y=n.closeOnClickOutside,Z=n.closeOnEscape,pt=n.content,at=n.lockScroll,q=at===void 0||at,ut=n.offset,lt=n.position,Nt=n.target,Ot=Q(!1),It=Ot.opened,Gt=Ot.toggle,Vt=e.useRef(),jt=e.useMemo(function(){return V||"".concat(i())},[]);return e.createElement("div",{ref:Vt,"aria-expanded":It?"true":"false","aria-haspopup":j,"aria-controls":"rpv-core__popver-body-".concat(jt)},Nt(Gt,It),It&&e.createElement(e.Fragment,null,q&&e.createElement(Ct,{closeOnEscape:Z,onClose:Gt}),e.createElement(ft,{ariaControlsSuffix:jt,closeOnClickOutside:Y,offset:ut,position:lt,targetRef:Vt,onClose:Gt},pt(Gt))))},d.PrimaryButton=E,d.ProgressBar=function(n){var p=n.progress,j=e.useContext(W).direction===d.TextDirection.RightToLeft;return e.createElement("div",{className:A({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":j})},e.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(p,"%")}},p,"%"))},d.Separator=function(){return e.createElement("div",{className:"rpv-core__separator"})},d.Spinner=H,d.Splitter=function(n){var p=n.constrain,j=e.useContext(W).direction===d.TextDirection.RightToLeft,V=e.useRef(),Y=e.useRef(),Z=e.useRef(),pt=e.useRef(0),at=e.useRef(0),q=e.useRef(0),ut=e.useRef(0),lt={capture:!0},Nt=function(It){var Gt=V.current,Vt=Y.current,jt=Z.current;if(Gt&&Vt&&jt){var Me=ut.current,de=It.clientX-pt.current,pe=q.current+(j?-de:de),ye=Gt.parentElement.getBoundingClientRect().width,se=100*pe/ye;if(Gt.classList.add("rpv-core__splitter--resizing"),p){var Se=ye-pe-Me;if(!p({firstHalfPercentage:se,firstHalfSize:pe,secondHalfPercentage:100*Se/ye,secondHalfSize:Se}))return}Vt.style.width="".concat(se,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),Vt.classList.add("rpv-core__splitter-sibling--resizing"),jt.classList.add("rpv-core__splitter-sibling--resizing")}},Ot=function(It){var Gt=V.current,Vt=Y.current,jt=Z.current;Gt&&Vt&&jt&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),Gt.classList.remove("rpv-core__splitter--resizing"),Vt.classList.remove("rpv-core__splitter-sibling--resizing"),jt.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",Nt,lt),document.removeEventListener("mouseup",Ot,lt))};return e.useEffect(function(){var It=V.current;It&&(ut.current=It.getBoundingClientRect().width,Y.current=It.previousElementSibling,Z.current=It.nextElementSibling)},[]),e.createElement("div",{ref:V,className:"rpv-core__splitter",onMouseDown:function(It){var Gt=Y.current;Gt&&(pt.current=It.clientX,at.current=It.clientY,q.current=Gt.getBoundingClientRect().width,document.addEventListener("mousemove",Nt,lt),document.addEventListener("mouseup",Ot,lt))}})},d.TextBox=C,d.ThemeContext=W,d.Tooltip=function(n){var p=n.ariaControlsSuffix,j=n.content,V=n.offset,Y=n.position,Z=n.target,pt=Q(!1),at=pt.opened,q=pt.toggle,ut=e.useRef(),lt=e.useRef(),Nt=e.useMemo(function(){return p||"".concat(i())},[]);v(function(){ut.current&&document.activeElement&&ut.current.contains(document.activeElement)&&It()});var Ot=function(){q(d.ToggleStatus.Open)},It=function(){q(d.ToggleStatus.Close)};return e.createElement(e.Fragment,null,e.createElement("div",{ref:ut,"aria-describedby":"rpv-core__tooltip-body-".concat(Nt),onBlur:function(Gt){Gt.relatedTarget instanceof HTMLElement&&Gt.currentTarget.parentElement&&Gt.currentTarget.parentElement.contains(Gt.relatedTarget)?lt.current&&(lt.current.style.display="none"):It()},onFocus:Ot,onMouseEnter:Ot,onMouseLeave:It},Z),at&&e.createElement(Dt,{ariaControlsSuffix:Nt,contentRef:lt,offset:V,position:Y,targetRef:ut},j()))},d.Viewer=function(n){var p=n.characterMap,j=n.defaultScale,V=n.enableSmoothScroll,Y=V===void 0||V,Z=n.fileUrl,pt=n.httpHeaders,at=pt===void 0?{}:pt,q=n.initialPage,ut=q===void 0?0:q,lt=n.pageLayout,Nt=n.initialRotation,Ot=Nt===void 0?0:Nt,It=n.localization,Gt=n.plugins,Vt=Gt===void 0?[]:Gt,jt=n.renderError,Me=n.renderLoader,de=n.renderPage,pe=n.renderProtectedView,ye=n.scrollMode,se=ye===void 0?d.ScrollMode.Vertical:ye,Se=n.setRenderRange,ve=Se===void 0?Is:Se,Ne=n.transformGetDocumentParams,Oe=n.theme,Be=Oe===void 0?{direction:d.TextDirection.LeftToRight,theme:"light"}:Oe,He=n.viewMode,We=He===void 0?d.ViewMode.SinglePage:He,rn=n.withCredentials,Ke=rn!==void 0&&rn,sn=n.onDocumentAskPassword,Qe=n.onDocumentLoad,en=Qe===void 0?function(){}:Qe,nn=n.onPageChange,tn=nn===void 0?function(){}:nn,dn=n.onRotate,An=dn===void 0?function(){}:dn,bn=n.onRotatePage,cn=bn===void 0?function(){}:bn,fn=n.onSwitchTheme,Sn=fn===void 0?function(){}:fn,be=n.onZoom,ge=be===void 0?function(){}:be,ae=e.useState({data:Z,name:typeof Z=="string"?Z:"",shouldLoad:!1}),he=ae[0],oe=ae[1],Ee=function(Ye,Je){oe({data:Je,name:Ye,shouldLoad:!0})},Ce=e.useState(!1),ue=Ce[0],ee=Ce[1],ke=rt(he);e.useEffect(function(){var Ye,Je,on,Ve;Ye=ke.data,Ve=typeof(Je=Z),(on=typeof Ye)=="string"&&Ve==="string"&&Ye===Je||on==="object"&&Ve==="object"&&Ye.length===Je.length&&Ye.every(function(wn,Ln){return wn===Je[Ln]})||oe({data:Z,name:typeof Z=="string"?Z:"",shouldLoad:ue})},[Z,ue]);var xe=R({onVisibilityChanged:function(Ye){ee(Ye.isVisible),Ye.isVisible&&oe(function(Je){return Object.assign({},Je,{shouldLoad:!0})})}}),$e=typeof Be=="string"?{direction:d.TextDirection.LeftToRight,theme:Be}:Be,qe=e.useState(It||$),hn=qe[0],pn=qe[1],Re={l10n:hn,setL10n:pn},un=Object.assign({},{direction:$e.direction},Ds($e.theme||"light",Sn));return e.useEffect(function(){It&&pn(It)},[It]),e.createElement(ct.Provider,{value:Re},e.createElement(W.Provider,{value:un},e.createElement("div",{ref:xe,className:"rpv-core__viewer rpv-core__viewer--".concat(un.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},he.shouldLoad&&e.createElement(Ls,{characterMap:p,file:he.data,httpHeaders:at,render:function(Ye){return e.createElement(xs,{defaultScale:j,doc:Ye,render:function(Je,on){return e.createElement(Ms,{currentFile:{data:he.data,name:he.name},defaultScale:j,doc:Ye,enableSmoothScroll:Y,initialPage:ut,initialRotation:Ot,initialScale:on,pageLayout:lt,pageSizes:Je,plugins:Vt,renderPage:de,scrollMode:se,setRenderRange:ve,viewMode:We,viewerState:{file:he,fullScreenMode:d.FullScreenMode.Normal,pageIndex:-1,pageHeight:Je[0].pageHeight,pageWidth:Je[0].pageWidth,pagesRotation:new Map,rotation:Ot,scale:on,scrollMode:se,viewMode:We},onDocumentLoad:en,onOpenFile:Ee,onPageChange:tn,onRotate:An,onRotatePage:cn,onZoom:ge})},scrollMode:se,viewMode:We})},renderError:jt,renderLoader:Me,renderProtectedView:pe,transformGetDocumentParams:Ne,withCredentials:Ke,onDocumentAskPassword:sn}))))},d.Worker=function(n){var p=n.children,j=n.workerUrl;return it.GlobalWorkerOptions.workerSrc=j,e.createElement(e.Fragment,null,p)},d.chunk=et,d.classNames=A,d.createStore=function(n){var p=n||{},j={},V=function(Z,pt){var at;p=f(f({},p),((at={})[Z]=pt,at)),(j[Z]||[]).forEach(function(q){return q(p[Z])})},Y=function(Z){return p[Z]};return{subscribe:function(Z,pt){j[Z]=(j[Z]||[]).concat(pt)},unsubscribe:function(Z,pt){j[Z]=(j[Z]||[]).filter(function(at){return at!==pt})},update:function(Z,pt){V(Z,pt)},updateCurrentValue:function(Z,pt){var at=Y(Z);at!==void 0&&V(Z,pt(at))},get:function(Z){return Y(Z)}}},d.getDestination=re,d.getPage=Yt,d.isFullScreenEnabled=l,d.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},d.useDebounceCallback=bt,d.useIntersectionObserver=R,d.useIsMounted=K,d.useIsomorphicLayoutEffect=_,d.usePrevious=rt,d.useRenderQueue=x}(core_min)),core_min}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib.exports;hasRequiredLib=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return lib.exports=requireCore_min(),lib.exports}var libExports=requireLib();const PdfPreview=()=>{let{pdfUrl:d,isOverlayOpened:b,setOverlayOpened:Et}=useOverlay();return b?jsxRuntimeExports.jsxs("div",{className:s.overlay,children:[jsxRuntimeExports.jsxs("div",{className:s.options,children:[jsxRuntimeExports.jsx("a",{href:d,target:"_blank",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faUpRightFromSquare})}),jsxRuntimeExports.jsx("a",{href:d,download:"MaldonadoPablo_Certificado",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faDownload})}),jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faXmark,onClick:()=>Et(!1)})]}),jsxRuntimeExports.jsx("div",{className:s.pdfBox,children:jsxRuntimeExports.jsx(libExports.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:jsxRuntimeExports.jsx(libExports.Viewer,{fileUrl:d})})})]}):""};export{PdfPreview as default};
